{"version":3,"sources":["main.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length",1,"module","cleanUpNextTick","draining","currentQueue","queue","concat","queueIndex","drainQueue","timeout","setTimeout","len","run","clearTimeout","Item","fun","array","this","noop","process","nextTick","args","Array","arguments","push","prototype","apply","title","browser","env","argv","version","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","binding","name","cwd","chdir","dir","umask",2,"Q","Signal","action","delay","hasLogs","execute","_deferred","defer","startTimer","_delay","onDelayFinished","promise","_currentState","STATE_ON_TIME","_stateIsOnTimeSignal","dispatch","_requestedAction","fireAction","firedAction","killTimer","STATE_TOO_SOON","reject","resolve","getRequestedAction","destroy","_timer","callback","stateIsOnTimeSignal","../utils/kew","../utils/signals",3,"writeInDiv","Move","constants","signalBus","sample","init","divClass","numMoves","isAutomatedPlayer","chanceOfFailing","_classPostFix","_chain","_chanceOfFailing","_isAutomatedPlayer","addRandomMove","ACTION_FIRED","add","onActionFired","_currentMove","remove","randomAction","ALL_ACTIONS","newMove","start","validateChain","shift","onCurrentMoveIsReady","executeMove","then","moveExecuted","fail","moveFailed","fin","moveFinished","shouldFail","requestedAction","Math","random","message","../utils/sampleArray","../utils/writeInDiv","./Move","./constants","./signalBus",4,"window","addEventListener","onKeyDown","keyCode","ACTION_ENTER","ACTION_UP","ACTION_DOWN","ACTION_LEFT","ACTION_RIGHT",5,6,7,"isPlaying","stop","humanPlayer","datGuiProps","moves","playerDelay","aiPlayer","aiDelay","aiMissChance","gameOver","onError","playerWon","actionHandler","Player","gui","dat","GUI","step","./core/Player","./core/actionHandler","./core/constants","./core/signalBus","./utils/writeInDiv",8,"Promise","onSuccess","onFail","_isPromise","_successFn","_failFn","_scope","_boundArgs","_hasContext","_nextContext","undefined","_currentContext","nextTickCallback","scope","thrown","getNextTickFunction","setNextTickFunction","fn","PromiseStats","errorsEmitted","errorsHandled","resolver","deferred","err","data","isPromise","obj","isPromiseLike","replaceEl","arr","idx","val","replaceElFulfilled","value","state","replaceElRejected","reason","all","promises","isArray","slice","allInternal","outputs","finished","counter","bind","allSettled","spread","delayMsOrVal","opt_delayMs","returnVal","delayMs","fcall","var_args","rootArgs","nfcall","splice","ncall","bindPromise","makeNodeResolver","stats","_handleError","_errorHandled","_useContext","context","clearContext","setContext","getContext","_error","_hasData","_child","_promises","_chainPromise","_onComplete","_data","_withInput","_ended","_withError","thenBound","failBound","spreadBound","onComplete","end","_end","done","onFailure","self","timeoutMs","timeoutMsg","isTimeout","_nextTick","ms","_process",9,"floor",10,"global","SignalBinding","signal","listener","isOnce","listenerContext","priority","_listener","_isOnce","_signal","_priority","validateListener","fnName","replace","_bindings","_prevParams","active","params","paramsArr","handlerReturn","detach","isBound","getListener","getSignal","_destroy","toString","VERSION","memorize","_shouldPropagate","_registerListener","prevIndex","_indexOfListener","_addBinding","cur","has","addOnce","removeAll","getNumListeners","halt","bindings","forget","dispose","signals","define","amd",11,"els","player","document","getElementsByClassName","general","ai","classPostFix","text","innerHTML"],"mappings":"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","file":"main.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n// shim for using process in browser\n\nvar process = module.exports = {};\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = setTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    clearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        setTimeout(drainQueue, 0);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n},{}],2:[function(require,module,exports){\nvar Q = require('../utils/kew'),\n\tSignal = require('../utils/signals');\n\nmodule.exports = function(action, delay, hasLogs) {\n\n\tvar STATE_TOO_SOON = 0,\n\t\tSTATE_ON_TIME = 1;\n\n\tvar _timer,\n\t\t_deferred,\n\t\t_stateIsOnTimeSignal = new Signal(),\n\t\t_currentState = STATE_TOO_SOON,\n\t\t_requestedAction = action,\n\t\t_delay = delay;\n\n\n\tfunction execute() {\n\n\t\t_deferred = Q.defer();\n\n\t\tstartTimer(_delay, onDelayFinished);\n\n\t\treturn _deferred.promise;\n\t}\n\n\tfunction onDelayFinished() {\n\n\t\t_currentState = STATE_ON_TIME;\n\t\t_stateIsOnTimeSignal.dispatch(_requestedAction);\n\t}\n\n\tfunction fireAction(firedAction) {\n\n\t\tkillTimer();\n\n\t\tif(_currentState === STATE_TOO_SOON) {\n\n\t\t\t_deferred.reject('too soon!');\n\n\t\t} else if(firedAction !== _requestedAction) {\n\n\t\t\t_deferred.reject('wrong action!');\n\n\t\t} else {\n\n\t\t\t_deferred.resolve('success!');\n\t\t}\n\t}\n\n\tfunction getRequestedAction() {\n\n\t\treturn _requestedAction;\n\t}\n\n\tfunction destroy() {\n\n\t\tkillTimer();\n\t}\n\n\tfunction killTimer() {\n\n\t\tclearTimeout(_timer);\n\t}\n\n\tfunction startTimer(delay, callback) {\n\n\t\t_timer = setTimeout(callback, delay);\n\t}\n\n\tthis.stateIsOnTimeSignal = _stateIsOnTimeSignal;\n\tthis.getRequestedAction = getRequestedAction;\n\tthis.fireAction = fireAction;\n\tthis.execute = execute;\n\tthis.destroy = destroy;\n};\n},{\"../utils/kew\":8,\"../utils/signals\":10}],3:[function(require,module,exports){\nvar Q = require('../utils/kew'),\n\twriteInDiv = require('../utils/writeInDiv'),\n\tMove = require('./Move'),\n\tconstants = require('./constants'),\n\tsignalBus = require('./signalBus'),\n\tsample = require('../utils/sampleArray');\n\nmodule.exports = function() {\n\n\tvar _deferred,\n\t\t_classPostFix,\n\t\t_chanceOfFailing,\n\t\t_delay,\n\t\t_chain,\n\t\t_currentMove,\n\t\t_isAutomatedPlayer;\n\n\n\tfunction init(divClass, numMoves, delay, isAutomatedPlayer, chanceOfFailing) {\n\n\t\tvar i = 0;\n\n\t\t_deferred = Q.defer();\n\t\t_classPostFix = divClass;\n\t\t_chain = [];\n\t\t_delay = delay;\n\t\t_chanceOfFailing = chanceOfFailing;\n\t\t_isAutomatedPlayer = isAutomatedPlayer;\n\n\t\tfor(i; i < numMoves; i++) {\n\n\t\t\taddRandomMove();\n\t\t}\n\n\t\tif(!_isAutomatedPlayer) {\n\n\t\t\tsignalBus.ACTION_FIRED.add(onActionFired);\n\t\t}\n\t}\n\n\tfunction destroy() {\n\n\t\tvar i = 0;\n\n\t\tif(_currentMove) {\n\n\t\t\t_currentMove.destroy();\n\t\t}\n\n\t\tfor(i; i < _chain.length; i++) {\n\n\t\t\t_chain[i].destroy();\n\t\t}\n\n\t\t_chain = null;\n\t\tsignalBus.ACTION_FIRED.remove(onActionFired);\n\t}\n\n\tfunction onActionFired(firedAction) {\n\n\t\tif(_currentMove) {\n\n\t\t\t_currentMove.fireAction(firedAction);\n\t\t}\n\t}\n\n\tfunction addRandomMove() {\n\n\t\tvar randomAction = sample(constants.ALL_ACTIONS),\n\t\t\tnewMove = new Move(randomAction, _delay);\n\n\t\t_chain.push(newMove);\n\t}\n\n\tfunction start() {\n\n\t\tvalidateChain();\n\n\t\twriteInDiv(_classPostFix, 'Get READY!');\n\n\t\treturn _deferred.promise;\n\t}\n\n\tfunction validateChain() {\n\n\t\t_currentMove = _chain.shift();\n\n\t\tif(_currentMove) {\n\n\t\t\t_currentMove.stateIsOnTimeSignal.add(onCurrentMoveIsReady);\n\t\t\texecuteMove();\n\n\t\t} else {\n\n\t\t\t_deferred.resolve();\n\t\t}\n\t}\n\n\tfunction executeMove() {\n\n\t\t_currentMove.execute()\n\t\t\t.then(moveExecuted)\n\t\t\t.fail(moveFailed)\n\t\t\t.fin(moveFinished)\n\t}\n\n\tfunction onCurrentMoveIsReady() {\n\n\t\tvar requestedAction = _currentMove.getRequestedAction(),\n\t\t\tshouldFail;\n\n\t\tif(_isAutomatedPlayer) {\n\n\t\t\tshouldFail = Math.random() < _chanceOfFailing;\n\n\t\t\tif(shouldFail) {\n\n\t\t\t\t_currentMove.fireAction();\n\n\t\t\t} else {\n\n\t\t\t\t_currentMove.fireAction(requestedAction);\n\t\t\t}\n\n\t\t} else {\n\n\t\t\twriteInDiv(_classPostFix, 'FIRE! ' + requestedAction);\n\t\t}\n\t}\n\n\tfunction moveExecuted() {\n\n\t\tif(_isAutomatedPlayer) {\n\n\t\t\twriteInDiv(_classPostFix, 'AI has ' + _chain.length + ' moves left');\n\n\t\t} else {\n\n\t\t\twriteInDiv(_classPostFix, 'Got it!');\n\t\t}\n\t}\n\n\tfunction moveFailed(message) {\n\n\t\tif(!_isAutomatedPlayer) {\n\n\t\t\twriteInDiv(_classPostFix, 'Woops, ' + message);\n\n\t\t} else {\n\n\t\t\twriteInDiv(_classPostFix, 'AI missed!');\n\t\t}\n\n\t\taddRandomMove();\n\t}\n\n\tfunction moveFinished() {\n\n\t\t_currentMove.destroy();\n\t\tvalidateChain();\n\t}\n\n\tthis.init = init;\n\tthis.start = start;\n\tthis.destroy = destroy;\n};\n},{\"../utils/kew\":8,\"../utils/sampleArray\":9,\"../utils/writeInDiv\":11,\"./Move\":2,\"./constants\":5,\"./signalBus\":6}],4:[function(require,module,exports){\nvar constants = require('./constants'),\n\tsignalBus = require('./signalBus');\n\nfunction init() {\n\n\twindow.addEventListener('keydown', onKeyDown);\n}\n\nfunction onKeyDown(e) {\n\n\tvar action;\n\n\tswitch(e.keyCode) {\n\n\t\tcase 13: action = constants.ACTION_ENTER; break;\n\n\t\tcase 38: action = constants.ACTION_UP; break;\n\t\tcase 40: action = constants.ACTION_DOWN; break;\n\t\tcase 37: action = constants.ACTION_LEFT; break;\n\t\tcase 39: action = constants.ACTION_RIGHT; break;\n\t}\n\n\tsignalBus.ACTION_FIRED.dispatch(action);\n}\n\nexports.init = init;\n},{\"./constants\":5,\"./signalBus\":6}],5:[function(require,module,exports){\nvar ACTION_UP = 'ACTION_UP',\n\tACTION_ENTER = 'ACTION_ENTER',\n\tACTION_DOWN = 'ACTION_DOWN',\n\tACTION_LEFT = 'ACTION_LEFT',\n\tACTION_RIGHT = 'ACTION_RIGHT';\n\nexports.ACTION_ENTER = ACTION_ENTER;\nexports.ACTION_UP = ACTION_UP;\nexports.ACTION_DOWN = ACTION_DOWN;\nexports.ACTION_LEFT = ACTION_LEFT;\nexports.ACTION_RIGHT = ACTION_RIGHT;\nexports.ALL_ACTIONS = [ACTION_UP, ACTION_DOWN, ACTION_LEFT, ACTION_RIGHT];\n\n\n},{}],6:[function(require,module,exports){\nvar Signal = require('../utils/signals');\n\nexports.ACTION_FIRED = new Signal();\n},{\"../utils/signals\":10}],7:[function(require,module,exports){\nvar actionHandler = require('./core/actionHandler'),\n\tsignalBus = require('./core/signalBus'),\n\twriteInDiv = require('./utils/writeInDiv'),\n\tconstants = require('./core/constants'),\n\tPlayer = require('./core/Player');\n\n\nvar humanPlayer = new Player(),\n\taiPlayer = new Player(),\n\tisPlaying = false,\n\tdatGuiProps = new function() {\n\n\t\tthis.moves = 5;\n\t\tthis.playerDelay = 1000;\n\t\tthis.aiDelay = 2000;\n\t\tthis.aiMissChance = 0.1;\n\n\t\tthis.start = start;\n\t\tthis.stop = stop;\n\t}();\n\nvar gui = new dat.GUI();\ngui.add(datGuiProps, 'moves', 0, 10).step(1);\ngui.add(datGuiProps, 'playerDelay', 0, 5000).step(100);\ngui.add(datGuiProps, 'aiDelay', 0, 5000).step(100);\ngui.add(datGuiProps, 'aiMissChance', 0, 1).step(0.05);\ngui.add(datGuiProps, 'start');\ngui.add(datGuiProps, 'stop');\n\nwriteInDiv('general', 'Press `ENTER` to start');\nactionHandler.init();\n\nsignalBus.ACTION_FIRED.add(onActionFired);\n\nfunction onActionFired(action) {\n\n\tif(action === constants.ACTION_ENTER) {\n\n\t\tif(!isPlaying) {\n\n\t\t\tstart();\n\n\t\t} else {\n\n\t\t\tstop();\n\t\t}\n\t}\n}\n\nfunction start() {\n\n\tif(isPlaying) {\n\n\t\tstop();\n\t}\n\n\twriteInDiv('general', '');\n\n\tisPlaying = true;\n\thumanPlayer.init('player', datGuiProps.moves, datGuiProps.playerDelay, false);\n\taiPlayer.init('ai', datGuiProps.moves, datGuiProps.aiDelay, true, datGuiProps.aiMissChance);\n\n\thumanPlayer.start()\n\t\t.then(function(){\n\t\t\tgameOver(true);\n\t\t}).fail(onError);\n\taiPlayer.start()\n\t\t.then(function(){\n\n\t\t\tgameOver(false);\n\t\t}).fail(onError);\n}\n\nfunction onError(e) {\n\tconsole.error(e);\n}\n\nfunction gameOver(playerWon) {\n\n\twriteInDiv('player', '');\n\twriteInDiv('ai', '');\n\tif(playerWon) {\n\n\t\twriteInDiv('general', 'You won!<br>Press `ENTER` to replay');\n\n\t} else {\n\n\t\twriteInDiv('general', 'You lost...<br>Press `ENTER` to replay');\n\t}\n\n\tstop();\n}\n\nfunction stop() {\n\n\tisPlaying = false;\n\n\thumanPlayer.destroy();\n\taiPlayer.destroy();\n}\n},{\"./core/Player\":3,\"./core/actionHandler\":4,\"./core/constants\":5,\"./core/signalBus\":6,\"./utils/writeInDiv\":11}],8:[function(require,module,exports){\n(function (process){\n\n/**\n * An object representing a \"promise\" for a future value\n *\n * @param {?function(T, ?)=} onSuccess a function to handle successful\n *     resolution of this promise\n * @param {?function(!Error, ?)=} onFail a function to handle failed\n *     resolution of this promise\n * @constructor\n * @template T\n */\nfunction Promise(onSuccess, onFail) {\n  this.promise = this\n  this._isPromise = true\n  this._successFn = onSuccess\n  this._failFn = onFail\n  this._scope = this\n  this._boundArgs = null\n  this._hasContext = false\n  this._nextContext = undefined\n  this._currentContext = undefined\n}\n\n/**\n * @param {function()} callback\n */\nfunction nextTick (callback) {\n  callback()\n}\n\nif (typeof process !== 'undefined' && typeof process.nextTick === 'function') {\n  nextTick = process.nextTick\n}\n\n/**\n * All callback execution should go through this function.  While the\n * implementation below is simple, it can be replaced with more sophisticated\n * implementations that enforce QoS on the event loop.\n *\n * @param {Promise} defer\n * @param {Function} callback\n * @param {Object|undefined} scope\n * @param {Array} args\n */\nfunction nextTickCallback (defer, callback, scope, args) {\n  try {\n    defer.resolve(callback.apply(scope, args))\n  } catch (thrown) {\n    defer.reject(thrown)\n  }\n}\n\n/**\n * Used for accessing the nextTick function from outside the kew module.\n *\n * @return {Function}\n */\nfunction getNextTickFunction () {\n  return nextTick\n}\n\n/**\n * Used for overriding the nextTick function from outside the kew module so that\n * the user can plug and play lower level schedulers\n * @param {!Function} fn\n */\nfunction setNextTickFunction (fn) {\n  nextTick = fn\n}\n\n/**\n * Keep track of the number of promises that are rejected along side\n * the number of rejected promises we call _failFn on so we can look\n * for leaked rejections.\n * @constructor\n */\nfunction PromiseStats() {\n  /** @type {number} */\n  this.errorsEmitted = 0\n\n  /** @type {number} */\n  this.errorsHandled = 0\n}\n\nvar stats = new PromiseStats()\n\nPromise.prototype._handleError = function () {\n  if (!this._errorHandled) {\n    stats.errorsHandled++\n    this._errorHandled = true\n  }\n}\n\n/**\n * Specify that the current promise should have a specified context\n * @param  {*} context context\n * @private\n */\nPromise.prototype._useContext = function (context) {\n  this._nextContext = this._currentContext = context\n  this._hasContext = true\n  return this\n}\n\nPromise.prototype.clearContext = function () {\n  this._hasContext = false\n  this._nextContext = undefined\n  return this\n}\n\n/**\n * Set the context for all promise handlers to follow\n *\n * NOTE(dpup): This should be considered deprecated.  It does not do what most\n * people would expect.  The context will be passed as a second argument to all\n * subsequent callbacks.\n *\n * @param {*} context An arbitrary context\n */\nPromise.prototype.setContext = function (context) {\n  this._nextContext = context\n  this._hasContext = true\n  return this\n}\n\n/**\n * Get the context for a promise\n * @return {*} the context set by setContext\n */\nPromise.prototype.getContext = function () {\n  return this._nextContext\n}\n\n/**\n * Resolve this promise with a specified value\n *\n * @param {*=} data\n */\nPromise.prototype.resolve = function (data) {\n  if (this._error || this._hasData) throw new Error(\"Unable to resolve or reject the same promise twice\")\n\n  var i\n  if (data && isPromise(data)) {\n    this._child = data\n    if (this._promises) {\n      for (i = 0; i < this._promises.length; i += 1) {\n        data._chainPromise(this._promises[i])\n      }\n      delete this._promises\n    }\n\n    if (this._onComplete) {\n      for (i = 0; i < this._onComplete.length; i+= 1) {\n        data.fin(this._onComplete[i])\n      }\n      delete this._onComplete\n    }\n  } else if (data && isPromiseLike(data)) {\n    data.then(\n      function(data) { this.resolve(data) }.bind(this),\n      function(err) { this.reject(err) }.bind(this)\n    )\n  } else {\n    this._hasData = true\n    this._data = data\n\n    if (this._onComplete) {\n      for (i = 0; i < this._onComplete.length; i++) {\n        this._onComplete[i]()\n      }\n    }\n\n    if (this._promises) {\n      for (i = 0; i < this._promises.length; i += 1) {\n        this._promises[i]._useContext(this._nextContext)\n        this._promises[i]._withInput(data)\n      }\n      delete this._promises\n    }\n  }\n}\n\n/**\n * Reject this promise with an error\n *\n * @param {!Error} e\n */\nPromise.prototype.reject = function (e) {\n  if (this._error || this._hasData) throw new Error(\"Unable to resolve or reject the same promise twice\")\n\n  var i\n  this._error = e\n  stats.errorsEmitted++\n\n  if (this._ended) {\n    this._handleError()\n    process.nextTick(function onPromiseThrow() {\n      throw e\n    })\n  }\n\n  if (this._onComplete) {\n    for (i = 0; i < this._onComplete.length; i++) {\n      this._onComplete[i]()\n    }\n  }\n\n  if (this._promises) {\n    this._handleError()\n    for (i = 0; i < this._promises.length; i += 1) {\n      this._promises[i]._useContext(this._nextContext)\n      this._promises[i]._withError(e)\n    }\n    delete this._promises\n  }\n}\n\n/**\n * Provide a callback to be called whenever this promise successfully\n * resolves. Allows for an optional second callback to handle the failure\n * case.\n *\n * @param {?function(this:void, T, ?): RESULT|undefined} onSuccess\n * @param {?function(this:void, !Error, ?): RESULT=} onFail\n * @return {!Promise.<RESULT>} returns a new promise with the output of the onSuccess or\n *     onFail handler\n * @template RESULT\n */\nPromise.prototype.then = function (onSuccess, onFail) {\n  var promise = new Promise(onSuccess, onFail)\n  if (this._nextContext) promise._useContext(this._nextContext)\n\n  if (this._child) this._child._chainPromise(promise)\n  else this._chainPromise(promise)\n\n  return promise\n}\n\n/**\n * Provide a callback to be called whenever this promise successfully\n * resolves. The callback will be executed in the context of the provided scope.\n *\n * @param {function(this:SCOPE, ...): RESULT} onSuccess\n * @param {SCOPE} scope Object whose context callback will be executed in.\n * @param {...*} var_args Additional arguments to be passed to the promise callback.\n * @return {!Promise.<RESULT>} returns a new promise with the output of the onSuccess\n * @template SCOPE, RESULT\n */\nPromise.prototype.thenBound = function (onSuccess, scope, var_args) {\n  var promise = new Promise(onSuccess)\n  if (this._nextContext) promise._useContext(this._nextContext)\n\n  promise._scope = scope\n  if (arguments.length > 2) {\n    promise._boundArgs = Array.prototype.slice.call(arguments, 2)\n  }\n\n  // Chaining must happen after setting args and scope since it may fire callback.\n  if (this._child) this._child._chainPromise(promise)\n  else this._chainPromise(promise)\n\n  return promise\n}\n\n/**\n * Provide a callback to be called whenever this promise is rejected\n *\n * @param {function(this:void, !Error, ?)} onFail\n * @return {!Promise.<T>} returns a new promise with the output of the onFail handler\n */\nPromise.prototype.fail = function (onFail) {\n  return this.then(null, onFail)\n}\n\n/**\n * Provide a callback to be called whenever this promise is rejected.\n * The callback will be executed in the context of the provided scope.\n *\n * @param {function(this:SCOPE, ...)} onFail\n * @param {SCOPE} scope Object whose context callback will be executed in.\n * @param {...?} var_args\n * @return {!Promise.<T>} returns a new promise with the output of the onSuccess\n * @template SCOPE\n */\nPromise.prototype.failBound = function (onFail, scope, var_args) {\n  var promise = new Promise(null, onFail)\n  if (this._nextContext) promise._useContext(this._nextContext)\n\n  promise._scope = scope\n  if (arguments.length > 2) {\n    promise._boundArgs = Array.prototype.slice.call(arguments, 2)\n  }\n\n  // Chaining must happen after setting args and scope since it may fire callback.\n  if (this._child) this._child._chainPromise(promise)\n  else this._chainPromise(promise)\n\n  return promise\n}\n\n/**\n * Spread a promises outputs to the functions arguments.\n * @param {?function(this:void, ...): RESULT|undefined} onSuccess\n * @return {!Promise.<RESULT>} returns a new promise with the output of the onSuccess or\n *     onFail handler\n * @template RESULT\n */\nPromise.prototype.spread = function (onSuccess) {\n  return this.then(allInternal)\n  .then(function (array) {\n    return onSuccess.apply(null, array)\n  })\n}\n\n/**\n * Spread a promises outputs to the functions arguments.\n * @param {function(this:SCOPE, ...): RESULT} onSuccess\n * @param {SCOPE} scope Object whose context callback will be executed in.\n * @param {...*} var_args Additional arguments to be passed to the promise callback.\n * @return {!Promise.<RESULT>} returns a new promise with the output of the onSuccess\n * @template SCOPE, RESULT\n */\nPromise.prototype.spreadBound = function (onSuccess, scope, var_args) {\n  var args = Array.prototype.slice.call(arguments, 2)\n  return this.then(allInternal)\n  .then(function (array) {\n    return onSuccess.apply(scope, args.concat(array))\n  })\n}\n\n/**\n * Provide a callback to be called whenever this promise is either resolved\n * or rejected.\n *\n * @param {function()} onComplete\n * @return {!Promise.<T>} returns the current promise\n */\nPromise.prototype.fin = function (onComplete) {\n  if (this._hasData || this._error) {\n    onComplete()\n    return this\n  }\n\n  if (this._child) {\n    this._child.fin(onComplete)\n  } else {\n    if (!this._onComplete) this._onComplete = [onComplete]\n    else this._onComplete.push(onComplete)\n  }\n\n  return this\n}\n\n/**\n * Mark this promise as \"ended\". If the promise is rejected, this will throw an\n * error in whatever scope it happens to be in\n *\n * @return {!Promise.<T>} returns the current promise\n * @deprecated Prefer done(), because it's consistent with Q.\n */\nPromise.prototype.end = function () {\n  this._end()\n  return this\n}\n\n\n/**\n * Mark this promise as \"ended\".\n * @private\n */\nPromise.prototype._end = function () {\n  if (this._error) {\n    this._handleError()\n    throw this._error\n  }\n  this._ended = true\n  return this\n}\n\n/**\n * Close the promise. Any errors after this completes will be thrown to the global handler.\n *\n * @param {?function(this:void, T, ?)=} onSuccess a function to handle successful\n *     resolution of this promise\n * @param {?function(this:void, !Error, ?)=} onFailure a function to handle failed\n *     resolution of this promise\n * @return {void}\n */\nPromise.prototype.done = function (onSuccess, onFailure) {\n  var self = this\n  if (onSuccess || onFailure) {\n    self = self.then(onSuccess, onFailure)\n  }\n  self._end()\n}\n\n/**\n * Return a new promise that behaves the same as the current promise except\n * that it will be rejected if the current promise does not get fulfilled\n * after a certain amount of time.\n *\n * @param {number} timeoutMs The timeout threshold in msec\n * @param {string=} timeoutMsg error message\n * @return {!Promise.<T>} a new promise with timeout\n */\n Promise.prototype.timeout = function (timeoutMs, timeoutMsg) {\n  var deferred = new Promise()\n  var isTimeout = false\n\n  var timeout = setTimeout(function() {\n    deferred.reject(new Error(timeoutMsg || 'Promise timeout after ' + timeoutMs + ' ms.'))\n    isTimeout = true\n  }, timeoutMs)\n\n  this.then(function (data) {\n    if (!isTimeout) {\n      clearTimeout(timeout)\n      deferred.resolve(data)\n    }\n  },\n  function (err) {\n    if (!isTimeout) {\n      clearTimeout(timeout)\n      deferred.reject(err)\n    }\n  })\n\n  return deferred.promise\n}\n\n/**\n * Attempt to resolve this promise with the specified input\n *\n * @param {*} data the input\n */\nPromise.prototype._withInput = function (data) {\n  if (this._successFn) {\n    this._nextTick(this._successFn, [data, this._currentContext])\n  } else {\n    this.resolve(data)\n  }\n\n  // context is no longer needed\n  delete this._currentContext\n}\n\n/**\n * Attempt to reject this promise with the specified error\n *\n * @param {!Error} e\n * @private\n */\nPromise.prototype._withError = function (e) {\n  if (this._failFn) {\n    this._nextTick(this._failFn, [e, this._currentContext])\n  } else {\n    this.reject(e)\n  }\n\n  // context is no longer needed\n  delete this._currentContext\n}\n\n/**\n * Calls a function in the correct scope, and includes bound arguments.\n * @param {Function} fn\n * @param {Array} args\n * @private\n */\nPromise.prototype._nextTick = function (fn, args) {\n  if (this._boundArgs) {\n    args = this._boundArgs.concat(args)\n  }\n  nextTick(nextTickCallback.bind(null, this, fn, this._scope, args))\n}\n\n/**\n * Chain a promise to the current promise\n *\n * @param {!Promise} promise the promise to chain\n * @private\n */\nPromise.prototype._chainPromise = function (promise) {\n  var i\n  if (this._hasContext) promise._useContext(this._nextContext)\n\n  if (this._child) {\n    this._child._chainPromise(promise)\n  } else if (this._hasData) {\n    promise._withInput(this._data)\n  } else if (this._error) {\n    // We can't rely on _withError() because it's called on the chained promises\n    // and we need to use the source's _errorHandled state\n    this._handleError()\n    promise._withError(this._error)\n  } else if (!this._promises) {\n    this._promises = [promise]\n  } else {\n    this._promises.push(promise)\n  }\n}\n\n/**\n * Utility function used for creating a node-style resolver\n * for deferreds\n *\n * @param {!Promise} deferred a promise that looks like a deferred\n * @param {Error=} err an optional error\n * @param {*=} data optional data\n */\nfunction resolver(deferred, err, data) {\n  if (err) deferred.reject(err)\n  else deferred.resolve(data)\n}\n\n/**\n * Creates a node-style resolver for a deferred by wrapping\n * resolver()\n *\n * @return {function(?Error, *)} node-style callback\n */\nPromise.prototype.makeNodeResolver = function () {\n  return resolver.bind(null, this)\n}\n\n/**\n * Return true iff the given object is a promise of this library.\n *\n * Because kew's API is slightly different than other promise libraries,\n * it's important that we have a test for its promise type. If you want\n * to test for a more general A+ promise, you should do a cap test for\n * the features you want.\n *\n * @param {*} obj The object to test\n * @return {boolean} Whether the object is a promise\n */\nfunction isPromise(obj) {\n  return !!obj._isPromise\n}\n\n/**\n * Return true iff the given object is a promise-like object, e.g. appears to\n * implement Promises/A+ specification\n *\n * @param {*} obj The object to test\n * @return {boolean} Whether the object is a promise-like object\n */\nfunction isPromiseLike(obj) {\n  return (typeof obj === 'object' || typeof obj === 'function') &&\n    typeof obj.then === 'function'\n}\n\n/**\n * Static function which creates and resolves a promise immediately\n *\n * @param {T} data data to resolve the promise with\n * @return {!Promise.<T>}\n * @template T\n */\nfunction resolve(data) {\n  var promise = new Promise()\n  promise.resolve(data)\n  return promise\n}\n\n/**\n * Static function which creates and rejects a promise immediately\n *\n * @param {!Error} e error to reject the promise with\n * @return {!Promise}\n */\nfunction reject(e) {\n  var promise = new Promise()\n  promise.reject(e)\n  return promise\n}\n\n/**\n * Replace an element in an array with a new value. Used by .all() to\n * call from .then()\n *\n * @param {!Array} arr\n * @param {number} idx\n * @param {*} val\n * @return {*} the val that's being injected into the array\n */\nfunction replaceEl(arr, idx, val) {\n  arr[idx] = val\n  return val\n}\n\n/**\n * Replace an element in an array as it is resolved with its value.\n * Used by .allSettled().\n *\n * @param {!Array} arr\n * @param {number} idx\n * @param {*} value The value from a resolved promise.\n * @return {*} the data that's being passed in\n */\nfunction replaceElFulfilled(arr, idx, value) {\n  arr[idx] = {\n    state: 'fulfilled',\n    value: value\n  }\n  return value\n}\n\n/**\n * Replace an element in an array as it is rejected with the reason.\n * Used by .allSettled().\n *\n * @param {!Array} arr\n * @param {number} idx\n * @param {*} reason The reason why the original promise is rejected\n * @return {*} the data that's being passed in\n */\nfunction replaceElRejected(arr, idx, reason) {\n  arr[idx] = {\n    state: 'rejected',\n    reason: reason\n  }\n  return reason\n}\n\n/**\n * Takes in an array of promises or literals and returns a promise which returns\n * an array of values when all have resolved. If any fail, the promise fails.\n *\n * @param {!Array.<!Promise>} promises\n * @return {!Promise.<!Array>}\n */\nfunction all(promises) {\n  if (arguments.length != 1 || !Array.isArray(promises)) {\n    promises = Array.prototype.slice.call(arguments, 0)\n  }\n  return allInternal(promises)\n}\n\n/**\n * A version of all() that does not accept var_args\n *\n * @param {!Array.<!Promise>} promises\n * @return {!Promise.<!Array>}\n */\nfunction allInternal(promises) {\n  if (!promises.length) return resolve([])\n\n  var outputs = []\n  var finished = false\n  var promise = new Promise()\n  var counter = promises.length\n\n  for (var i = 0; i < promises.length; i += 1) {\n    if (!promises[i] || !isPromiseLike(promises[i])) {\n      outputs[i] = promises[i]\n      counter -= 1\n    } else {\n      promises[i].then(replaceEl.bind(null, outputs, i))\n      .then(function decrementAllCounter() {\n        counter--\n        if (!finished && counter === 0) {\n          finished = true\n          promise.resolve(outputs)\n        }\n      }, function onAllError(e) {\n        if (!finished) {\n          finished = true\n          promise.reject(e)\n        }\n      })\n    }\n  }\n\n  if (counter === 0 && !finished) {\n    finished = true\n    promise.resolve(outputs)\n  }\n\n  return promise\n}\n\n/**\n * Takes in an array of promises or values and returns a promise that is\n * fulfilled with an array of state objects when all have resolved or\n * rejected. If a promise is resolved, its corresponding state object is\n * {state: 'fulfilled', value: Object}; whereas if a promise is rejected, its\n * corresponding state object is {state: 'rejected', reason: Object}.\n *\n * @param {!Array} promises or values\n * @return {!Promise.<!Array>} Promise fulfilled with state objects for each input\n */\nfunction allSettled(promises) {\n  if (!Array.isArray(promises)) {\n    throw Error('The input to \"allSettled()\" should be an array of Promise or values')\n  }\n  if (!promises.length) return resolve([])\n\n  var outputs = []\n  var promise = new Promise()\n  var counter = promises.length\n\n  for (var i = 0; i < promises.length; i += 1) {\n    if (!promises[i] || !isPromiseLike(promises[i])) {\n      replaceElFulfilled(outputs, i, promises[i])\n      if ((--counter) === 0) promise.resolve(outputs)\n    } else {\n      promises[i]\n        .then(replaceElFulfilled.bind(null, outputs, i), replaceElRejected.bind(null, outputs, i))\n        .then(function () {\n          if ((--counter) === 0) promise.resolve(outputs)\n        })\n    }\n  }\n\n  return promise\n}\n\n/**\n * Takes an array of results and spreads them to the arguments of a function.\n * @param {!Array} array\n * @param {!Function} fn\n */\nfunction spread(array, fn) {\n  resolve(array).spread(fn)\n}\n\n/**\n * Create a new Promise which looks like a deferred\n *\n * @return {!Promise}\n */\nfunction defer() {\n  return new Promise()\n}\n\n/**\n * Return a promise which will wait a specified number of ms to resolve\n *\n * @param {*} delayMsOrVal A delay (in ms) if this takes one argument, or ther\n *     return value if it takes two.\n * @param {number=} opt_delayMs\n * @return {!Promise}\n */\nfunction delay(delayMsOrVal, opt_delayMs) {\n  var returnVal = undefined\n  var delayMs = delayMsOrVal\n  if (typeof opt_delayMs != 'undefined') {\n    delayMs = opt_delayMs\n    returnVal = delayMsOrVal\n  }\n\n  if (typeof delayMs != 'number') {\n    throw new Error('Bad delay value ' + delayMs)\n  }\n\n  var defer = new Promise()\n  setTimeout(function onDelay() {\n    defer.resolve(returnVal)\n  }, delayMs)\n  return defer\n}\n\n/**\n * Returns a promise that has the same result as `this`, but fulfilled\n * after at least ms milliseconds\n * @param {number} ms\n */\nPromise.prototype.delay = function (ms) {\n  return this.then(function (val) {\n    return delay(val, ms)\n  })\n}\n\n/**\n * Return a promise which will evaluate the function fn in a future turn with\n * the provided args\n *\n * @param {function(...)} fn\n * @param {...*} var_args a variable number of arguments\n * @return {!Promise}\n */\nfunction fcall(fn, var_args) {\n  var rootArgs = Array.prototype.slice.call(arguments, 1)\n  var defer = new Promise()\n  nextTick(nextTickCallback.bind(null, defer, fn, undefined, rootArgs))\n  return defer\n}\n\n\n/**\n * Returns a promise that will be invoked with the result of a node style\n * callback. All args to fn should be given except for the final callback arg\n *\n * @param {function(...)} fn\n * @param {...*} var_args a variable number of arguments\n * @return {!Promise}\n */\nfunction nfcall(fn, var_args) {\n  // Insert an undefined argument for scope and let bindPromise() do the work.\n  var args = Array.prototype.slice.call(arguments, 0)\n  args.splice(1, 0, undefined)\n  return ncall.apply(undefined, args)\n}\n\n\n/**\n * Like `nfcall`, but permits passing a `this` context for the call.\n *\n * @param {function(...)} fn\n * @param {Object} scope\n * @param {...*} var_args\n * @return {!Promise}\n */\nfunction ncall(fn, scope, var_args) {\n  return bindPromise.apply(null, arguments)()\n}\n\n\n/**\n * Binds a function to a scope with an optional number of curried arguments. Attaches\n * a node style callback as the last argument and returns a promise\n *\n * @param {function(...)} fn\n * @param {Object} scope\n * @param {...*} var_args a variable number of arguments\n * @return {function(...)}: !Promise}\n */\nfunction bindPromise(fn, scope, var_args) {\n  var rootArgs = Array.prototype.slice.call(arguments, 2)\n  return function onBoundPromise(var_args) {\n    var defer = new Promise()\n    try {\n      fn.apply(scope, rootArgs.concat(Array.prototype.slice.call(arguments, 0), defer.makeNodeResolver()))\n    } catch (e) {\n      defer.reject(e)\n    }\n    return defer\n  }\n}\n\nmodule.exports = {\n  all: all,\n  bindPromise: bindPromise,\n  defer: defer,\n  delay: delay,\n  fcall: fcall,\n  isPromise: isPromise,\n  isPromiseLike: isPromiseLike,\n  ncall: ncall,\n  nfcall: nfcall,\n  resolve: resolve,\n  reject: reject,\n  spread: spread,\n  stats: stats,\n  allSettled: allSettled,\n  Promise: Promise,\n  getNextTickFunction: getNextTickFunction,\n  setNextTickFunction: setNextTickFunction,\n}\n\n}).call(this,require('_process'))\n\n},{\"_process\":1}],9:[function(require,module,exports){\nmodule.exports = function(array) {\n\n\treturn array[Math.floor(Math.random()*array.length)];\n};\n},{}],10:[function(require,module,exports){\n/*jslint onevar:true, undef:true, newcap:true, regexp:true, bitwise:true, maxerr:50, indent:4, white:false, nomen:false, plusplus:false */\n/*global define:false, require:false, exports:false, module:false, signals:false */\n\n/** @license\n * JS Signals <http://millermedeiros.github.com/js-signals/>\n * Released under the MIT license\n * Author: Miller Medeiros\n * Version: 1.0.0 - Build: 268 (2012/11/29 05:48 PM)\n */\n\n(function(global){\n\n    // SignalBinding -------------------------------------------------\n    //================================================================\n\n    /**\n     * Object that represents a binding between a Signal and a listener function.\n     * <br />- <strong>This is an internal constructor and shouldn't be called by regular users.</strong>\n     * <br />- inspired by Joa Ebert AS3 SignalBinding and Robert Penner's Slot classes.\n     * @author Miller Medeiros\n     * @constructor\n     * @internal\n     * @name SignalBinding\n     * @param {Signal} signal Reference to Signal object that listener is currently bound to.\n     * @param {Function} listener Handler function bound to the signal.\n     * @param {boolean} isOnce If binding should be executed just once.\n     * @param {Object} [listenerContext] Context on which listener will be executed (object that should represent the `this` variable inside listener function).\n     * @param {Number} [priority] The priority level of the event listener. (default = 0).\n     */\n    function SignalBinding(signal, listener, isOnce, listenerContext, priority) {\n\n        /**\n         * Handler function bound to the signal.\n         * @type Function\n         * @private\n         */\n        this._listener = listener;\n\n        /**\n         * If binding should be executed just once.\n         * @type boolean\n         * @private\n         */\n        this._isOnce = isOnce;\n\n        /**\n         * Context on which listener will be executed (object that should represent the `this` variable inside listener function).\n         * @memberOf SignalBinding.prototype\n         * @name context\n         * @type Object|undefined|null\n         */\n        this.context = listenerContext;\n\n        /**\n         * Reference to Signal object that listener is currently bound to.\n         * @type Signal\n         * @private\n         */\n        this._signal = signal;\n\n        /**\n         * Listener priority\n         * @type Number\n         * @private\n         */\n        this._priority = priority || 0;\n    }\n\n    SignalBinding.prototype = {\n\n        /**\n         * If binding is active and should be executed.\n         * @type boolean\n         */\n        active : true,\n\n        /**\n         * Default parameters passed to listener during `Signal.dispatch` and `SignalBinding.execute`. (curried parameters)\n         * @type Array|null\n         */\n        params : null,\n\n        /**\n         * Call listener passing arbitrary parameters.\n         * <p>If binding was added using `Signal.addOnce()` it will be automatically removed from signal dispatch queue, this method is used internally for the signal dispatch.</p>\n         * @param {Array} [paramsArr] Array of parameters that should be passed to the listener\n         * @return {*} Value returned by the listener.\n         */\n        execute : function (paramsArr) {\n            var handlerReturn, params;\n            if (this.active && !!this._listener) {\n                params = this.params? this.params.concat(paramsArr) : paramsArr;\n                handlerReturn = this._listener.apply(this.context, params);\n                if (this._isOnce) {\n                    this.detach();\n                }\n            }\n            return handlerReturn;\n        },\n\n        /**\n         * Detach binding from signal.\n         * - alias to: mySignal.remove(myBinding.getListener());\n         * @return {Function|null} Handler function bound to the signal or `null` if binding was previously detached.\n         */\n        detach : function () {\n            return this.isBound()? this._signal.remove(this._listener, this.context) : null;\n        },\n\n        /**\n         * @return {Boolean} `true` if binding is still bound to the signal and have a listener.\n         */\n        isBound : function () {\n            return (!!this._signal && !!this._listener);\n        },\n\n        /**\n         * @return {boolean} If SignalBinding will only be executed once.\n         */\n        isOnce : function () {\n            return this._isOnce;\n        },\n\n        /**\n         * @return {Function} Handler function bound to the signal.\n         */\n        getListener : function () {\n            return this._listener;\n        },\n\n        /**\n         * @return {Signal} Signal that listener is currently bound to.\n         */\n        getSignal : function () {\n            return this._signal;\n        },\n\n        /**\n         * Delete instance properties\n         * @private\n         */\n        _destroy : function () {\n            delete this._signal;\n            delete this._listener;\n            delete this.context;\n        },\n\n        /**\n         * @return {string} String representation of the object.\n         */\n        toString : function () {\n            return '[SignalBinding isOnce:' + this._isOnce +', isBound:'+ this.isBound() +', active:' + this.active + ']';\n        }\n\n    };\n\n\n/*global SignalBinding:false*/\n\n    // Signal --------------------------------------------------------\n    //================================================================\n\n    function validateListener(listener, fnName) {\n        if (typeof listener !== 'function') {\n            throw new Error( 'listener is a required param of {fn}() and should be a Function.'.replace('{fn}', fnName) );\n        }\n    }\n\n    /**\n     * Custom event broadcaster\n     * <br />- inspired by Robert Penner's AS3 Signals.\n     * @name Signal\n     * @author Miller Medeiros\n     * @constructor\n     */\n    function Signal() {\n        /**\n         * @type Array.<SignalBinding>\n         * @private\n         */\n        this._bindings = [];\n        this._prevParams = null;\n\n        // enforce dispatch to aways work on same context (#47)\n        var self = this;\n        this.dispatch = function(){\n            Signal.prototype.dispatch.apply(self, arguments);\n        };\n    }\n\n    Signal.prototype = {\n\n        /**\n         * Signals Version Number\n         * @type String\n         * @const\n         */\n        VERSION : '1.0.0',\n\n        /**\n         * If Signal should keep record of previously dispatched parameters and\n         * automatically execute listener during `add()`/`addOnce()` if Signal was\n         * already dispatched before.\n         * @type boolean\n         */\n        memorize : false,\n\n        /**\n         * @type boolean\n         * @private\n         */\n        _shouldPropagate : true,\n\n        /**\n         * If Signal is active and should broadcast events.\n         * <p><strong>IMPORTANT:</strong> Setting this property during a dispatch will only affect the next dispatch, if you want to stop the propagation of a signal use `halt()` instead.</p>\n         * @type boolean\n         */\n        active : true,\n\n        /**\n         * @param {Function} listener\n         * @param {boolean} isOnce\n         * @param {Object} [listenerContext]\n         * @param {Number} [priority]\n         * @return {SignalBinding}\n         * @private\n         */\n        _registerListener : function (listener, isOnce, listenerContext, priority) {\n\n            var prevIndex = this._indexOfListener(listener, listenerContext),\n                binding;\n\n            if (prevIndex !== -1) {\n                binding = this._bindings[prevIndex];\n                if (binding.isOnce() !== isOnce) {\n                    throw new Error('You cannot add'+ (isOnce? '' : 'Once') +'() then add'+ (!isOnce? '' : 'Once') +'() the same listener without removing the relationship first.');\n                }\n            } else {\n                binding = new SignalBinding(this, listener, isOnce, listenerContext, priority);\n                this._addBinding(binding);\n            }\n\n            if(this.memorize && this._prevParams){\n                binding.execute(this._prevParams);\n            }\n\n            return binding;\n        },\n\n        /**\n         * @param {SignalBinding} binding\n         * @private\n         */\n        _addBinding : function (binding) {\n            //simplified insertion sort\n            var n = this._bindings.length;\n            do { --n; } while (this._bindings[n] && binding._priority <= this._bindings[n]._priority);\n            this._bindings.splice(n + 1, 0, binding);\n        },\n\n        /**\n         * @param {Function} listener\n         * @return {number}\n         * @private\n         */\n        _indexOfListener : function (listener, context) {\n            var n = this._bindings.length,\n                cur;\n            while (n--) {\n                cur = this._bindings[n];\n                if (cur._listener === listener && cur.context === context) {\n                    return n;\n                }\n            }\n            return -1;\n        },\n\n        /**\n         * Check if listener was attached to Signal.\n         * @param {Function} listener\n         * @param {Object} [context]\n         * @return {boolean} if Signal has the specified listener.\n         */\n        has : function (listener, context) {\n            return this._indexOfListener(listener, context) !== -1;\n        },\n\n        /**\n         * Add a listener to the signal.\n         * @param {Function} listener Signal handler function.\n         * @param {Object} [listenerContext] Context on which listener will be executed (object that should represent the `this` variable inside listener function).\n         * @param {Number} [priority] The priority level of the event listener. Listeners with higher priority will be executed before listeners with lower priority. Listeners with same priority level will be executed at the same order as they were added. (default = 0)\n         * @return {SignalBinding} An Object representing the binding between the Signal and listener.\n         */\n        add : function (listener, listenerContext, priority) {\n            validateListener(listener, 'add');\n            return this._registerListener(listener, false, listenerContext, priority);\n        },\n\n        /**\n         * Add listener to the signal that should be removed after first execution (will be executed only once).\n         * @param {Function} listener Signal handler function.\n         * @param {Object} [listenerContext] Context on which listener will be executed (object that should represent the `this` variable inside listener function).\n         * @param {Number} [priority] The priority level of the event listener. Listeners with higher priority will be executed before listeners with lower priority. Listeners with same priority level will be executed at the same order as they were added. (default = 0)\n         * @return {SignalBinding} An Object representing the binding between the Signal and listener.\n         */\n        addOnce : function (listener, listenerContext, priority) {\n            validateListener(listener, 'addOnce');\n            return this._registerListener(listener, true, listenerContext, priority);\n        },\n\n        /**\n         * Remove a single listener from the dispatch queue.\n         * @param {Function} listener Handler function that should be removed.\n         * @param {Object} [context] Execution context (since you can add the same handler multiple times if executing in a different context).\n         * @return {Function} Listener handler function.\n         */\n        remove : function (listener, context) {\n            validateListener(listener, 'remove');\n\n            var i = this._indexOfListener(listener, context);\n            if (i !== -1) {\n                this._bindings[i]._destroy(); //no reason to a SignalBinding exist if it isn't attached to a signal\n                this._bindings.splice(i, 1);\n            }\n            return listener;\n        },\n\n        /**\n         * Remove all listeners from the Signal.\n         */\n        removeAll : function () {\n            var n = this._bindings.length;\n            while (n--) {\n                this._bindings[n]._destroy();\n            }\n            this._bindings.length = 0;\n        },\n\n        /**\n         * @return {number} Number of listeners attached to the Signal.\n         */\n        getNumListeners : function () {\n            return this._bindings.length;\n        },\n\n        /**\n         * Stop propagation of the event, blocking the dispatch to next listeners on the queue.\n         * <p><strong>IMPORTANT:</strong> should be called only during signal dispatch, calling it before/after dispatch won't affect signal broadcast.</p>\n         * @see Signal.prototype.disable\n         */\n        halt : function () {\n            this._shouldPropagate = false;\n        },\n\n        /**\n         * Dispatch/Broadcast Signal to all listeners added to the queue.\n         * @param {...*} [params] Parameters that should be passed to each handler.\n         */\n        dispatch : function (params) {\n            if (! this.active) {\n                return;\n            }\n\n            var paramsArr = Array.prototype.slice.call(arguments),\n                n = this._bindings.length,\n                bindings;\n\n            if (this.memorize) {\n                this._prevParams = paramsArr;\n            }\n\n            if (! n) {\n                //should come after memorize\n                return;\n            }\n\n            bindings = this._bindings.slice(); //clone array in case add/remove items during dispatch\n            this._shouldPropagate = true; //in case `halt` was called before dispatch or during the previous dispatch.\n\n            //execute all callbacks until end of the list or until a callback returns `false` or stops propagation\n            //reverse loop since listeners with higher priority will be added at the end of the list\n            do { n--; } while (bindings[n] && this._shouldPropagate && bindings[n].execute(paramsArr) !== false);\n        },\n\n        /**\n         * Forget memorized arguments.\n         * @see Signal.memorize\n         */\n        forget : function(){\n            this._prevParams = null;\n        },\n\n        /**\n         * Remove all bindings from signal and destroy any reference to external objects (destroy Signal object).\n         * <p><strong>IMPORTANT:</strong> calling any method on the signal instance after calling dispose will throw errors.</p>\n         */\n        dispose : function () {\n            this.removeAll();\n            delete this._bindings;\n            delete this._prevParams;\n        },\n\n        /**\n         * @return {string} String representation of the object.\n         */\n        toString : function () {\n            return '[Signal active:'+ this.active +' numListeners:'+ this.getNumListeners() +']';\n        }\n\n    };\n\n\n    // Namespace -----------------------------------------------------\n    //================================================================\n\n    /**\n     * Signals namespace\n     * @namespace\n     * @name signals\n     */\n    var signals = Signal;\n\n    /**\n     * Custom event broadcaster\n     * @see Signal\n     */\n    // alias for backwards compatibility (see #gh-44)\n    signals.Signal = Signal;\n\n\n\n    //exports to multiple environments\n    if(typeof define === 'function' && define.amd){ //AMD\n        define(function () { return signals; });\n    } else if (typeof module !== 'undefined' && module.exports){ //node\n        module.exports = signals;\n    } else { //browser\n        //use string because of Google closure compiler ADVANCED_MODE\n        /*jslint sub:true */\n        global['signals'] = signals;\n    }\n\n}(this));\n\n},{}],11:[function(require,module,exports){\nvar els = {\n\tplayer : document.getElementsByClassName('text--player')[0],\n\tgeneral : document.getElementsByClassName('text--general')[0],\n\tai : document.getElementsByClassName('text--ai')[0]\n};\n\nmodule.exports = function(classPostFix, text) {\n\n\tels[classPostFix].innerHTML = text;\n};\n},{}]},{},[7])\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvcHJvY2Vzcy9icm93c2VyLmpzIiwic3JjL2Fzc2V0cy9zY3JpcHRzL2NvcmUvTW92ZS5qcyIsInNyYy9hc3NldHMvc2NyaXB0cy9jb3JlL1BsYXllci5qcyIsInNyYy9hc3NldHMvc2NyaXB0cy9jb3JlL2FjdGlvbkhhbmRsZXIuanMiLCJzcmMvYXNzZXRzL3NjcmlwdHMvY29yZS9jb25zdGFudHMuanMiLCJzcmMvYXNzZXRzL3NjcmlwdHMvY29yZS9zaWduYWxCdXMuanMiLCJzcmMvYXNzZXRzL3NjcmlwdHMvbWFpbi5qcyIsInNyYy9hc3NldHMvc2NyaXB0cy91dGlscy9rZXcuanMiLCJzcmMvYXNzZXRzL3NjcmlwdHMvdXRpbHMvc2FtcGxlQXJyYXkuanMiLCJzcmMvYXNzZXRzL3NjcmlwdHMvdXRpbHMvc2lnbmFscy5qcyIsInNyYy9hc3NldHMvc2NyaXB0cy91dGlscy93cml0ZUluRGl2LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNiQTtBQUNBO0FBQ0E7O0FDRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ25HQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUM1MUJBO0FBQ0E7QUFDQTtBQUNBOztBQ0hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN2JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIi8vIHNoaW0gZm9yIHVzaW5nIHByb2Nlc3MgaW4gYnJvd3NlclxuXG52YXIgcHJvY2VzcyA9IG1vZHVsZS5leHBvcnRzID0ge307XG52YXIgcXVldWUgPSBbXTtcbnZhciBkcmFpbmluZyA9IGZhbHNlO1xudmFyIGN1cnJlbnRRdWV1ZTtcbnZhciBxdWV1ZUluZGV4ID0gLTE7XG5cbmZ1bmN0aW9uIGNsZWFuVXBOZXh0VGljaygpIHtcbiAgICBkcmFpbmluZyA9IGZhbHNlO1xuICAgIGlmIChjdXJyZW50UXVldWUubGVuZ3RoKSB7XG4gICAgICAgIHF1ZXVlID0gY3VycmVudFF1ZXVlLmNvbmNhdChxdWV1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuICAgIH1cbiAgICBpZiAocXVldWUubGVuZ3RoKSB7XG4gICAgICAgIGRyYWluUXVldWUoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGRyYWluUXVldWUoKSB7XG4gICAgaWYgKGRyYWluaW5nKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGNsZWFuVXBOZXh0VGljayk7XG4gICAgZHJhaW5pbmcgPSB0cnVlO1xuXG4gICAgdmFyIGxlbiA9IHF1ZXVlLmxlbmd0aDtcbiAgICB3aGlsZShsZW4pIHtcbiAgICAgICAgY3VycmVudFF1ZXVlID0gcXVldWU7XG4gICAgICAgIHF1ZXVlID0gW107XG4gICAgICAgIHdoaWxlICgrK3F1ZXVlSW5kZXggPCBsZW4pIHtcbiAgICAgICAgICAgIGlmIChjdXJyZW50UXVldWUpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50UXVldWVbcXVldWVJbmRleF0ucnVuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuICAgICAgICBsZW4gPSBxdWV1ZS5sZW5ndGg7XG4gICAgfVxuICAgIGN1cnJlbnRRdWV1ZSA9IG51bGw7XG4gICAgZHJhaW5pbmcgPSBmYWxzZTtcbiAgICBjbGVhclRpbWVvdXQodGltZW91dCk7XG59XG5cbnByb2Nlc3MubmV4dFRpY2sgPSBmdW5jdGlvbiAoZnVuKSB7XG4gICAgdmFyIGFyZ3MgPSBuZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aCAtIDEpO1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgYXJnc1tpIC0gMV0gPSBhcmd1bWVudHNbaV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcXVldWUucHVzaChuZXcgSXRlbShmdW4sIGFyZ3MpKTtcbiAgICBpZiAocXVldWUubGVuZ3RoID09PSAxICYmICFkcmFpbmluZykge1xuICAgICAgICBzZXRUaW1lb3V0KGRyYWluUXVldWUsIDApO1xuICAgIH1cbn07XG5cbi8vIHY4IGxpa2VzIHByZWRpY3RpYmxlIG9iamVjdHNcbmZ1bmN0aW9uIEl0ZW0oZnVuLCBhcnJheSkge1xuICAgIHRoaXMuZnVuID0gZnVuO1xuICAgIHRoaXMuYXJyYXkgPSBhcnJheTtcbn1cbkl0ZW0ucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmZ1bi5hcHBseShudWxsLCB0aGlzLmFycmF5KTtcbn07XG5wcm9jZXNzLnRpdGxlID0gJ2Jyb3dzZXInO1xucHJvY2Vzcy5icm93c2VyID0gdHJ1ZTtcbnByb2Nlc3MuZW52ID0ge307XG5wcm9jZXNzLmFyZ3YgPSBbXTtcbnByb2Nlc3MudmVyc2lvbiA9ICcnOyAvLyBlbXB0eSBzdHJpbmcgdG8gYXZvaWQgcmVnZXhwIGlzc3Vlc1xucHJvY2Vzcy52ZXJzaW9ucyA9IHt9O1xuXG5mdW5jdGlvbiBub29wKCkge31cblxucHJvY2Vzcy5vbiA9IG5vb3A7XG5wcm9jZXNzLmFkZExpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3Mub25jZSA9IG5vb3A7XG5wcm9jZXNzLm9mZiA9IG5vb3A7XG5wcm9jZXNzLnJlbW92ZUxpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3MucmVtb3ZlQWxsTGlzdGVuZXJzID0gbm9vcDtcbnByb2Nlc3MuZW1pdCA9IG5vb3A7XG5cbnByb2Nlc3MuYmluZGluZyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmJpbmRpbmcgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcblxucHJvY2Vzcy5jd2QgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAnLycgfTtcbnByb2Nlc3MuY2hkaXIgPSBmdW5jdGlvbiAoZGlyKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmNoZGlyIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbn07XG5wcm9jZXNzLnVtYXNrID0gZnVuY3Rpb24oKSB7IHJldHVybiAwOyB9O1xuIiwidmFyIFEgPSByZXF1aXJlKCcuLi91dGlscy9rZXcnKSxcblx0U2lnbmFsID0gcmVxdWlyZSgnLi4vdXRpbHMvc2lnbmFscycpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGFjdGlvbiwgZGVsYXksIGhhc0xvZ3MpIHtcblxuXHR2YXIgU1RBVEVfVE9PX1NPT04gPSAwLFxuXHRcdFNUQVRFX09OX1RJTUUgPSAxO1xuXG5cdHZhciBfdGltZXIsXG5cdFx0X2RlZmVycmVkLFxuXHRcdF9zdGF0ZUlzT25UaW1lU2lnbmFsID0gbmV3IFNpZ25hbCgpLFxuXHRcdF9jdXJyZW50U3RhdGUgPSBTVEFURV9UT09fU09PTixcblx0XHRfcmVxdWVzdGVkQWN0aW9uID0gYWN0aW9uLFxuXHRcdF9kZWxheSA9IGRlbGF5O1xuXG5cblx0ZnVuY3Rpb24gZXhlY3V0ZSgpIHtcblxuXHRcdF9kZWZlcnJlZCA9IFEuZGVmZXIoKTtcblxuXHRcdHN0YXJ0VGltZXIoX2RlbGF5LCBvbkRlbGF5RmluaXNoZWQpO1xuXG5cdFx0cmV0dXJuIF9kZWZlcnJlZC5wcm9taXNlO1xuXHR9XG5cblx0ZnVuY3Rpb24gb25EZWxheUZpbmlzaGVkKCkge1xuXG5cdFx0X2N1cnJlbnRTdGF0ZSA9IFNUQVRFX09OX1RJTUU7XG5cdFx0X3N0YXRlSXNPblRpbWVTaWduYWwuZGlzcGF0Y2goX3JlcXVlc3RlZEFjdGlvbik7XG5cdH1cblxuXHRmdW5jdGlvbiBmaXJlQWN0aW9uKGZpcmVkQWN0aW9uKSB7XG5cblx0XHRraWxsVGltZXIoKTtcblxuXHRcdGlmKF9jdXJyZW50U3RhdGUgPT09IFNUQVRFX1RPT19TT09OKSB7XG5cblx0XHRcdF9kZWZlcnJlZC5yZWplY3QoJ3RvbyBzb29uIScpO1xuXG5cdFx0fSBlbHNlIGlmKGZpcmVkQWN0aW9uICE9PSBfcmVxdWVzdGVkQWN0aW9uKSB7XG5cblx0XHRcdF9kZWZlcnJlZC5yZWplY3QoJ3dyb25nIGFjdGlvbiEnKTtcblxuXHRcdH0gZWxzZSB7XG5cblx0XHRcdF9kZWZlcnJlZC5yZXNvbHZlKCdzdWNjZXNzIScpO1xuXHRcdH1cblx0fVxuXG5cdGZ1bmN0aW9uIGdldFJlcXVlc3RlZEFjdGlvbigpIHtcblxuXHRcdHJldHVybiBfcmVxdWVzdGVkQWN0aW9uO1xuXHR9XG5cblx0ZnVuY3Rpb24gZGVzdHJveSgpIHtcblxuXHRcdGtpbGxUaW1lcigpO1xuXHR9XG5cblx0ZnVuY3Rpb24ga2lsbFRpbWVyKCkge1xuXG5cdFx0Y2xlYXJUaW1lb3V0KF90aW1lcik7XG5cdH1cblxuXHRmdW5jdGlvbiBzdGFydFRpbWVyKGRlbGF5LCBjYWxsYmFjaykge1xuXG5cdFx0X3RpbWVyID0gc2V0VGltZW91dChjYWxsYmFjaywgZGVsYXkpO1xuXHR9XG5cblx0dGhpcy5zdGF0ZUlzT25UaW1lU2lnbmFsID0gX3N0YXRlSXNPblRpbWVTaWduYWw7XG5cdHRoaXMuZ2V0UmVxdWVzdGVkQWN0aW9uID0gZ2V0UmVxdWVzdGVkQWN0aW9uO1xuXHR0aGlzLmZpcmVBY3Rpb24gPSBmaXJlQWN0aW9uO1xuXHR0aGlzLmV4ZWN1dGUgPSBleGVjdXRlO1xuXHR0aGlzLmRlc3Ryb3kgPSBkZXN0cm95O1xufTsiLCJ2YXIgUSA9IHJlcXVpcmUoJy4uL3V0aWxzL2tldycpLFxuXHR3cml0ZUluRGl2ID0gcmVxdWlyZSgnLi4vdXRpbHMvd3JpdGVJbkRpdicpLFxuXHRNb3ZlID0gcmVxdWlyZSgnLi9Nb3ZlJyksXG5cdGNvbnN0YW50cyA9IHJlcXVpcmUoJy4vY29uc3RhbnRzJyksXG5cdHNpZ25hbEJ1cyA9IHJlcXVpcmUoJy4vc2lnbmFsQnVzJyksXG5cdHNhbXBsZSA9IHJlcXVpcmUoJy4uL3V0aWxzL3NhbXBsZUFycmF5Jyk7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7XG5cblx0dmFyIF9kZWZlcnJlZCxcblx0XHRfY2xhc3NQb3N0Rml4LFxuXHRcdF9jaGFuY2VPZkZhaWxpbmcsXG5cdFx0X2RlbGF5LFxuXHRcdF9jaGFpbixcblx0XHRfY3VycmVudE1vdmUsXG5cdFx0X2lzQXV0b21hdGVkUGxheWVyO1xuXG5cblx0ZnVuY3Rpb24gaW5pdChkaXZDbGFzcywgbnVtTW92ZXMsIGRlbGF5LCBpc0F1dG9tYXRlZFBsYXllciwgY2hhbmNlT2ZGYWlsaW5nKSB7XG5cblx0XHR2YXIgaSA9IDA7XG5cblx0XHRfZGVmZXJyZWQgPSBRLmRlZmVyKCk7XG5cdFx0X2NsYXNzUG9zdEZpeCA9IGRpdkNsYXNzO1xuXHRcdF9jaGFpbiA9IFtdO1xuXHRcdF9kZWxheSA9IGRlbGF5O1xuXHRcdF9jaGFuY2VPZkZhaWxpbmcgPSBjaGFuY2VPZkZhaWxpbmc7XG5cdFx0X2lzQXV0b21hdGVkUGxheWVyID0gaXNBdXRvbWF0ZWRQbGF5ZXI7XG5cblx0XHRmb3IoaTsgaSA8IG51bU1vdmVzOyBpKyspIHtcblxuXHRcdFx0YWRkUmFuZG9tTW92ZSgpO1xuXHRcdH1cblxuXHRcdGlmKCFfaXNBdXRvbWF0ZWRQbGF5ZXIpIHtcblxuXHRcdFx0c2lnbmFsQnVzLkFDVElPTl9GSVJFRC5hZGQob25BY3Rpb25GaXJlZCk7XG5cdFx0fVxuXHR9XG5cblx0ZnVuY3Rpb24gZGVzdHJveSgpIHtcblxuXHRcdHZhciBpID0gMDtcblxuXHRcdGlmKF9jdXJyZW50TW92ZSkge1xuXG5cdFx0XHRfY3VycmVudE1vdmUuZGVzdHJveSgpO1xuXHRcdH1cblxuXHRcdGZvcihpOyBpIDwgX2NoYWluLmxlbmd0aDsgaSsrKSB7XG5cblx0XHRcdF9jaGFpbltpXS5kZXN0cm95KCk7XG5cdFx0fVxuXG5cdFx0X2NoYWluID0gbnVsbDtcblx0XHRzaWduYWxCdXMuQUNUSU9OX0ZJUkVELnJlbW92ZShvbkFjdGlvbkZpcmVkKTtcblx0fVxuXG5cdGZ1bmN0aW9uIG9uQWN0aW9uRmlyZWQoZmlyZWRBY3Rpb24pIHtcblxuXHRcdGlmKF9jdXJyZW50TW92ZSkge1xuXG5cdFx0XHRfY3VycmVudE1vdmUuZmlyZUFjdGlvbihmaXJlZEFjdGlvbik7XG5cdFx0fVxuXHR9XG5cblx0ZnVuY3Rpb24gYWRkUmFuZG9tTW92ZSgpIHtcblxuXHRcdHZhciByYW5kb21BY3Rpb24gPSBzYW1wbGUoY29uc3RhbnRzLkFMTF9BQ1RJT05TKSxcblx0XHRcdG5ld01vdmUgPSBuZXcgTW92ZShyYW5kb21BY3Rpb24sIF9kZWxheSk7XG5cblx0XHRfY2hhaW4ucHVzaChuZXdNb3ZlKTtcblx0fVxuXG5cdGZ1bmN0aW9uIHN0YXJ0KCkge1xuXG5cdFx0dmFsaWRhdGVDaGFpbigpO1xuXG5cdFx0d3JpdGVJbkRpdihfY2xhc3NQb3N0Rml4LCAnR2V0IFJFQURZIScpO1xuXG5cdFx0cmV0dXJuIF9kZWZlcnJlZC5wcm9taXNlO1xuXHR9XG5cblx0ZnVuY3Rpb24gdmFsaWRhdGVDaGFpbigpIHtcblxuXHRcdF9jdXJyZW50TW92ZSA9IF9jaGFpbi5zaGlmdCgpO1xuXG5cdFx0aWYoX2N1cnJlbnRNb3ZlKSB7XG5cblx0XHRcdF9jdXJyZW50TW92ZS5zdGF0ZUlzT25UaW1lU2lnbmFsLmFkZChvbkN1cnJlbnRNb3ZlSXNSZWFkeSk7XG5cdFx0XHRleGVjdXRlTW92ZSgpO1xuXG5cdFx0fSBlbHNlIHtcblxuXHRcdFx0X2RlZmVycmVkLnJlc29sdmUoKTtcblx0XHR9XG5cdH1cblxuXHRmdW5jdGlvbiBleGVjdXRlTW92ZSgpIHtcblxuXHRcdF9jdXJyZW50TW92ZS5leGVjdXRlKClcblx0XHRcdC50aGVuKG1vdmVFeGVjdXRlZClcblx0XHRcdC5mYWlsKG1vdmVGYWlsZWQpXG5cdFx0XHQuZmluKG1vdmVGaW5pc2hlZClcblx0fVxuXG5cdGZ1bmN0aW9uIG9uQ3VycmVudE1vdmVJc1JlYWR5KCkge1xuXG5cdFx0dmFyIHJlcXVlc3RlZEFjdGlvbiA9IF9jdXJyZW50TW92ZS5nZXRSZXF1ZXN0ZWRBY3Rpb24oKSxcblx0XHRcdHNob3VsZEZhaWw7XG5cblx0XHRpZihfaXNBdXRvbWF0ZWRQbGF5ZXIpIHtcblxuXHRcdFx0c2hvdWxkRmFpbCA9IE1hdGgucmFuZG9tKCkgPCBfY2hhbmNlT2ZGYWlsaW5nO1xuXG5cdFx0XHRpZihzaG91bGRGYWlsKSB7XG5cblx0XHRcdFx0X2N1cnJlbnRNb3ZlLmZpcmVBY3Rpb24oKTtcblxuXHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRfY3VycmVudE1vdmUuZmlyZUFjdGlvbihyZXF1ZXN0ZWRBY3Rpb24pO1xuXHRcdFx0fVxuXG5cdFx0fSBlbHNlIHtcblxuXHRcdFx0d3JpdGVJbkRpdihfY2xhc3NQb3N0Rml4LCAnRklSRSEgJyArIHJlcXVlc3RlZEFjdGlvbik7XG5cdFx0fVxuXHR9XG5cblx0ZnVuY3Rpb24gbW92ZUV4ZWN1dGVkKCkge1xuXG5cdFx0aWYoX2lzQXV0b21hdGVkUGxheWVyKSB7XG5cblx0XHRcdHdyaXRlSW5EaXYoX2NsYXNzUG9zdEZpeCwgJ0FJIGhhcyAnICsgX2NoYWluLmxlbmd0aCArICcgbW92ZXMgbGVmdCcpO1xuXG5cdFx0fSBlbHNlIHtcblxuXHRcdFx0d3JpdGVJbkRpdihfY2xhc3NQb3N0Rml4LCAnR290IGl0IScpO1xuXHRcdH1cblx0fVxuXG5cdGZ1bmN0aW9uIG1vdmVGYWlsZWQobWVzc2FnZSkge1xuXG5cdFx0aWYoIV9pc0F1dG9tYXRlZFBsYXllcikge1xuXG5cdFx0XHR3cml0ZUluRGl2KF9jbGFzc1Bvc3RGaXgsICdXb29wcywgJyArIG1lc3NhZ2UpO1xuXG5cdFx0fSBlbHNlIHtcblxuXHRcdFx0d3JpdGVJbkRpdihfY2xhc3NQb3N0Rml4LCAnQUkgbWlzc2VkIScpO1xuXHRcdH1cblxuXHRcdGFkZFJhbmRvbU1vdmUoKTtcblx0fVxuXG5cdGZ1bmN0aW9uIG1vdmVGaW5pc2hlZCgpIHtcblxuXHRcdF9jdXJyZW50TW92ZS5kZXN0cm95KCk7XG5cdFx0dmFsaWRhdGVDaGFpbigpO1xuXHR9XG5cblx0dGhpcy5pbml0ID0gaW5pdDtcblx0dGhpcy5zdGFydCA9IHN0YXJ0O1xuXHR0aGlzLmRlc3Ryb3kgPSBkZXN0cm95O1xufTsiLCJ2YXIgY29uc3RhbnRzID0gcmVxdWlyZSgnLi9jb25zdGFudHMnKSxcblx0c2lnbmFsQnVzID0gcmVxdWlyZSgnLi9zaWduYWxCdXMnKTtcblxuZnVuY3Rpb24gaW5pdCgpIHtcblxuXHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIG9uS2V5RG93bik7XG59XG5cbmZ1bmN0aW9uIG9uS2V5RG93bihlKSB7XG5cblx0dmFyIGFjdGlvbjtcblxuXHRzd2l0Y2goZS5rZXlDb2RlKSB7XG5cblx0XHRjYXNlIDEzOiBhY3Rpb24gPSBjb25zdGFudHMuQUNUSU9OX0VOVEVSOyBicmVhaztcblxuXHRcdGNhc2UgMzg6IGFjdGlvbiA9IGNvbnN0YW50cy5BQ1RJT05fVVA7IGJyZWFrO1xuXHRcdGNhc2UgNDA6IGFjdGlvbiA9IGNvbnN0YW50cy5BQ1RJT05fRE9XTjsgYnJlYWs7XG5cdFx0Y2FzZSAzNzogYWN0aW9uID0gY29uc3RhbnRzLkFDVElPTl9MRUZUOyBicmVhaztcblx0XHRjYXNlIDM5OiBhY3Rpb24gPSBjb25zdGFudHMuQUNUSU9OX1JJR0hUOyBicmVhaztcblx0fVxuXG5cdHNpZ25hbEJ1cy5BQ1RJT05fRklSRUQuZGlzcGF0Y2goYWN0aW9uKTtcbn1cblxuZXhwb3J0cy5pbml0ID0gaW5pdDsiLCJ2YXIgQUNUSU9OX1VQID0gJ0FDVElPTl9VUCcsXG5cdEFDVElPTl9FTlRFUiA9ICdBQ1RJT05fRU5URVInLFxuXHRBQ1RJT05fRE9XTiA9ICdBQ1RJT05fRE9XTicsXG5cdEFDVElPTl9MRUZUID0gJ0FDVElPTl9MRUZUJyxcblx0QUNUSU9OX1JJR0hUID0gJ0FDVElPTl9SSUdIVCc7XG5cbmV4cG9ydHMuQUNUSU9OX0VOVEVSID0gQUNUSU9OX0VOVEVSO1xuZXhwb3J0cy5BQ1RJT05fVVAgPSBBQ1RJT05fVVA7XG5leHBvcnRzLkFDVElPTl9ET1dOID0gQUNUSU9OX0RPV047XG5leHBvcnRzLkFDVElPTl9MRUZUID0gQUNUSU9OX0xFRlQ7XG5leHBvcnRzLkFDVElPTl9SSUdIVCA9IEFDVElPTl9SSUdIVDtcbmV4cG9ydHMuQUxMX0FDVElPTlMgPSBbQUNUSU9OX1VQLCBBQ1RJT05fRE9XTiwgQUNUSU9OX0xFRlQsIEFDVElPTl9SSUdIVF07XG5cbiIsInZhciBTaWduYWwgPSByZXF1aXJlKCcuLi91dGlscy9zaWduYWxzJyk7XG5cbmV4cG9ydHMuQUNUSU9OX0ZJUkVEID0gbmV3IFNpZ25hbCgpOyIsInZhciBhY3Rpb25IYW5kbGVyID0gcmVxdWlyZSgnLi9jb3JlL2FjdGlvbkhhbmRsZXInKSxcblx0c2lnbmFsQnVzID0gcmVxdWlyZSgnLi9jb3JlL3NpZ25hbEJ1cycpLFxuXHR3cml0ZUluRGl2ID0gcmVxdWlyZSgnLi91dGlscy93cml0ZUluRGl2JyksXG5cdGNvbnN0YW50cyA9IHJlcXVpcmUoJy4vY29yZS9jb25zdGFudHMnKSxcblx0UGxheWVyID0gcmVxdWlyZSgnLi9jb3JlL1BsYXllcicpO1xuXG5cbnZhciBodW1hblBsYXllciA9IG5ldyBQbGF5ZXIoKSxcblx0YWlQbGF5ZXIgPSBuZXcgUGxheWVyKCksXG5cdGlzUGxheWluZyA9IGZhbHNlLFxuXHRkYXRHdWlQcm9wcyA9IG5ldyBmdW5jdGlvbigpIHtcblxuXHRcdHRoaXMubW92ZXMgPSA1O1xuXHRcdHRoaXMucGxheWVyRGVsYXkgPSAxMDAwO1xuXHRcdHRoaXMuYWlEZWxheSA9IDIwMDA7XG5cdFx0dGhpcy5haU1pc3NDaGFuY2UgPSAwLjE7XG5cblx0XHR0aGlzLnN0YXJ0ID0gc3RhcnQ7XG5cdFx0dGhpcy5zdG9wID0gc3RvcDtcblx0fSgpO1xuXG52YXIgZ3VpID0gbmV3IGRhdC5HVUkoKTtcbmd1aS5hZGQoZGF0R3VpUHJvcHMsICdtb3ZlcycsIDAsIDEwKS5zdGVwKDEpO1xuZ3VpLmFkZChkYXRHdWlQcm9wcywgJ3BsYXllckRlbGF5JywgMCwgNTAwMCkuc3RlcCgxMDApO1xuZ3VpLmFkZChkYXRHdWlQcm9wcywgJ2FpRGVsYXknLCAwLCA1MDAwKS5zdGVwKDEwMCk7XG5ndWkuYWRkKGRhdEd1aVByb3BzLCAnYWlNaXNzQ2hhbmNlJywgMCwgMSkuc3RlcCgwLjA1KTtcbmd1aS5hZGQoZGF0R3VpUHJvcHMsICdzdGFydCcpO1xuZ3VpLmFkZChkYXRHdWlQcm9wcywgJ3N0b3AnKTtcblxud3JpdGVJbkRpdignZ2VuZXJhbCcsICdQcmVzcyBgRU5URVJgIHRvIHN0YXJ0Jyk7XG5hY3Rpb25IYW5kbGVyLmluaXQoKTtcblxuc2lnbmFsQnVzLkFDVElPTl9GSVJFRC5hZGQob25BY3Rpb25GaXJlZCk7XG5cbmZ1bmN0aW9uIG9uQWN0aW9uRmlyZWQoYWN0aW9uKSB7XG5cblx0aWYoYWN0aW9uID09PSBjb25zdGFudHMuQUNUSU9OX0VOVEVSKSB7XG5cblx0XHRpZighaXNQbGF5aW5nKSB7XG5cblx0XHRcdHN0YXJ0KCk7XG5cblx0XHR9IGVsc2Uge1xuXG5cdFx0XHRzdG9wKCk7XG5cdFx0fVxuXHR9XG59XG5cbmZ1bmN0aW9uIHN0YXJ0KCkge1xuXG5cdGlmKGlzUGxheWluZykge1xuXG5cdFx0c3RvcCgpO1xuXHR9XG5cblx0d3JpdGVJbkRpdignZ2VuZXJhbCcsICcnKTtcblxuXHRpc1BsYXlpbmcgPSB0cnVlO1xuXHRodW1hblBsYXllci5pbml0KCdwbGF5ZXInLCBkYXRHdWlQcm9wcy5tb3ZlcywgZGF0R3VpUHJvcHMucGxheWVyRGVsYXksIGZhbHNlKTtcblx0YWlQbGF5ZXIuaW5pdCgnYWknLCBkYXRHdWlQcm9wcy5tb3ZlcywgZGF0R3VpUHJvcHMuYWlEZWxheSwgdHJ1ZSwgZGF0R3VpUHJvcHMuYWlNaXNzQ2hhbmNlKTtcblxuXHRodW1hblBsYXllci5zdGFydCgpXG5cdFx0LnRoZW4oZnVuY3Rpb24oKXtcblx0XHRcdGdhbWVPdmVyKHRydWUpO1xuXHRcdH0pLmZhaWwob25FcnJvcik7XG5cdGFpUGxheWVyLnN0YXJ0KClcblx0XHQudGhlbihmdW5jdGlvbigpe1xuXG5cdFx0XHRnYW1lT3ZlcihmYWxzZSk7XG5cdFx0fSkuZmFpbChvbkVycm9yKTtcbn1cblxuZnVuY3Rpb24gb25FcnJvcihlKSB7XG5cdGNvbnNvbGUuZXJyb3IoZSk7XG59XG5cbmZ1bmN0aW9uIGdhbWVPdmVyKHBsYXllcldvbikge1xuXG5cdHdyaXRlSW5EaXYoJ3BsYXllcicsICcnKTtcblx0d3JpdGVJbkRpdignYWknLCAnJyk7XG5cdGlmKHBsYXllcldvbikge1xuXG5cdFx0d3JpdGVJbkRpdignZ2VuZXJhbCcsICdZb3Ugd29uITxicj5QcmVzcyBgRU5URVJgIHRvIHJlcGxheScpO1xuXG5cdH0gZWxzZSB7XG5cblx0XHR3cml0ZUluRGl2KCdnZW5lcmFsJywgJ1lvdSBsb3N0Li4uPGJyPlByZXNzIGBFTlRFUmAgdG8gcmVwbGF5Jyk7XG5cdH1cblxuXHRzdG9wKCk7XG59XG5cbmZ1bmN0aW9uIHN0b3AoKSB7XG5cblx0aXNQbGF5aW5nID0gZmFsc2U7XG5cblx0aHVtYW5QbGF5ZXIuZGVzdHJveSgpO1xuXHRhaVBsYXllci5kZXN0cm95KCk7XG59IiwiXG4vKipcbiAqIEFuIG9iamVjdCByZXByZXNlbnRpbmcgYSBcInByb21pc2VcIiBmb3IgYSBmdXR1cmUgdmFsdWVcbiAqXG4gKiBAcGFyYW0gez9mdW5jdGlvbihULCA/KT19IG9uU3VjY2VzcyBhIGZ1bmN0aW9uIHRvIGhhbmRsZSBzdWNjZXNzZnVsXG4gKiAgICAgcmVzb2x1dGlvbiBvZiB0aGlzIHByb21pc2VcbiAqIEBwYXJhbSB7P2Z1bmN0aW9uKCFFcnJvciwgPyk9fSBvbkZhaWwgYSBmdW5jdGlvbiB0byBoYW5kbGUgZmFpbGVkXG4gKiAgICAgcmVzb2x1dGlvbiBvZiB0aGlzIHByb21pc2VcbiAqIEBjb25zdHJ1Y3RvclxuICogQHRlbXBsYXRlIFRcbiAqL1xuZnVuY3Rpb24gUHJvbWlzZShvblN1Y2Nlc3MsIG9uRmFpbCkge1xuICB0aGlzLnByb21pc2UgPSB0aGlzXG4gIHRoaXMuX2lzUHJvbWlzZSA9IHRydWVcbiAgdGhpcy5fc3VjY2Vzc0ZuID0gb25TdWNjZXNzXG4gIHRoaXMuX2ZhaWxGbiA9IG9uRmFpbFxuICB0aGlzLl9zY29wZSA9IHRoaXNcbiAgdGhpcy5fYm91bmRBcmdzID0gbnVsbFxuICB0aGlzLl9oYXNDb250ZXh0ID0gZmFsc2VcbiAgdGhpcy5fbmV4dENvbnRleHQgPSB1bmRlZmluZWRcbiAgdGhpcy5fY3VycmVudENvbnRleHQgPSB1bmRlZmluZWRcbn1cblxuLyoqXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCl9IGNhbGxiYWNrXG4gKi9cbmZ1bmN0aW9uIG5leHRUaWNrIChjYWxsYmFjaykge1xuICBjYWxsYmFjaygpXG59XG5cbmlmICh0eXBlb2YgcHJvY2VzcyAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIHByb2Nlc3MubmV4dFRpY2sgPT09ICdmdW5jdGlvbicpIHtcbiAgbmV4dFRpY2sgPSBwcm9jZXNzLm5leHRUaWNrXG59XG5cbi8qKlxuICogQWxsIGNhbGxiYWNrIGV4ZWN1dGlvbiBzaG91bGQgZ28gdGhyb3VnaCB0aGlzIGZ1bmN0aW9uLiAgV2hpbGUgdGhlXG4gKiBpbXBsZW1lbnRhdGlvbiBiZWxvdyBpcyBzaW1wbGUsIGl0IGNhbiBiZSByZXBsYWNlZCB3aXRoIG1vcmUgc29waGlzdGljYXRlZFxuICogaW1wbGVtZW50YXRpb25zIHRoYXQgZW5mb3JjZSBRb1Mgb24gdGhlIGV2ZW50IGxvb3AuXG4gKlxuICogQHBhcmFtIHtQcm9taXNlfSBkZWZlclxuICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2tcbiAqIEBwYXJhbSB7T2JqZWN0fHVuZGVmaW5lZH0gc2NvcGVcbiAqIEBwYXJhbSB7QXJyYXl9IGFyZ3NcbiAqL1xuZnVuY3Rpb24gbmV4dFRpY2tDYWxsYmFjayAoZGVmZXIsIGNhbGxiYWNrLCBzY29wZSwgYXJncykge1xuICB0cnkge1xuICAgIGRlZmVyLnJlc29sdmUoY2FsbGJhY2suYXBwbHkoc2NvcGUsIGFyZ3MpKVxuICB9IGNhdGNoICh0aHJvd24pIHtcbiAgICBkZWZlci5yZWplY3QodGhyb3duKVxuICB9XG59XG5cbi8qKlxuICogVXNlZCBmb3IgYWNjZXNzaW5nIHRoZSBuZXh0VGljayBmdW5jdGlvbiBmcm9tIG91dHNpZGUgdGhlIGtldyBtb2R1bGUuXG4gKlxuICogQHJldHVybiB7RnVuY3Rpb259XG4gKi9cbmZ1bmN0aW9uIGdldE5leHRUaWNrRnVuY3Rpb24gKCkge1xuICByZXR1cm4gbmV4dFRpY2tcbn1cblxuLyoqXG4gKiBVc2VkIGZvciBvdmVycmlkaW5nIHRoZSBuZXh0VGljayBmdW5jdGlvbiBmcm9tIG91dHNpZGUgdGhlIGtldyBtb2R1bGUgc28gdGhhdFxuICogdGhlIHVzZXIgY2FuIHBsdWcgYW5kIHBsYXkgbG93ZXIgbGV2ZWwgc2NoZWR1bGVyc1xuICogQHBhcmFtIHshRnVuY3Rpb259IGZuXG4gKi9cbmZ1bmN0aW9uIHNldE5leHRUaWNrRnVuY3Rpb24gKGZuKSB7XG4gIG5leHRUaWNrID0gZm5cbn1cblxuLyoqXG4gKiBLZWVwIHRyYWNrIG9mIHRoZSBudW1iZXIgb2YgcHJvbWlzZXMgdGhhdCBhcmUgcmVqZWN0ZWQgYWxvbmcgc2lkZVxuICogdGhlIG51bWJlciBvZiByZWplY3RlZCBwcm9taXNlcyB3ZSBjYWxsIF9mYWlsRm4gb24gc28gd2UgY2FuIGxvb2tcbiAqIGZvciBsZWFrZWQgcmVqZWN0aW9ucy5cbiAqIEBjb25zdHJ1Y3RvclxuICovXG5mdW5jdGlvbiBQcm9taXNlU3RhdHMoKSB7XG4gIC8qKiBAdHlwZSB7bnVtYmVyfSAqL1xuICB0aGlzLmVycm9yc0VtaXR0ZWQgPSAwXG5cbiAgLyoqIEB0eXBlIHtudW1iZXJ9ICovXG4gIHRoaXMuZXJyb3JzSGFuZGxlZCA9IDBcbn1cblxudmFyIHN0YXRzID0gbmV3IFByb21pc2VTdGF0cygpXG5cblByb21pc2UucHJvdG90eXBlLl9oYW5kbGVFcnJvciA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKCF0aGlzLl9lcnJvckhhbmRsZWQpIHtcbiAgICBzdGF0cy5lcnJvcnNIYW5kbGVkKytcbiAgICB0aGlzLl9lcnJvckhhbmRsZWQgPSB0cnVlXG4gIH1cbn1cblxuLyoqXG4gKiBTcGVjaWZ5IHRoYXQgdGhlIGN1cnJlbnQgcHJvbWlzZSBzaG91bGQgaGF2ZSBhIHNwZWNpZmllZCBjb250ZXh0XG4gKiBAcGFyYW0gIHsqfSBjb250ZXh0IGNvbnRleHRcbiAqIEBwcml2YXRlXG4gKi9cblByb21pc2UucHJvdG90eXBlLl91c2VDb250ZXh0ID0gZnVuY3Rpb24gKGNvbnRleHQpIHtcbiAgdGhpcy5fbmV4dENvbnRleHQgPSB0aGlzLl9jdXJyZW50Q29udGV4dCA9IGNvbnRleHRcbiAgdGhpcy5faGFzQ29udGV4dCA9IHRydWVcbiAgcmV0dXJuIHRoaXNcbn1cblxuUHJvbWlzZS5wcm90b3R5cGUuY2xlYXJDb250ZXh0ID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLl9oYXNDb250ZXh0ID0gZmFsc2VcbiAgdGhpcy5fbmV4dENvbnRleHQgPSB1bmRlZmluZWRcbiAgcmV0dXJuIHRoaXNcbn1cblxuLyoqXG4gKiBTZXQgdGhlIGNvbnRleHQgZm9yIGFsbCBwcm9taXNlIGhhbmRsZXJzIHRvIGZvbGxvd1xuICpcbiAqIE5PVEUoZHB1cCk6IFRoaXMgc2hvdWxkIGJlIGNvbnNpZGVyZWQgZGVwcmVjYXRlZC4gIEl0IGRvZXMgbm90IGRvIHdoYXQgbW9zdFxuICogcGVvcGxlIHdvdWxkIGV4cGVjdC4gIFRoZSBjb250ZXh0IHdpbGwgYmUgcGFzc2VkIGFzIGEgc2Vjb25kIGFyZ3VtZW50IHRvIGFsbFxuICogc3Vic2VxdWVudCBjYWxsYmFja3MuXG4gKlxuICogQHBhcmFtIHsqfSBjb250ZXh0IEFuIGFyYml0cmFyeSBjb250ZXh0XG4gKi9cblByb21pc2UucHJvdG90eXBlLnNldENvbnRleHQgPSBmdW5jdGlvbiAoY29udGV4dCkge1xuICB0aGlzLl9uZXh0Q29udGV4dCA9IGNvbnRleHRcbiAgdGhpcy5faGFzQ29udGV4dCA9IHRydWVcbiAgcmV0dXJuIHRoaXNcbn1cblxuLyoqXG4gKiBHZXQgdGhlIGNvbnRleHQgZm9yIGEgcHJvbWlzZVxuICogQHJldHVybiB7Kn0gdGhlIGNvbnRleHQgc2V0IGJ5IHNldENvbnRleHRcbiAqL1xuUHJvbWlzZS5wcm90b3R5cGUuZ2V0Q29udGV4dCA9IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIHRoaXMuX25leHRDb250ZXh0XG59XG5cbi8qKlxuICogUmVzb2x2ZSB0aGlzIHByb21pc2Ugd2l0aCBhIHNwZWNpZmllZCB2YWx1ZVxuICpcbiAqIEBwYXJhbSB7Kj19IGRhdGFcbiAqL1xuUHJvbWlzZS5wcm90b3R5cGUucmVzb2x2ZSA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gIGlmICh0aGlzLl9lcnJvciB8fCB0aGlzLl9oYXNEYXRhKSB0aHJvdyBuZXcgRXJyb3IoXCJVbmFibGUgdG8gcmVzb2x2ZSBvciByZWplY3QgdGhlIHNhbWUgcHJvbWlzZSB0d2ljZVwiKVxuXG4gIHZhciBpXG4gIGlmIChkYXRhICYmIGlzUHJvbWlzZShkYXRhKSkge1xuICAgIHRoaXMuX2NoaWxkID0gZGF0YVxuICAgIGlmICh0aGlzLl9wcm9taXNlcykge1xuICAgICAgZm9yIChpID0gMDsgaSA8IHRoaXMuX3Byb21pc2VzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGRhdGEuX2NoYWluUHJvbWlzZSh0aGlzLl9wcm9taXNlc1tpXSlcbiAgICAgIH1cbiAgICAgIGRlbGV0ZSB0aGlzLl9wcm9taXNlc1xuICAgIH1cblxuICAgIGlmICh0aGlzLl9vbkNvbXBsZXRlKSB7XG4gICAgICBmb3IgKGkgPSAwOyBpIDwgdGhpcy5fb25Db21wbGV0ZS5sZW5ndGg7IGkrPSAxKSB7XG4gICAgICAgIGRhdGEuZmluKHRoaXMuX29uQ29tcGxldGVbaV0pXG4gICAgICB9XG4gICAgICBkZWxldGUgdGhpcy5fb25Db21wbGV0ZVxuICAgIH1cbiAgfSBlbHNlIGlmIChkYXRhICYmIGlzUHJvbWlzZUxpa2UoZGF0YSkpIHtcbiAgICBkYXRhLnRoZW4oXG4gICAgICBmdW5jdGlvbihkYXRhKSB7IHRoaXMucmVzb2x2ZShkYXRhKSB9LmJpbmQodGhpcyksXG4gICAgICBmdW5jdGlvbihlcnIpIHsgdGhpcy5yZWplY3QoZXJyKSB9LmJpbmQodGhpcylcbiAgICApXG4gIH0gZWxzZSB7XG4gICAgdGhpcy5faGFzRGF0YSA9IHRydWVcbiAgICB0aGlzLl9kYXRhID0gZGF0YVxuXG4gICAgaWYgKHRoaXMuX29uQ29tcGxldGUpIHtcbiAgICAgIGZvciAoaSA9IDA7IGkgPCB0aGlzLl9vbkNvbXBsZXRlLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHRoaXMuX29uQ29tcGxldGVbaV0oKVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh0aGlzLl9wcm9taXNlcykge1xuICAgICAgZm9yIChpID0gMDsgaSA8IHRoaXMuX3Byb21pc2VzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIHRoaXMuX3Byb21pc2VzW2ldLl91c2VDb250ZXh0KHRoaXMuX25leHRDb250ZXh0KVxuICAgICAgICB0aGlzLl9wcm9taXNlc1tpXS5fd2l0aElucHV0KGRhdGEpXG4gICAgICB9XG4gICAgICBkZWxldGUgdGhpcy5fcHJvbWlzZXNcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBSZWplY3QgdGhpcyBwcm9taXNlIHdpdGggYW4gZXJyb3JcbiAqXG4gKiBAcGFyYW0geyFFcnJvcn0gZVxuICovXG5Qcm9taXNlLnByb3RvdHlwZS5yZWplY3QgPSBmdW5jdGlvbiAoZSkge1xuICBpZiAodGhpcy5fZXJyb3IgfHwgdGhpcy5faGFzRGF0YSkgdGhyb3cgbmV3IEVycm9yKFwiVW5hYmxlIHRvIHJlc29sdmUgb3IgcmVqZWN0IHRoZSBzYW1lIHByb21pc2UgdHdpY2VcIilcblxuICB2YXIgaVxuICB0aGlzLl9lcnJvciA9IGVcbiAgc3RhdHMuZXJyb3JzRW1pdHRlZCsrXG5cbiAgaWYgKHRoaXMuX2VuZGVkKSB7XG4gICAgdGhpcy5faGFuZGxlRXJyb3IoKVxuICAgIHByb2Nlc3MubmV4dFRpY2soZnVuY3Rpb24gb25Qcm9taXNlVGhyb3coKSB7XG4gICAgICB0aHJvdyBlXG4gICAgfSlcbiAgfVxuXG4gIGlmICh0aGlzLl9vbkNvbXBsZXRlKSB7XG4gICAgZm9yIChpID0gMDsgaSA8IHRoaXMuX29uQ29tcGxldGUubGVuZ3RoOyBpKyspIHtcbiAgICAgIHRoaXMuX29uQ29tcGxldGVbaV0oKVxuICAgIH1cbiAgfVxuXG4gIGlmICh0aGlzLl9wcm9taXNlcykge1xuICAgIHRoaXMuX2hhbmRsZUVycm9yKClcbiAgICBmb3IgKGkgPSAwOyBpIDwgdGhpcy5fcHJvbWlzZXMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgIHRoaXMuX3Byb21pc2VzW2ldLl91c2VDb250ZXh0KHRoaXMuX25leHRDb250ZXh0KVxuICAgICAgdGhpcy5fcHJvbWlzZXNbaV0uX3dpdGhFcnJvcihlKVxuICAgIH1cbiAgICBkZWxldGUgdGhpcy5fcHJvbWlzZXNcbiAgfVxufVxuXG4vKipcbiAqIFByb3ZpZGUgYSBjYWxsYmFjayB0byBiZSBjYWxsZWQgd2hlbmV2ZXIgdGhpcyBwcm9taXNlIHN1Y2Nlc3NmdWxseVxuICogcmVzb2x2ZXMuIEFsbG93cyBmb3IgYW4gb3B0aW9uYWwgc2Vjb25kIGNhbGxiYWNrIHRvIGhhbmRsZSB0aGUgZmFpbHVyZVxuICogY2FzZS5cbiAqXG4gKiBAcGFyYW0gez9mdW5jdGlvbih0aGlzOnZvaWQsIFQsID8pOiBSRVNVTFR8dW5kZWZpbmVkfSBvblN1Y2Nlc3NcbiAqIEBwYXJhbSB7P2Z1bmN0aW9uKHRoaXM6dm9pZCwgIUVycm9yLCA/KTogUkVTVUxUPX0gb25GYWlsXG4gKiBAcmV0dXJuIHshUHJvbWlzZS48UkVTVUxUPn0gcmV0dXJucyBhIG5ldyBwcm9taXNlIHdpdGggdGhlIG91dHB1dCBvZiB0aGUgb25TdWNjZXNzIG9yXG4gKiAgICAgb25GYWlsIGhhbmRsZXJcbiAqIEB0ZW1wbGF0ZSBSRVNVTFRcbiAqL1xuUHJvbWlzZS5wcm90b3R5cGUudGhlbiA9IGZ1bmN0aW9uIChvblN1Y2Nlc3MsIG9uRmFpbCkge1xuICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKG9uU3VjY2Vzcywgb25GYWlsKVxuICBpZiAodGhpcy5fbmV4dENvbnRleHQpIHByb21pc2UuX3VzZUNvbnRleHQodGhpcy5fbmV4dENvbnRleHQpXG5cbiAgaWYgKHRoaXMuX2NoaWxkKSB0aGlzLl9jaGlsZC5fY2hhaW5Qcm9taXNlKHByb21pc2UpXG4gIGVsc2UgdGhpcy5fY2hhaW5Qcm9taXNlKHByb21pc2UpXG5cbiAgcmV0dXJuIHByb21pc2Vcbn1cblxuLyoqXG4gKiBQcm92aWRlIGEgY2FsbGJhY2sgdG8gYmUgY2FsbGVkIHdoZW5ldmVyIHRoaXMgcHJvbWlzZSBzdWNjZXNzZnVsbHlcbiAqIHJlc29sdmVzLiBUaGUgY2FsbGJhY2sgd2lsbCBiZSBleGVjdXRlZCBpbiB0aGUgY29udGV4dCBvZiB0aGUgcHJvdmlkZWQgc2NvcGUuXG4gKlxuICogQHBhcmFtIHtmdW5jdGlvbih0aGlzOlNDT1BFLCAuLi4pOiBSRVNVTFR9IG9uU3VjY2Vzc1xuICogQHBhcmFtIHtTQ09QRX0gc2NvcGUgT2JqZWN0IHdob3NlIGNvbnRleHQgY2FsbGJhY2sgd2lsbCBiZSBleGVjdXRlZCBpbi5cbiAqIEBwYXJhbSB7Li4uKn0gdmFyX2FyZ3MgQWRkaXRpb25hbCBhcmd1bWVudHMgdG8gYmUgcGFzc2VkIHRvIHRoZSBwcm9taXNlIGNhbGxiYWNrLlxuICogQHJldHVybiB7IVByb21pc2UuPFJFU1VMVD59IHJldHVybnMgYSBuZXcgcHJvbWlzZSB3aXRoIHRoZSBvdXRwdXQgb2YgdGhlIG9uU3VjY2Vzc1xuICogQHRlbXBsYXRlIFNDT1BFLCBSRVNVTFRcbiAqL1xuUHJvbWlzZS5wcm90b3R5cGUudGhlbkJvdW5kID0gZnVuY3Rpb24gKG9uU3VjY2Vzcywgc2NvcGUsIHZhcl9hcmdzKSB7XG4gIHZhciBwcm9taXNlID0gbmV3IFByb21pc2Uob25TdWNjZXNzKVxuICBpZiAodGhpcy5fbmV4dENvbnRleHQpIHByb21pc2UuX3VzZUNvbnRleHQodGhpcy5fbmV4dENvbnRleHQpXG5cbiAgcHJvbWlzZS5fc2NvcGUgPSBzY29wZVxuICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDIpIHtcbiAgICBwcm9taXNlLl9ib3VuZEFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpXG4gIH1cblxuICAvLyBDaGFpbmluZyBtdXN0IGhhcHBlbiBhZnRlciBzZXR0aW5nIGFyZ3MgYW5kIHNjb3BlIHNpbmNlIGl0IG1heSBmaXJlIGNhbGxiYWNrLlxuICBpZiAodGhpcy5fY2hpbGQpIHRoaXMuX2NoaWxkLl9jaGFpblByb21pc2UocHJvbWlzZSlcbiAgZWxzZSB0aGlzLl9jaGFpblByb21pc2UocHJvbWlzZSlcblxuICByZXR1cm4gcHJvbWlzZVxufVxuXG4vKipcbiAqIFByb3ZpZGUgYSBjYWxsYmFjayB0byBiZSBjYWxsZWQgd2hlbmV2ZXIgdGhpcyBwcm9taXNlIGlzIHJlamVjdGVkXG4gKlxuICogQHBhcmFtIHtmdW5jdGlvbih0aGlzOnZvaWQsICFFcnJvciwgPyl9IG9uRmFpbFxuICogQHJldHVybiB7IVByb21pc2UuPFQ+fSByZXR1cm5zIGEgbmV3IHByb21pc2Ugd2l0aCB0aGUgb3V0cHV0IG9mIHRoZSBvbkZhaWwgaGFuZGxlclxuICovXG5Qcm9taXNlLnByb3RvdHlwZS5mYWlsID0gZnVuY3Rpb24gKG9uRmFpbCkge1xuICByZXR1cm4gdGhpcy50aGVuKG51bGwsIG9uRmFpbClcbn1cblxuLyoqXG4gKiBQcm92aWRlIGEgY2FsbGJhY2sgdG8gYmUgY2FsbGVkIHdoZW5ldmVyIHRoaXMgcHJvbWlzZSBpcyByZWplY3RlZC5cbiAqIFRoZSBjYWxsYmFjayB3aWxsIGJlIGV4ZWN1dGVkIGluIHRoZSBjb250ZXh0IG9mIHRoZSBwcm92aWRlZCBzY29wZS5cbiAqXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKHRoaXM6U0NPUEUsIC4uLil9IG9uRmFpbFxuICogQHBhcmFtIHtTQ09QRX0gc2NvcGUgT2JqZWN0IHdob3NlIGNvbnRleHQgY2FsbGJhY2sgd2lsbCBiZSBleGVjdXRlZCBpbi5cbiAqIEBwYXJhbSB7Li4uP30gdmFyX2FyZ3NcbiAqIEByZXR1cm4geyFQcm9taXNlLjxUPn0gcmV0dXJucyBhIG5ldyBwcm9taXNlIHdpdGggdGhlIG91dHB1dCBvZiB0aGUgb25TdWNjZXNzXG4gKiBAdGVtcGxhdGUgU0NPUEVcbiAqL1xuUHJvbWlzZS5wcm90b3R5cGUuZmFpbEJvdW5kID0gZnVuY3Rpb24gKG9uRmFpbCwgc2NvcGUsIHZhcl9hcmdzKSB7XG4gIHZhciBwcm9taXNlID0gbmV3IFByb21pc2UobnVsbCwgb25GYWlsKVxuICBpZiAodGhpcy5fbmV4dENvbnRleHQpIHByb21pc2UuX3VzZUNvbnRleHQodGhpcy5fbmV4dENvbnRleHQpXG5cbiAgcHJvbWlzZS5fc2NvcGUgPSBzY29wZVxuICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDIpIHtcbiAgICBwcm9taXNlLl9ib3VuZEFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpXG4gIH1cblxuICAvLyBDaGFpbmluZyBtdXN0IGhhcHBlbiBhZnRlciBzZXR0aW5nIGFyZ3MgYW5kIHNjb3BlIHNpbmNlIGl0IG1heSBmaXJlIGNhbGxiYWNrLlxuICBpZiAodGhpcy5fY2hpbGQpIHRoaXMuX2NoaWxkLl9jaGFpblByb21pc2UocHJvbWlzZSlcbiAgZWxzZSB0aGlzLl9jaGFpblByb21pc2UocHJvbWlzZSlcblxuICByZXR1cm4gcHJvbWlzZVxufVxuXG4vKipcbiAqIFNwcmVhZCBhIHByb21pc2VzIG91dHB1dHMgdG8gdGhlIGZ1bmN0aW9ucyBhcmd1bWVudHMuXG4gKiBAcGFyYW0gez9mdW5jdGlvbih0aGlzOnZvaWQsIC4uLik6IFJFU1VMVHx1bmRlZmluZWR9IG9uU3VjY2Vzc1xuICogQHJldHVybiB7IVByb21pc2UuPFJFU1VMVD59IHJldHVybnMgYSBuZXcgcHJvbWlzZSB3aXRoIHRoZSBvdXRwdXQgb2YgdGhlIG9uU3VjY2VzcyBvclxuICogICAgIG9uRmFpbCBoYW5kbGVyXG4gKiBAdGVtcGxhdGUgUkVTVUxUXG4gKi9cblByb21pc2UucHJvdG90eXBlLnNwcmVhZCA9IGZ1bmN0aW9uIChvblN1Y2Nlc3MpIHtcbiAgcmV0dXJuIHRoaXMudGhlbihhbGxJbnRlcm5hbClcbiAgLnRoZW4oZnVuY3Rpb24gKGFycmF5KSB7XG4gICAgcmV0dXJuIG9uU3VjY2Vzcy5hcHBseShudWxsLCBhcnJheSlcbiAgfSlcbn1cblxuLyoqXG4gKiBTcHJlYWQgYSBwcm9taXNlcyBvdXRwdXRzIHRvIHRoZSBmdW5jdGlvbnMgYXJndW1lbnRzLlxuICogQHBhcmFtIHtmdW5jdGlvbih0aGlzOlNDT1BFLCAuLi4pOiBSRVNVTFR9IG9uU3VjY2Vzc1xuICogQHBhcmFtIHtTQ09QRX0gc2NvcGUgT2JqZWN0IHdob3NlIGNvbnRleHQgY2FsbGJhY2sgd2lsbCBiZSBleGVjdXRlZCBpbi5cbiAqIEBwYXJhbSB7Li4uKn0gdmFyX2FyZ3MgQWRkaXRpb25hbCBhcmd1bWVudHMgdG8gYmUgcGFzc2VkIHRvIHRoZSBwcm9taXNlIGNhbGxiYWNrLlxuICogQHJldHVybiB7IVByb21pc2UuPFJFU1VMVD59IHJldHVybnMgYSBuZXcgcHJvbWlzZSB3aXRoIHRoZSBvdXRwdXQgb2YgdGhlIG9uU3VjY2Vzc1xuICogQHRlbXBsYXRlIFNDT1BFLCBSRVNVTFRcbiAqL1xuUHJvbWlzZS5wcm90b3R5cGUuc3ByZWFkQm91bmQgPSBmdW5jdGlvbiAob25TdWNjZXNzLCBzY29wZSwgdmFyX2FyZ3MpIHtcbiAgdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpXG4gIHJldHVybiB0aGlzLnRoZW4oYWxsSW50ZXJuYWwpXG4gIC50aGVuKGZ1bmN0aW9uIChhcnJheSkge1xuICAgIHJldHVybiBvblN1Y2Nlc3MuYXBwbHkoc2NvcGUsIGFyZ3MuY29uY2F0KGFycmF5KSlcbiAgfSlcbn1cblxuLyoqXG4gKiBQcm92aWRlIGEgY2FsbGJhY2sgdG8gYmUgY2FsbGVkIHdoZW5ldmVyIHRoaXMgcHJvbWlzZSBpcyBlaXRoZXIgcmVzb2x2ZWRcbiAqIG9yIHJlamVjdGVkLlxuICpcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oKX0gb25Db21wbGV0ZVxuICogQHJldHVybiB7IVByb21pc2UuPFQ+fSByZXR1cm5zIHRoZSBjdXJyZW50IHByb21pc2VcbiAqL1xuUHJvbWlzZS5wcm90b3R5cGUuZmluID0gZnVuY3Rpb24gKG9uQ29tcGxldGUpIHtcbiAgaWYgKHRoaXMuX2hhc0RhdGEgfHwgdGhpcy5fZXJyb3IpIHtcbiAgICBvbkNvbXBsZXRlKClcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgaWYgKHRoaXMuX2NoaWxkKSB7XG4gICAgdGhpcy5fY2hpbGQuZmluKG9uQ29tcGxldGUpXG4gIH0gZWxzZSB7XG4gICAgaWYgKCF0aGlzLl9vbkNvbXBsZXRlKSB0aGlzLl9vbkNvbXBsZXRlID0gW29uQ29tcGxldGVdXG4gICAgZWxzZSB0aGlzLl9vbkNvbXBsZXRlLnB1c2gob25Db21wbGV0ZSlcbiAgfVxuXG4gIHJldHVybiB0aGlzXG59XG5cbi8qKlxuICogTWFyayB0aGlzIHByb21pc2UgYXMgXCJlbmRlZFwiLiBJZiB0aGUgcHJvbWlzZSBpcyByZWplY3RlZCwgdGhpcyB3aWxsIHRocm93IGFuXG4gKiBlcnJvciBpbiB3aGF0ZXZlciBzY29wZSBpdCBoYXBwZW5zIHRvIGJlIGluXG4gKlxuICogQHJldHVybiB7IVByb21pc2UuPFQ+fSByZXR1cm5zIHRoZSBjdXJyZW50IHByb21pc2VcbiAqIEBkZXByZWNhdGVkIFByZWZlciBkb25lKCksIGJlY2F1c2UgaXQncyBjb25zaXN0ZW50IHdpdGggUS5cbiAqL1xuUHJvbWlzZS5wcm90b3R5cGUuZW5kID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLl9lbmQoKVxuICByZXR1cm4gdGhpc1xufVxuXG5cbi8qKlxuICogTWFyayB0aGlzIHByb21pc2UgYXMgXCJlbmRlZFwiLlxuICogQHByaXZhdGVcbiAqL1xuUHJvbWlzZS5wcm90b3R5cGUuX2VuZCA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKHRoaXMuX2Vycm9yKSB7XG4gICAgdGhpcy5faGFuZGxlRXJyb3IoKVxuICAgIHRocm93IHRoaXMuX2Vycm9yXG4gIH1cbiAgdGhpcy5fZW5kZWQgPSB0cnVlXG4gIHJldHVybiB0aGlzXG59XG5cbi8qKlxuICogQ2xvc2UgdGhlIHByb21pc2UuIEFueSBlcnJvcnMgYWZ0ZXIgdGhpcyBjb21wbGV0ZXMgd2lsbCBiZSB0aHJvd24gdG8gdGhlIGdsb2JhbCBoYW5kbGVyLlxuICpcbiAqIEBwYXJhbSB7P2Z1bmN0aW9uKHRoaXM6dm9pZCwgVCwgPyk9fSBvblN1Y2Nlc3MgYSBmdW5jdGlvbiB0byBoYW5kbGUgc3VjY2Vzc2Z1bFxuICogICAgIHJlc29sdXRpb24gb2YgdGhpcyBwcm9taXNlXG4gKiBAcGFyYW0gez9mdW5jdGlvbih0aGlzOnZvaWQsICFFcnJvciwgPyk9fSBvbkZhaWx1cmUgYSBmdW5jdGlvbiB0byBoYW5kbGUgZmFpbGVkXG4gKiAgICAgcmVzb2x1dGlvbiBvZiB0aGlzIHByb21pc2VcbiAqIEByZXR1cm4ge3ZvaWR9XG4gKi9cblByb21pc2UucHJvdG90eXBlLmRvbmUgPSBmdW5jdGlvbiAob25TdWNjZXNzLCBvbkZhaWx1cmUpIHtcbiAgdmFyIHNlbGYgPSB0aGlzXG4gIGlmIChvblN1Y2Nlc3MgfHwgb25GYWlsdXJlKSB7XG4gICAgc2VsZiA9IHNlbGYudGhlbihvblN1Y2Nlc3MsIG9uRmFpbHVyZSlcbiAgfVxuICBzZWxmLl9lbmQoKVxufVxuXG4vKipcbiAqIFJldHVybiBhIG5ldyBwcm9taXNlIHRoYXQgYmVoYXZlcyB0aGUgc2FtZSBhcyB0aGUgY3VycmVudCBwcm9taXNlIGV4Y2VwdFxuICogdGhhdCBpdCB3aWxsIGJlIHJlamVjdGVkIGlmIHRoZSBjdXJyZW50IHByb21pc2UgZG9lcyBub3QgZ2V0IGZ1bGZpbGxlZFxuICogYWZ0ZXIgYSBjZXJ0YWluIGFtb3VudCBvZiB0aW1lLlxuICpcbiAqIEBwYXJhbSB7bnVtYmVyfSB0aW1lb3V0TXMgVGhlIHRpbWVvdXQgdGhyZXNob2xkIGluIG1zZWNcbiAqIEBwYXJhbSB7c3RyaW5nPX0gdGltZW91dE1zZyBlcnJvciBtZXNzYWdlXG4gKiBAcmV0dXJuIHshUHJvbWlzZS48VD59IGEgbmV3IHByb21pc2Ugd2l0aCB0aW1lb3V0XG4gKi9cbiBQcm9taXNlLnByb3RvdHlwZS50aW1lb3V0ID0gZnVuY3Rpb24gKHRpbWVvdXRNcywgdGltZW91dE1zZykge1xuICB2YXIgZGVmZXJyZWQgPSBuZXcgUHJvbWlzZSgpXG4gIHZhciBpc1RpbWVvdXQgPSBmYWxzZVxuXG4gIHZhciB0aW1lb3V0ID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICBkZWZlcnJlZC5yZWplY3QobmV3IEVycm9yKHRpbWVvdXRNc2cgfHwgJ1Byb21pc2UgdGltZW91dCBhZnRlciAnICsgdGltZW91dE1zICsgJyBtcy4nKSlcbiAgICBpc1RpbWVvdXQgPSB0cnVlXG4gIH0sIHRpbWVvdXRNcylcblxuICB0aGlzLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICBpZiAoIWlzVGltZW91dCkge1xuICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpXG4gICAgICBkZWZlcnJlZC5yZXNvbHZlKGRhdGEpXG4gICAgfVxuICB9LFxuICBmdW5jdGlvbiAoZXJyKSB7XG4gICAgaWYgKCFpc1RpbWVvdXQpIHtcbiAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KVxuICAgICAgZGVmZXJyZWQucmVqZWN0KGVycilcbiAgICB9XG4gIH0pXG5cbiAgcmV0dXJuIGRlZmVycmVkLnByb21pc2Vcbn1cblxuLyoqXG4gKiBBdHRlbXB0IHRvIHJlc29sdmUgdGhpcyBwcm9taXNlIHdpdGggdGhlIHNwZWNpZmllZCBpbnB1dFxuICpcbiAqIEBwYXJhbSB7Kn0gZGF0YSB0aGUgaW5wdXRcbiAqL1xuUHJvbWlzZS5wcm90b3R5cGUuX3dpdGhJbnB1dCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gIGlmICh0aGlzLl9zdWNjZXNzRm4pIHtcbiAgICB0aGlzLl9uZXh0VGljayh0aGlzLl9zdWNjZXNzRm4sIFtkYXRhLCB0aGlzLl9jdXJyZW50Q29udGV4dF0pXG4gIH0gZWxzZSB7XG4gICAgdGhpcy5yZXNvbHZlKGRhdGEpXG4gIH1cblxuICAvLyBjb250ZXh0IGlzIG5vIGxvbmdlciBuZWVkZWRcbiAgZGVsZXRlIHRoaXMuX2N1cnJlbnRDb250ZXh0XG59XG5cbi8qKlxuICogQXR0ZW1wdCB0byByZWplY3QgdGhpcyBwcm9taXNlIHdpdGggdGhlIHNwZWNpZmllZCBlcnJvclxuICpcbiAqIEBwYXJhbSB7IUVycm9yfSBlXG4gKiBAcHJpdmF0ZVxuICovXG5Qcm9taXNlLnByb3RvdHlwZS5fd2l0aEVycm9yID0gZnVuY3Rpb24gKGUpIHtcbiAgaWYgKHRoaXMuX2ZhaWxGbikge1xuICAgIHRoaXMuX25leHRUaWNrKHRoaXMuX2ZhaWxGbiwgW2UsIHRoaXMuX2N1cnJlbnRDb250ZXh0XSlcbiAgfSBlbHNlIHtcbiAgICB0aGlzLnJlamVjdChlKVxuICB9XG5cbiAgLy8gY29udGV4dCBpcyBubyBsb25nZXIgbmVlZGVkXG4gIGRlbGV0ZSB0aGlzLl9jdXJyZW50Q29udGV4dFxufVxuXG4vKipcbiAqIENhbGxzIGEgZnVuY3Rpb24gaW4gdGhlIGNvcnJlY3Qgc2NvcGUsIGFuZCBpbmNsdWRlcyBib3VuZCBhcmd1bWVudHMuXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBmblxuICogQHBhcmFtIHtBcnJheX0gYXJnc1xuICogQHByaXZhdGVcbiAqL1xuUHJvbWlzZS5wcm90b3R5cGUuX25leHRUaWNrID0gZnVuY3Rpb24gKGZuLCBhcmdzKSB7XG4gIGlmICh0aGlzLl9ib3VuZEFyZ3MpIHtcbiAgICBhcmdzID0gdGhpcy5fYm91bmRBcmdzLmNvbmNhdChhcmdzKVxuICB9XG4gIG5leHRUaWNrKG5leHRUaWNrQ2FsbGJhY2suYmluZChudWxsLCB0aGlzLCBmbiwgdGhpcy5fc2NvcGUsIGFyZ3MpKVxufVxuXG4vKipcbiAqIENoYWluIGEgcHJvbWlzZSB0byB0aGUgY3VycmVudCBwcm9taXNlXG4gKlxuICogQHBhcmFtIHshUHJvbWlzZX0gcHJvbWlzZSB0aGUgcHJvbWlzZSB0byBjaGFpblxuICogQHByaXZhdGVcbiAqL1xuUHJvbWlzZS5wcm90b3R5cGUuX2NoYWluUHJvbWlzZSA9IGZ1bmN0aW9uIChwcm9taXNlKSB7XG4gIHZhciBpXG4gIGlmICh0aGlzLl9oYXNDb250ZXh0KSBwcm9taXNlLl91c2VDb250ZXh0KHRoaXMuX25leHRDb250ZXh0KVxuXG4gIGlmICh0aGlzLl9jaGlsZCkge1xuICAgIHRoaXMuX2NoaWxkLl9jaGFpblByb21pc2UocHJvbWlzZSlcbiAgfSBlbHNlIGlmICh0aGlzLl9oYXNEYXRhKSB7XG4gICAgcHJvbWlzZS5fd2l0aElucHV0KHRoaXMuX2RhdGEpXG4gIH0gZWxzZSBpZiAodGhpcy5fZXJyb3IpIHtcbiAgICAvLyBXZSBjYW4ndCByZWx5IG9uIF93aXRoRXJyb3IoKSBiZWNhdXNlIGl0J3MgY2FsbGVkIG9uIHRoZSBjaGFpbmVkIHByb21pc2VzXG4gICAgLy8gYW5kIHdlIG5lZWQgdG8gdXNlIHRoZSBzb3VyY2UncyBfZXJyb3JIYW5kbGVkIHN0YXRlXG4gICAgdGhpcy5faGFuZGxlRXJyb3IoKVxuICAgIHByb21pc2UuX3dpdGhFcnJvcih0aGlzLl9lcnJvcilcbiAgfSBlbHNlIGlmICghdGhpcy5fcHJvbWlzZXMpIHtcbiAgICB0aGlzLl9wcm9taXNlcyA9IFtwcm9taXNlXVxuICB9IGVsc2Uge1xuICAgIHRoaXMuX3Byb21pc2VzLnB1c2gocHJvbWlzZSlcbiAgfVxufVxuXG4vKipcbiAqIFV0aWxpdHkgZnVuY3Rpb24gdXNlZCBmb3IgY3JlYXRpbmcgYSBub2RlLXN0eWxlIHJlc29sdmVyXG4gKiBmb3IgZGVmZXJyZWRzXG4gKlxuICogQHBhcmFtIHshUHJvbWlzZX0gZGVmZXJyZWQgYSBwcm9taXNlIHRoYXQgbG9va3MgbGlrZSBhIGRlZmVycmVkXG4gKiBAcGFyYW0ge0Vycm9yPX0gZXJyIGFuIG9wdGlvbmFsIGVycm9yXG4gKiBAcGFyYW0geyo9fSBkYXRhIG9wdGlvbmFsIGRhdGFcbiAqL1xuZnVuY3Rpb24gcmVzb2x2ZXIoZGVmZXJyZWQsIGVyciwgZGF0YSkge1xuICBpZiAoZXJyKSBkZWZlcnJlZC5yZWplY3QoZXJyKVxuICBlbHNlIGRlZmVycmVkLnJlc29sdmUoZGF0YSlcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgbm9kZS1zdHlsZSByZXNvbHZlciBmb3IgYSBkZWZlcnJlZCBieSB3cmFwcGluZ1xuICogcmVzb2x2ZXIoKVxuICpcbiAqIEByZXR1cm4ge2Z1bmN0aW9uKD9FcnJvciwgKil9IG5vZGUtc3R5bGUgY2FsbGJhY2tcbiAqL1xuUHJvbWlzZS5wcm90b3R5cGUubWFrZU5vZGVSZXNvbHZlciA9IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIHJlc29sdmVyLmJpbmQobnVsbCwgdGhpcylcbn1cblxuLyoqXG4gKiBSZXR1cm4gdHJ1ZSBpZmYgdGhlIGdpdmVuIG9iamVjdCBpcyBhIHByb21pc2Ugb2YgdGhpcyBsaWJyYXJ5LlxuICpcbiAqIEJlY2F1c2Uga2V3J3MgQVBJIGlzIHNsaWdodGx5IGRpZmZlcmVudCB0aGFuIG90aGVyIHByb21pc2UgbGlicmFyaWVzLFxuICogaXQncyBpbXBvcnRhbnQgdGhhdCB3ZSBoYXZlIGEgdGVzdCBmb3IgaXRzIHByb21pc2UgdHlwZS4gSWYgeW91IHdhbnRcbiAqIHRvIHRlc3QgZm9yIGEgbW9yZSBnZW5lcmFsIEErIHByb21pc2UsIHlvdSBzaG91bGQgZG8gYSBjYXAgdGVzdCBmb3JcbiAqIHRoZSBmZWF0dXJlcyB5b3Ugd2FudC5cbiAqXG4gKiBAcGFyYW0geyp9IG9iaiBUaGUgb2JqZWN0IHRvIHRlc3RcbiAqIEByZXR1cm4ge2Jvb2xlYW59IFdoZXRoZXIgdGhlIG9iamVjdCBpcyBhIHByb21pc2VcbiAqL1xuZnVuY3Rpb24gaXNQcm9taXNlKG9iaikge1xuICByZXR1cm4gISFvYmouX2lzUHJvbWlzZVxufVxuXG4vKipcbiAqIFJldHVybiB0cnVlIGlmZiB0aGUgZ2l2ZW4gb2JqZWN0IGlzIGEgcHJvbWlzZS1saWtlIG9iamVjdCwgZS5nLiBhcHBlYXJzIHRvXG4gKiBpbXBsZW1lbnQgUHJvbWlzZXMvQSsgc3BlY2lmaWNhdGlvblxuICpcbiAqIEBwYXJhbSB7Kn0gb2JqIFRoZSBvYmplY3QgdG8gdGVzdFxuICogQHJldHVybiB7Ym9vbGVhbn0gV2hldGhlciB0aGUgb2JqZWN0IGlzIGEgcHJvbWlzZS1saWtlIG9iamVjdFxuICovXG5mdW5jdGlvbiBpc1Byb21pc2VMaWtlKG9iaikge1xuICByZXR1cm4gKHR5cGVvZiBvYmogPT09ICdvYmplY3QnIHx8IHR5cGVvZiBvYmogPT09ICdmdW5jdGlvbicpICYmXG4gICAgdHlwZW9mIG9iai50aGVuID09PSAnZnVuY3Rpb24nXG59XG5cbi8qKlxuICogU3RhdGljIGZ1bmN0aW9uIHdoaWNoIGNyZWF0ZXMgYW5kIHJlc29sdmVzIGEgcHJvbWlzZSBpbW1lZGlhdGVseVxuICpcbiAqIEBwYXJhbSB7VH0gZGF0YSBkYXRhIHRvIHJlc29sdmUgdGhlIHByb21pc2Ugd2l0aFxuICogQHJldHVybiB7IVByb21pc2UuPFQ+fVxuICogQHRlbXBsYXRlIFRcbiAqL1xuZnVuY3Rpb24gcmVzb2x2ZShkYXRhKSB7XG4gIHZhciBwcm9taXNlID0gbmV3IFByb21pc2UoKVxuICBwcm9taXNlLnJlc29sdmUoZGF0YSlcbiAgcmV0dXJuIHByb21pc2Vcbn1cblxuLyoqXG4gKiBTdGF0aWMgZnVuY3Rpb24gd2hpY2ggY3JlYXRlcyBhbmQgcmVqZWN0cyBhIHByb21pc2UgaW1tZWRpYXRlbHlcbiAqXG4gKiBAcGFyYW0geyFFcnJvcn0gZSBlcnJvciB0byByZWplY3QgdGhlIHByb21pc2Ugd2l0aFxuICogQHJldHVybiB7IVByb21pc2V9XG4gKi9cbmZ1bmN0aW9uIHJlamVjdChlKSB7XG4gIHZhciBwcm9taXNlID0gbmV3IFByb21pc2UoKVxuICBwcm9taXNlLnJlamVjdChlKVxuICByZXR1cm4gcHJvbWlzZVxufVxuXG4vKipcbiAqIFJlcGxhY2UgYW4gZWxlbWVudCBpbiBhbiBhcnJheSB3aXRoIGEgbmV3IHZhbHVlLiBVc2VkIGJ5IC5hbGwoKSB0b1xuICogY2FsbCBmcm9tIC50aGVuKClcbiAqXG4gKiBAcGFyYW0geyFBcnJheX0gYXJyXG4gKiBAcGFyYW0ge251bWJlcn0gaWR4XG4gKiBAcGFyYW0geyp9IHZhbFxuICogQHJldHVybiB7Kn0gdGhlIHZhbCB0aGF0J3MgYmVpbmcgaW5qZWN0ZWQgaW50byB0aGUgYXJyYXlcbiAqL1xuZnVuY3Rpb24gcmVwbGFjZUVsKGFyciwgaWR4LCB2YWwpIHtcbiAgYXJyW2lkeF0gPSB2YWxcbiAgcmV0dXJuIHZhbFxufVxuXG4vKipcbiAqIFJlcGxhY2UgYW4gZWxlbWVudCBpbiBhbiBhcnJheSBhcyBpdCBpcyByZXNvbHZlZCB3aXRoIGl0cyB2YWx1ZS5cbiAqIFVzZWQgYnkgLmFsbFNldHRsZWQoKS5cbiAqXG4gKiBAcGFyYW0geyFBcnJheX0gYXJyXG4gKiBAcGFyYW0ge251bWJlcn0gaWR4XG4gKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSBmcm9tIGEgcmVzb2x2ZWQgcHJvbWlzZS5cbiAqIEByZXR1cm4geyp9IHRoZSBkYXRhIHRoYXQncyBiZWluZyBwYXNzZWQgaW5cbiAqL1xuZnVuY3Rpb24gcmVwbGFjZUVsRnVsZmlsbGVkKGFyciwgaWR4LCB2YWx1ZSkge1xuICBhcnJbaWR4XSA9IHtcbiAgICBzdGF0ZTogJ2Z1bGZpbGxlZCcsXG4gICAgdmFsdWU6IHZhbHVlXG4gIH1cbiAgcmV0dXJuIHZhbHVlXG59XG5cbi8qKlxuICogUmVwbGFjZSBhbiBlbGVtZW50IGluIGFuIGFycmF5IGFzIGl0IGlzIHJlamVjdGVkIHdpdGggdGhlIHJlYXNvbi5cbiAqIFVzZWQgYnkgLmFsbFNldHRsZWQoKS5cbiAqXG4gKiBAcGFyYW0geyFBcnJheX0gYXJyXG4gKiBAcGFyYW0ge251bWJlcn0gaWR4XG4gKiBAcGFyYW0geyp9IHJlYXNvbiBUaGUgcmVhc29uIHdoeSB0aGUgb3JpZ2luYWwgcHJvbWlzZSBpcyByZWplY3RlZFxuICogQHJldHVybiB7Kn0gdGhlIGRhdGEgdGhhdCdzIGJlaW5nIHBhc3NlZCBpblxuICovXG5mdW5jdGlvbiByZXBsYWNlRWxSZWplY3RlZChhcnIsIGlkeCwgcmVhc29uKSB7XG4gIGFycltpZHhdID0ge1xuICAgIHN0YXRlOiAncmVqZWN0ZWQnLFxuICAgIHJlYXNvbjogcmVhc29uXG4gIH1cbiAgcmV0dXJuIHJlYXNvblxufVxuXG4vKipcbiAqIFRha2VzIGluIGFuIGFycmF5IG9mIHByb21pc2VzIG9yIGxpdGVyYWxzIGFuZCByZXR1cm5zIGEgcHJvbWlzZSB3aGljaCByZXR1cm5zXG4gKiBhbiBhcnJheSBvZiB2YWx1ZXMgd2hlbiBhbGwgaGF2ZSByZXNvbHZlZC4gSWYgYW55IGZhaWwsIHRoZSBwcm9taXNlIGZhaWxzLlxuICpcbiAqIEBwYXJhbSB7IUFycmF5LjwhUHJvbWlzZT59IHByb21pc2VzXG4gKiBAcmV0dXJuIHshUHJvbWlzZS48IUFycmF5Pn1cbiAqL1xuZnVuY3Rpb24gYWxsKHByb21pc2VzKSB7XG4gIGlmIChhcmd1bWVudHMubGVuZ3RoICE9IDEgfHwgIUFycmF5LmlzQXJyYXkocHJvbWlzZXMpKSB7XG4gICAgcHJvbWlzZXMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDApXG4gIH1cbiAgcmV0dXJuIGFsbEludGVybmFsKHByb21pc2VzKVxufVxuXG4vKipcbiAqIEEgdmVyc2lvbiBvZiBhbGwoKSB0aGF0IGRvZXMgbm90IGFjY2VwdCB2YXJfYXJnc1xuICpcbiAqIEBwYXJhbSB7IUFycmF5LjwhUHJvbWlzZT59IHByb21pc2VzXG4gKiBAcmV0dXJuIHshUHJvbWlzZS48IUFycmF5Pn1cbiAqL1xuZnVuY3Rpb24gYWxsSW50ZXJuYWwocHJvbWlzZXMpIHtcbiAgaWYgKCFwcm9taXNlcy5sZW5ndGgpIHJldHVybiByZXNvbHZlKFtdKVxuXG4gIHZhciBvdXRwdXRzID0gW11cbiAgdmFyIGZpbmlzaGVkID0gZmFsc2VcbiAgdmFyIHByb21pc2UgPSBuZXcgUHJvbWlzZSgpXG4gIHZhciBjb3VudGVyID0gcHJvbWlzZXMubGVuZ3RoXG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9taXNlcy5sZW5ndGg7IGkgKz0gMSkge1xuICAgIGlmICghcHJvbWlzZXNbaV0gfHwgIWlzUHJvbWlzZUxpa2UocHJvbWlzZXNbaV0pKSB7XG4gICAgICBvdXRwdXRzW2ldID0gcHJvbWlzZXNbaV1cbiAgICAgIGNvdW50ZXIgLT0gMVxuICAgIH0gZWxzZSB7XG4gICAgICBwcm9taXNlc1tpXS50aGVuKHJlcGxhY2VFbC5iaW5kKG51bGwsIG91dHB1dHMsIGkpKVxuICAgICAgLnRoZW4oZnVuY3Rpb24gZGVjcmVtZW50QWxsQ291bnRlcigpIHtcbiAgICAgICAgY291bnRlci0tXG4gICAgICAgIGlmICghZmluaXNoZWQgJiYgY291bnRlciA9PT0gMCkge1xuICAgICAgICAgIGZpbmlzaGVkID0gdHJ1ZVxuICAgICAgICAgIHByb21pc2UucmVzb2x2ZShvdXRwdXRzKVxuICAgICAgICB9XG4gICAgICB9LCBmdW5jdGlvbiBvbkFsbEVycm9yKGUpIHtcbiAgICAgICAgaWYgKCFmaW5pc2hlZCkge1xuICAgICAgICAgIGZpbmlzaGVkID0gdHJ1ZVxuICAgICAgICAgIHByb21pc2UucmVqZWN0KGUpXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfVxuICB9XG5cbiAgaWYgKGNvdW50ZXIgPT09IDAgJiYgIWZpbmlzaGVkKSB7XG4gICAgZmluaXNoZWQgPSB0cnVlXG4gICAgcHJvbWlzZS5yZXNvbHZlKG91dHB1dHMpXG4gIH1cblxuICByZXR1cm4gcHJvbWlzZVxufVxuXG4vKipcbiAqIFRha2VzIGluIGFuIGFycmF5IG9mIHByb21pc2VzIG9yIHZhbHVlcyBhbmQgcmV0dXJucyBhIHByb21pc2UgdGhhdCBpc1xuICogZnVsZmlsbGVkIHdpdGggYW4gYXJyYXkgb2Ygc3RhdGUgb2JqZWN0cyB3aGVuIGFsbCBoYXZlIHJlc29sdmVkIG9yXG4gKiByZWplY3RlZC4gSWYgYSBwcm9taXNlIGlzIHJlc29sdmVkLCBpdHMgY29ycmVzcG9uZGluZyBzdGF0ZSBvYmplY3QgaXNcbiAqIHtzdGF0ZTogJ2Z1bGZpbGxlZCcsIHZhbHVlOiBPYmplY3R9OyB3aGVyZWFzIGlmIGEgcHJvbWlzZSBpcyByZWplY3RlZCwgaXRzXG4gKiBjb3JyZXNwb25kaW5nIHN0YXRlIG9iamVjdCBpcyB7c3RhdGU6ICdyZWplY3RlZCcsIHJlYXNvbjogT2JqZWN0fS5cbiAqXG4gKiBAcGFyYW0geyFBcnJheX0gcHJvbWlzZXMgb3IgdmFsdWVzXG4gKiBAcmV0dXJuIHshUHJvbWlzZS48IUFycmF5Pn0gUHJvbWlzZSBmdWxmaWxsZWQgd2l0aCBzdGF0ZSBvYmplY3RzIGZvciBlYWNoIGlucHV0XG4gKi9cbmZ1bmN0aW9uIGFsbFNldHRsZWQocHJvbWlzZXMpIHtcbiAgaWYgKCFBcnJheS5pc0FycmF5KHByb21pc2VzKSkge1xuICAgIHRocm93IEVycm9yKCdUaGUgaW5wdXQgdG8gXCJhbGxTZXR0bGVkKClcIiBzaG91bGQgYmUgYW4gYXJyYXkgb2YgUHJvbWlzZSBvciB2YWx1ZXMnKVxuICB9XG4gIGlmICghcHJvbWlzZXMubGVuZ3RoKSByZXR1cm4gcmVzb2x2ZShbXSlcblxuICB2YXIgb3V0cHV0cyA9IFtdXG4gIHZhciBwcm9taXNlID0gbmV3IFByb21pc2UoKVxuICB2YXIgY291bnRlciA9IHByb21pc2VzLmxlbmd0aFxuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvbWlzZXMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICBpZiAoIXByb21pc2VzW2ldIHx8ICFpc1Byb21pc2VMaWtlKHByb21pc2VzW2ldKSkge1xuICAgICAgcmVwbGFjZUVsRnVsZmlsbGVkKG91dHB1dHMsIGksIHByb21pc2VzW2ldKVxuICAgICAgaWYgKCgtLWNvdW50ZXIpID09PSAwKSBwcm9taXNlLnJlc29sdmUob3V0cHV0cylcbiAgICB9IGVsc2Uge1xuICAgICAgcHJvbWlzZXNbaV1cbiAgICAgICAgLnRoZW4ocmVwbGFjZUVsRnVsZmlsbGVkLmJpbmQobnVsbCwgb3V0cHV0cywgaSksIHJlcGxhY2VFbFJlamVjdGVkLmJpbmQobnVsbCwgb3V0cHV0cywgaSkpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBpZiAoKC0tY291bnRlcikgPT09IDApIHByb21pc2UucmVzb2x2ZShvdXRwdXRzKVxuICAgICAgICB9KVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBwcm9taXNlXG59XG5cbi8qKlxuICogVGFrZXMgYW4gYXJyYXkgb2YgcmVzdWx0cyBhbmQgc3ByZWFkcyB0aGVtIHRvIHRoZSBhcmd1bWVudHMgb2YgYSBmdW5jdGlvbi5cbiAqIEBwYXJhbSB7IUFycmF5fSBhcnJheVxuICogQHBhcmFtIHshRnVuY3Rpb259IGZuXG4gKi9cbmZ1bmN0aW9uIHNwcmVhZChhcnJheSwgZm4pIHtcbiAgcmVzb2x2ZShhcnJheSkuc3ByZWFkKGZuKVxufVxuXG4vKipcbiAqIENyZWF0ZSBhIG5ldyBQcm9taXNlIHdoaWNoIGxvb2tzIGxpa2UgYSBkZWZlcnJlZFxuICpcbiAqIEByZXR1cm4geyFQcm9taXNlfVxuICovXG5mdW5jdGlvbiBkZWZlcigpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKClcbn1cblxuLyoqXG4gKiBSZXR1cm4gYSBwcm9taXNlIHdoaWNoIHdpbGwgd2FpdCBhIHNwZWNpZmllZCBudW1iZXIgb2YgbXMgdG8gcmVzb2x2ZVxuICpcbiAqIEBwYXJhbSB7Kn0gZGVsYXlNc09yVmFsIEEgZGVsYXkgKGluIG1zKSBpZiB0aGlzIHRha2VzIG9uZSBhcmd1bWVudCwgb3IgdGhlclxuICogICAgIHJldHVybiB2YWx1ZSBpZiBpdCB0YWtlcyB0d28uXG4gKiBAcGFyYW0ge251bWJlcj19IG9wdF9kZWxheU1zXG4gKiBAcmV0dXJuIHshUHJvbWlzZX1cbiAqL1xuZnVuY3Rpb24gZGVsYXkoZGVsYXlNc09yVmFsLCBvcHRfZGVsYXlNcykge1xuICB2YXIgcmV0dXJuVmFsID0gdW5kZWZpbmVkXG4gIHZhciBkZWxheU1zID0gZGVsYXlNc09yVmFsXG4gIGlmICh0eXBlb2Ygb3B0X2RlbGF5TXMgIT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBkZWxheU1zID0gb3B0X2RlbGF5TXNcbiAgICByZXR1cm5WYWwgPSBkZWxheU1zT3JWYWxcbiAgfVxuXG4gIGlmICh0eXBlb2YgZGVsYXlNcyAhPSAnbnVtYmVyJykge1xuICAgIHRocm93IG5ldyBFcnJvcignQmFkIGRlbGF5IHZhbHVlICcgKyBkZWxheU1zKVxuICB9XG5cbiAgdmFyIGRlZmVyID0gbmV3IFByb21pc2UoKVxuICBzZXRUaW1lb3V0KGZ1bmN0aW9uIG9uRGVsYXkoKSB7XG4gICAgZGVmZXIucmVzb2x2ZShyZXR1cm5WYWwpXG4gIH0sIGRlbGF5TXMpXG4gIHJldHVybiBkZWZlclxufVxuXG4vKipcbiAqIFJldHVybnMgYSBwcm9taXNlIHRoYXQgaGFzIHRoZSBzYW1lIHJlc3VsdCBhcyBgdGhpc2AsIGJ1dCBmdWxmaWxsZWRcbiAqIGFmdGVyIGF0IGxlYXN0IG1zIG1pbGxpc2Vjb25kc1xuICogQHBhcmFtIHtudW1iZXJ9IG1zXG4gKi9cblByb21pc2UucHJvdG90eXBlLmRlbGF5ID0gZnVuY3Rpb24gKG1zKSB7XG4gIHJldHVybiB0aGlzLnRoZW4oZnVuY3Rpb24gKHZhbCkge1xuICAgIHJldHVybiBkZWxheSh2YWwsIG1zKVxuICB9KVxufVxuXG4vKipcbiAqIFJldHVybiBhIHByb21pc2Ugd2hpY2ggd2lsbCBldmFsdWF0ZSB0aGUgZnVuY3Rpb24gZm4gaW4gYSBmdXR1cmUgdHVybiB3aXRoXG4gKiB0aGUgcHJvdmlkZWQgYXJnc1xuICpcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oLi4uKX0gZm5cbiAqIEBwYXJhbSB7Li4uKn0gdmFyX2FyZ3MgYSB2YXJpYWJsZSBudW1iZXIgb2YgYXJndW1lbnRzXG4gKiBAcmV0dXJuIHshUHJvbWlzZX1cbiAqL1xuZnVuY3Rpb24gZmNhbGwoZm4sIHZhcl9hcmdzKSB7XG4gIHZhciByb290QXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSlcbiAgdmFyIGRlZmVyID0gbmV3IFByb21pc2UoKVxuICBuZXh0VGljayhuZXh0VGlja0NhbGxiYWNrLmJpbmQobnVsbCwgZGVmZXIsIGZuLCB1bmRlZmluZWQsIHJvb3RBcmdzKSlcbiAgcmV0dXJuIGRlZmVyXG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIGEgcHJvbWlzZSB0aGF0IHdpbGwgYmUgaW52b2tlZCB3aXRoIHRoZSByZXN1bHQgb2YgYSBub2RlIHN0eWxlXG4gKiBjYWxsYmFjay4gQWxsIGFyZ3MgdG8gZm4gc2hvdWxkIGJlIGdpdmVuIGV4Y2VwdCBmb3IgdGhlIGZpbmFsIGNhbGxiYWNrIGFyZ1xuICpcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oLi4uKX0gZm5cbiAqIEBwYXJhbSB7Li4uKn0gdmFyX2FyZ3MgYSB2YXJpYWJsZSBudW1iZXIgb2YgYXJndW1lbnRzXG4gKiBAcmV0dXJuIHshUHJvbWlzZX1cbiAqL1xuZnVuY3Rpb24gbmZjYWxsKGZuLCB2YXJfYXJncykge1xuICAvLyBJbnNlcnQgYW4gdW5kZWZpbmVkIGFyZ3VtZW50IGZvciBzY29wZSBhbmQgbGV0IGJpbmRQcm9taXNlKCkgZG8gdGhlIHdvcmsuXG4gIHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAwKVxuICBhcmdzLnNwbGljZSgxLCAwLCB1bmRlZmluZWQpXG4gIHJldHVybiBuY2FsbC5hcHBseSh1bmRlZmluZWQsIGFyZ3MpXG59XG5cblxuLyoqXG4gKiBMaWtlIGBuZmNhbGxgLCBidXQgcGVybWl0cyBwYXNzaW5nIGEgYHRoaXNgIGNvbnRleHQgZm9yIHRoZSBjYWxsLlxuICpcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oLi4uKX0gZm5cbiAqIEBwYXJhbSB7T2JqZWN0fSBzY29wZVxuICogQHBhcmFtIHsuLi4qfSB2YXJfYXJnc1xuICogQHJldHVybiB7IVByb21pc2V9XG4gKi9cbmZ1bmN0aW9uIG5jYWxsKGZuLCBzY29wZSwgdmFyX2FyZ3MpIHtcbiAgcmV0dXJuIGJpbmRQcm9taXNlLmFwcGx5KG51bGwsIGFyZ3VtZW50cykoKVxufVxuXG5cbi8qKlxuICogQmluZHMgYSBmdW5jdGlvbiB0byBhIHNjb3BlIHdpdGggYW4gb3B0aW9uYWwgbnVtYmVyIG9mIGN1cnJpZWQgYXJndW1lbnRzLiBBdHRhY2hlc1xuICogYSBub2RlIHN0eWxlIGNhbGxiYWNrIGFzIHRoZSBsYXN0IGFyZ3VtZW50IGFuZCByZXR1cm5zIGEgcHJvbWlzZVxuICpcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oLi4uKX0gZm5cbiAqIEBwYXJhbSB7T2JqZWN0fSBzY29wZVxuICogQHBhcmFtIHsuLi4qfSB2YXJfYXJncyBhIHZhcmlhYmxlIG51bWJlciBvZiBhcmd1bWVudHNcbiAqIEByZXR1cm4ge2Z1bmN0aW9uKC4uLil9OiAhUHJvbWlzZX1cbiAqL1xuZnVuY3Rpb24gYmluZFByb21pc2UoZm4sIHNjb3BlLCB2YXJfYXJncykge1xuICB2YXIgcm9vdEFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpXG4gIHJldHVybiBmdW5jdGlvbiBvbkJvdW5kUHJvbWlzZSh2YXJfYXJncykge1xuICAgIHZhciBkZWZlciA9IG5ldyBQcm9taXNlKClcbiAgICB0cnkge1xuICAgICAgZm4uYXBwbHkoc2NvcGUsIHJvb3RBcmdzLmNvbmNhdChBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDApLCBkZWZlci5tYWtlTm9kZVJlc29sdmVyKCkpKVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGRlZmVyLnJlamVjdChlKVxuICAgIH1cbiAgICByZXR1cm4gZGVmZXJcbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgYWxsOiBhbGwsXG4gIGJpbmRQcm9taXNlOiBiaW5kUHJvbWlzZSxcbiAgZGVmZXI6IGRlZmVyLFxuICBkZWxheTogZGVsYXksXG4gIGZjYWxsOiBmY2FsbCxcbiAgaXNQcm9taXNlOiBpc1Byb21pc2UsXG4gIGlzUHJvbWlzZUxpa2U6IGlzUHJvbWlzZUxpa2UsXG4gIG5jYWxsOiBuY2FsbCxcbiAgbmZjYWxsOiBuZmNhbGwsXG4gIHJlc29sdmU6IHJlc29sdmUsXG4gIHJlamVjdDogcmVqZWN0LFxuICBzcHJlYWQ6IHNwcmVhZCxcbiAgc3RhdHM6IHN0YXRzLFxuICBhbGxTZXR0bGVkOiBhbGxTZXR0bGVkLFxuICBQcm9taXNlOiBQcm9taXNlLFxuICBnZXROZXh0VGlja0Z1bmN0aW9uOiBnZXROZXh0VGlja0Z1bmN0aW9uLFxuICBzZXROZXh0VGlja0Z1bmN0aW9uOiBzZXROZXh0VGlja0Z1bmN0aW9uLFxufVxuIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcnJheSkge1xuXG5cdHJldHVybiBhcnJheVtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqYXJyYXkubGVuZ3RoKV07XG59OyIsIi8qanNsaW50IG9uZXZhcjp0cnVlLCB1bmRlZjp0cnVlLCBuZXdjYXA6dHJ1ZSwgcmVnZXhwOnRydWUsIGJpdHdpc2U6dHJ1ZSwgbWF4ZXJyOjUwLCBpbmRlbnQ6NCwgd2hpdGU6ZmFsc2UsIG5vbWVuOmZhbHNlLCBwbHVzcGx1czpmYWxzZSAqL1xuLypnbG9iYWwgZGVmaW5lOmZhbHNlLCByZXF1aXJlOmZhbHNlLCBleHBvcnRzOmZhbHNlLCBtb2R1bGU6ZmFsc2UsIHNpZ25hbHM6ZmFsc2UgKi9cblxuLyoqIEBsaWNlbnNlXG4gKiBKUyBTaWduYWxzIDxodHRwOi8vbWlsbGVybWVkZWlyb3MuZ2l0aHViLmNvbS9qcy1zaWduYWxzLz5cbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZVxuICogQXV0aG9yOiBNaWxsZXIgTWVkZWlyb3NcbiAqIFZlcnNpb246IDEuMC4wIC0gQnVpbGQ6IDI2OCAoMjAxMi8xMS8yOSAwNTo0OCBQTSlcbiAqL1xuXG4oZnVuY3Rpb24oZ2xvYmFsKXtcblxuICAgIC8vIFNpZ25hbEJpbmRpbmcgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gICAgLyoqXG4gICAgICogT2JqZWN0IHRoYXQgcmVwcmVzZW50cyBhIGJpbmRpbmcgYmV0d2VlbiBhIFNpZ25hbCBhbmQgYSBsaXN0ZW5lciBmdW5jdGlvbi5cbiAgICAgKiA8YnIgLz4tIDxzdHJvbmc+VGhpcyBpcyBhbiBpbnRlcm5hbCBjb25zdHJ1Y3RvciBhbmQgc2hvdWxkbid0IGJlIGNhbGxlZCBieSByZWd1bGFyIHVzZXJzLjwvc3Ryb25nPlxuICAgICAqIDxiciAvPi0gaW5zcGlyZWQgYnkgSm9hIEViZXJ0IEFTMyBTaWduYWxCaW5kaW5nIGFuZCBSb2JlcnQgUGVubmVyJ3MgU2xvdCBjbGFzc2VzLlxuICAgICAqIEBhdXRob3IgTWlsbGVyIE1lZGVpcm9zXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQGludGVybmFsXG4gICAgICogQG5hbWUgU2lnbmFsQmluZGluZ1xuICAgICAqIEBwYXJhbSB7U2lnbmFsfSBzaWduYWwgUmVmZXJlbmNlIHRvIFNpZ25hbCBvYmplY3QgdGhhdCBsaXN0ZW5lciBpcyBjdXJyZW50bHkgYm91bmQgdG8uXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gbGlzdGVuZXIgSGFuZGxlciBmdW5jdGlvbiBib3VuZCB0byB0aGUgc2lnbmFsLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNPbmNlIElmIGJpbmRpbmcgc2hvdWxkIGJlIGV4ZWN1dGVkIGp1c3Qgb25jZS5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2xpc3RlbmVyQ29udGV4dF0gQ29udGV4dCBvbiB3aGljaCBsaXN0ZW5lciB3aWxsIGJlIGV4ZWN1dGVkIChvYmplY3QgdGhhdCBzaG91bGQgcmVwcmVzZW50IHRoZSBgdGhpc2AgdmFyaWFibGUgaW5zaWRlIGxpc3RlbmVyIGZ1bmN0aW9uKS5cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW3ByaW9yaXR5XSBUaGUgcHJpb3JpdHkgbGV2ZWwgb2YgdGhlIGV2ZW50IGxpc3RlbmVyLiAoZGVmYXVsdCA9IDApLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIFNpZ25hbEJpbmRpbmcoc2lnbmFsLCBsaXN0ZW5lciwgaXNPbmNlLCBsaXN0ZW5lckNvbnRleHQsIHByaW9yaXR5KSB7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEhhbmRsZXIgZnVuY3Rpb24gYm91bmQgdG8gdGhlIHNpZ25hbC5cbiAgICAgICAgICogQHR5cGUgRnVuY3Rpb25cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2xpc3RlbmVyID0gbGlzdGVuZXI7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIElmIGJpbmRpbmcgc2hvdWxkIGJlIGV4ZWN1dGVkIGp1c3Qgb25jZS5cbiAgICAgICAgICogQHR5cGUgYm9vbGVhblxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5faXNPbmNlID0gaXNPbmNlO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDb250ZXh0IG9uIHdoaWNoIGxpc3RlbmVyIHdpbGwgYmUgZXhlY3V0ZWQgKG9iamVjdCB0aGF0IHNob3VsZCByZXByZXNlbnQgdGhlIGB0aGlzYCB2YXJpYWJsZSBpbnNpZGUgbGlzdGVuZXIgZnVuY3Rpb24pLlxuICAgICAgICAgKiBAbWVtYmVyT2YgU2lnbmFsQmluZGluZy5wcm90b3R5cGVcbiAgICAgICAgICogQG5hbWUgY29udGV4dFxuICAgICAgICAgKiBAdHlwZSBPYmplY3R8dW5kZWZpbmVkfG51bGxcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuY29udGV4dCA9IGxpc3RlbmVyQ29udGV4dDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogUmVmZXJlbmNlIHRvIFNpZ25hbCBvYmplY3QgdGhhdCBsaXN0ZW5lciBpcyBjdXJyZW50bHkgYm91bmQgdG8uXG4gICAgICAgICAqIEB0eXBlIFNpZ25hbFxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fc2lnbmFsID0gc2lnbmFsO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBMaXN0ZW5lciBwcmlvcml0eVxuICAgICAgICAgKiBAdHlwZSBOdW1iZXJcbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX3ByaW9yaXR5ID0gcHJpb3JpdHkgfHwgMDtcbiAgICB9XG5cbiAgICBTaWduYWxCaW5kaW5nLnByb3RvdHlwZSA9IHtcblxuICAgICAgICAvKipcbiAgICAgICAgICogSWYgYmluZGluZyBpcyBhY3RpdmUgYW5kIHNob3VsZCBiZSBleGVjdXRlZC5cbiAgICAgICAgICogQHR5cGUgYm9vbGVhblxuICAgICAgICAgKi9cbiAgICAgICAgYWN0aXZlIDogdHJ1ZSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogRGVmYXVsdCBwYXJhbWV0ZXJzIHBhc3NlZCB0byBsaXN0ZW5lciBkdXJpbmcgYFNpZ25hbC5kaXNwYXRjaGAgYW5kIGBTaWduYWxCaW5kaW5nLmV4ZWN1dGVgLiAoY3VycmllZCBwYXJhbWV0ZXJzKVxuICAgICAgICAgKiBAdHlwZSBBcnJheXxudWxsXG4gICAgICAgICAqL1xuICAgICAgICBwYXJhbXMgOiBudWxsLFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDYWxsIGxpc3RlbmVyIHBhc3NpbmcgYXJiaXRyYXJ5IHBhcmFtZXRlcnMuXG4gICAgICAgICAqIDxwPklmIGJpbmRpbmcgd2FzIGFkZGVkIHVzaW5nIGBTaWduYWwuYWRkT25jZSgpYCBpdCB3aWxsIGJlIGF1dG9tYXRpY2FsbHkgcmVtb3ZlZCBmcm9tIHNpZ25hbCBkaXNwYXRjaCBxdWV1ZSwgdGhpcyBtZXRob2QgaXMgdXNlZCBpbnRlcm5hbGx5IGZvciB0aGUgc2lnbmFsIGRpc3BhdGNoLjwvcD5cbiAgICAgICAgICogQHBhcmFtIHtBcnJheX0gW3BhcmFtc0Fycl0gQXJyYXkgb2YgcGFyYW1ldGVycyB0aGF0IHNob3VsZCBiZSBwYXNzZWQgdG8gdGhlIGxpc3RlbmVyXG4gICAgICAgICAqIEByZXR1cm4geyp9IFZhbHVlIHJldHVybmVkIGJ5IHRoZSBsaXN0ZW5lci5cbiAgICAgICAgICovXG4gICAgICAgIGV4ZWN1dGUgOiBmdW5jdGlvbiAocGFyYW1zQXJyKSB7XG4gICAgICAgICAgICB2YXIgaGFuZGxlclJldHVybiwgcGFyYW1zO1xuICAgICAgICAgICAgaWYgKHRoaXMuYWN0aXZlICYmICEhdGhpcy5fbGlzdGVuZXIpIHtcbiAgICAgICAgICAgICAgICBwYXJhbXMgPSB0aGlzLnBhcmFtcz8gdGhpcy5wYXJhbXMuY29uY2F0KHBhcmFtc0FycikgOiBwYXJhbXNBcnI7XG4gICAgICAgICAgICAgICAgaGFuZGxlclJldHVybiA9IHRoaXMuX2xpc3RlbmVyLmFwcGx5KHRoaXMuY29udGV4dCwgcGFyYW1zKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5faXNPbmNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGV0YWNoKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGhhbmRsZXJSZXR1cm47XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIERldGFjaCBiaW5kaW5nIGZyb20gc2lnbmFsLlxuICAgICAgICAgKiAtIGFsaWFzIHRvOiBteVNpZ25hbC5yZW1vdmUobXlCaW5kaW5nLmdldExpc3RlbmVyKCkpO1xuICAgICAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbnxudWxsfSBIYW5kbGVyIGZ1bmN0aW9uIGJvdW5kIHRvIHRoZSBzaWduYWwgb3IgYG51bGxgIGlmIGJpbmRpbmcgd2FzIHByZXZpb3VzbHkgZGV0YWNoZWQuXG4gICAgICAgICAqL1xuICAgICAgICBkZXRhY2ggOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5pc0JvdW5kKCk/IHRoaXMuX3NpZ25hbC5yZW1vdmUodGhpcy5fbGlzdGVuZXIsIHRoaXMuY29udGV4dCkgOiBudWxsO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAcmV0dXJuIHtCb29sZWFufSBgdHJ1ZWAgaWYgYmluZGluZyBpcyBzdGlsbCBib3VuZCB0byB0aGUgc2lnbmFsIGFuZCBoYXZlIGEgbGlzdGVuZXIuXG4gICAgICAgICAqL1xuICAgICAgICBpc0JvdW5kIDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuICghIXRoaXMuX3NpZ25hbCAmJiAhIXRoaXMuX2xpc3RlbmVyKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogQHJldHVybiB7Ym9vbGVhbn0gSWYgU2lnbmFsQmluZGluZyB3aWxsIG9ubHkgYmUgZXhlY3V0ZWQgb25jZS5cbiAgICAgICAgICovXG4gICAgICAgIGlzT25jZSA6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pc09uY2U7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufSBIYW5kbGVyIGZ1bmN0aW9uIGJvdW5kIHRvIHRoZSBzaWduYWwuXG4gICAgICAgICAqL1xuICAgICAgICBnZXRMaXN0ZW5lciA6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9saXN0ZW5lcjtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogQHJldHVybiB7U2lnbmFsfSBTaWduYWwgdGhhdCBsaXN0ZW5lciBpcyBjdXJyZW50bHkgYm91bmQgdG8uXG4gICAgICAgICAqL1xuICAgICAgICBnZXRTaWduYWwgOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc2lnbmFsO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBEZWxldGUgaW5zdGFuY2UgcHJvcGVydGllc1xuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgX2Rlc3Ryb3kgOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBkZWxldGUgdGhpcy5fc2lnbmFsO1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMuX2xpc3RlbmVyO1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMuY29udGV4dDtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogQHJldHVybiB7c3RyaW5nfSBTdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgdGhlIG9iamVjdC5cbiAgICAgICAgICovXG4gICAgICAgIHRvU3RyaW5nIDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuICdbU2lnbmFsQmluZGluZyBpc09uY2U6JyArIHRoaXMuX2lzT25jZSArJywgaXNCb3VuZDonKyB0aGlzLmlzQm91bmQoKSArJywgYWN0aXZlOicgKyB0aGlzLmFjdGl2ZSArICddJztcbiAgICAgICAgfVxuXG4gICAgfTtcblxuXG4vKmdsb2JhbCBTaWduYWxCaW5kaW5nOmZhbHNlKi9cblxuICAgIC8vIFNpZ25hbCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gICAgZnVuY3Rpb24gdmFsaWRhdGVMaXN0ZW5lcihsaXN0ZW5lciwgZm5OYW1lKSB7XG4gICAgICAgIGlmICh0eXBlb2YgbGlzdGVuZXIgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvciggJ2xpc3RlbmVyIGlzIGEgcmVxdWlyZWQgcGFyYW0gb2Yge2ZufSgpIGFuZCBzaG91bGQgYmUgYSBGdW5jdGlvbi4nLnJlcGxhY2UoJ3tmbn0nLCBmbk5hbWUpICk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDdXN0b20gZXZlbnQgYnJvYWRjYXN0ZXJcbiAgICAgKiA8YnIgLz4tIGluc3BpcmVkIGJ5IFJvYmVydCBQZW5uZXIncyBBUzMgU2lnbmFscy5cbiAgICAgKiBAbmFtZSBTaWduYWxcbiAgICAgKiBAYXV0aG9yIE1pbGxlciBNZWRlaXJvc1xuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIFNpZ25hbCgpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEB0eXBlIEFycmF5LjxTaWduYWxCaW5kaW5nPlxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fYmluZGluZ3MgPSBbXTtcbiAgICAgICAgdGhpcy5fcHJldlBhcmFtcyA9IG51bGw7XG5cbiAgICAgICAgLy8gZW5mb3JjZSBkaXNwYXRjaCB0byBhd2F5cyB3b3JrIG9uIHNhbWUgY29udGV4dCAoIzQ3KVxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMuZGlzcGF0Y2ggPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgU2lnbmFsLnByb3RvdHlwZS5kaXNwYXRjaC5hcHBseShzZWxmLCBhcmd1bWVudHMpO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIFNpZ25hbC5wcm90b3R5cGUgPSB7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNpZ25hbHMgVmVyc2lvbiBOdW1iZXJcbiAgICAgICAgICogQHR5cGUgU3RyaW5nXG4gICAgICAgICAqIEBjb25zdFxuICAgICAgICAgKi9cbiAgICAgICAgVkVSU0lPTiA6ICcxLjAuMCcsXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIElmIFNpZ25hbCBzaG91bGQga2VlcCByZWNvcmQgb2YgcHJldmlvdXNseSBkaXNwYXRjaGVkIHBhcmFtZXRlcnMgYW5kXG4gICAgICAgICAqIGF1dG9tYXRpY2FsbHkgZXhlY3V0ZSBsaXN0ZW5lciBkdXJpbmcgYGFkZCgpYC9gYWRkT25jZSgpYCBpZiBTaWduYWwgd2FzXG4gICAgICAgICAqIGFscmVhZHkgZGlzcGF0Y2hlZCBiZWZvcmUuXG4gICAgICAgICAqIEB0eXBlIGJvb2xlYW5cbiAgICAgICAgICovXG4gICAgICAgIG1lbW9yaXplIDogZmFsc2UsXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEB0eXBlIGJvb2xlYW5cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIF9zaG91bGRQcm9wYWdhdGUgOiB0cnVlLFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJZiBTaWduYWwgaXMgYWN0aXZlIGFuZCBzaG91bGQgYnJvYWRjYXN0IGV2ZW50cy5cbiAgICAgICAgICogPHA+PHN0cm9uZz5JTVBPUlRBTlQ6PC9zdHJvbmc+IFNldHRpbmcgdGhpcyBwcm9wZXJ0eSBkdXJpbmcgYSBkaXNwYXRjaCB3aWxsIG9ubHkgYWZmZWN0IHRoZSBuZXh0IGRpc3BhdGNoLCBpZiB5b3Ugd2FudCB0byBzdG9wIHRoZSBwcm9wYWdhdGlvbiBvZiBhIHNpZ25hbCB1c2UgYGhhbHQoKWAgaW5zdGVhZC48L3A+XG4gICAgICAgICAqIEB0eXBlIGJvb2xlYW5cbiAgICAgICAgICovXG4gICAgICAgIGFjdGl2ZSA6IHRydWUsXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGxpc3RlbmVyXG4gICAgICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNPbmNlXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbbGlzdGVuZXJDb250ZXh0XVxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gW3ByaW9yaXR5XVxuICAgICAgICAgKiBAcmV0dXJuIHtTaWduYWxCaW5kaW5nfVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgX3JlZ2lzdGVyTGlzdGVuZXIgOiBmdW5jdGlvbiAobGlzdGVuZXIsIGlzT25jZSwgbGlzdGVuZXJDb250ZXh0LCBwcmlvcml0eSkge1xuXG4gICAgICAgICAgICB2YXIgcHJldkluZGV4ID0gdGhpcy5faW5kZXhPZkxpc3RlbmVyKGxpc3RlbmVyLCBsaXN0ZW5lckNvbnRleHQpLFxuICAgICAgICAgICAgICAgIGJpbmRpbmc7XG5cbiAgICAgICAgICAgIGlmIChwcmV2SW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgYmluZGluZyA9IHRoaXMuX2JpbmRpbmdzW3ByZXZJbmRleF07XG4gICAgICAgICAgICAgICAgaWYgKGJpbmRpbmcuaXNPbmNlKCkgIT09IGlzT25jZSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1lvdSBjYW5ub3QgYWRkJysgKGlzT25jZT8gJycgOiAnT25jZScpICsnKCkgdGhlbiBhZGQnKyAoIWlzT25jZT8gJycgOiAnT25jZScpICsnKCkgdGhlIHNhbWUgbGlzdGVuZXIgd2l0aG91dCByZW1vdmluZyB0aGUgcmVsYXRpb25zaGlwIGZpcnN0LicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYmluZGluZyA9IG5ldyBTaWduYWxCaW5kaW5nKHRoaXMsIGxpc3RlbmVyLCBpc09uY2UsIGxpc3RlbmVyQ29udGV4dCwgcHJpb3JpdHkpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2FkZEJpbmRpbmcoYmluZGluZyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmKHRoaXMubWVtb3JpemUgJiYgdGhpcy5fcHJldlBhcmFtcyl7XG4gICAgICAgICAgICAgICAgYmluZGluZy5leGVjdXRlKHRoaXMuX3ByZXZQYXJhbXMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gYmluZGluZztcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogQHBhcmFtIHtTaWduYWxCaW5kaW5nfSBiaW5kaW5nXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICBfYWRkQmluZGluZyA6IGZ1bmN0aW9uIChiaW5kaW5nKSB7XG4gICAgICAgICAgICAvL3NpbXBsaWZpZWQgaW5zZXJ0aW9uIHNvcnRcbiAgICAgICAgICAgIHZhciBuID0gdGhpcy5fYmluZGluZ3MubGVuZ3RoO1xuICAgICAgICAgICAgZG8geyAtLW47IH0gd2hpbGUgKHRoaXMuX2JpbmRpbmdzW25dICYmIGJpbmRpbmcuX3ByaW9yaXR5IDw9IHRoaXMuX2JpbmRpbmdzW25dLl9wcmlvcml0eSk7XG4gICAgICAgICAgICB0aGlzLl9iaW5kaW5ncy5zcGxpY2UobiArIDEsIDAsIGJpbmRpbmcpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBsaXN0ZW5lclxuICAgICAgICAgKiBAcmV0dXJuIHtudW1iZXJ9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICBfaW5kZXhPZkxpc3RlbmVyIDogZnVuY3Rpb24gKGxpc3RlbmVyLCBjb250ZXh0KSB7XG4gICAgICAgICAgICB2YXIgbiA9IHRoaXMuX2JpbmRpbmdzLmxlbmd0aCxcbiAgICAgICAgICAgICAgICBjdXI7XG4gICAgICAgICAgICB3aGlsZSAobi0tKSB7XG4gICAgICAgICAgICAgICAgY3VyID0gdGhpcy5fYmluZGluZ3Nbbl07XG4gICAgICAgICAgICAgICAgaWYgKGN1ci5fbGlzdGVuZXIgPT09IGxpc3RlbmVyICYmIGN1ci5jb250ZXh0ID09PSBjb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ2hlY2sgaWYgbGlzdGVuZXIgd2FzIGF0dGFjaGVkIHRvIFNpZ25hbC5cbiAgICAgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gbGlzdGVuZXJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IFtjb250ZXh0XVxuICAgICAgICAgKiBAcmV0dXJuIHtib29sZWFufSBpZiBTaWduYWwgaGFzIHRoZSBzcGVjaWZpZWQgbGlzdGVuZXIuXG4gICAgICAgICAqL1xuICAgICAgICBoYXMgOiBmdW5jdGlvbiAobGlzdGVuZXIsIGNvbnRleHQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pbmRleE9mTGlzdGVuZXIobGlzdGVuZXIsIGNvbnRleHQpICE9PSAtMTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogQWRkIGEgbGlzdGVuZXIgdG8gdGhlIHNpZ25hbC5cbiAgICAgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gbGlzdGVuZXIgU2lnbmFsIGhhbmRsZXIgZnVuY3Rpb24uXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbbGlzdGVuZXJDb250ZXh0XSBDb250ZXh0IG9uIHdoaWNoIGxpc3RlbmVyIHdpbGwgYmUgZXhlY3V0ZWQgKG9iamVjdCB0aGF0IHNob3VsZCByZXByZXNlbnQgdGhlIGB0aGlzYCB2YXJpYWJsZSBpbnNpZGUgbGlzdGVuZXIgZnVuY3Rpb24pLlxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gW3ByaW9yaXR5XSBUaGUgcHJpb3JpdHkgbGV2ZWwgb2YgdGhlIGV2ZW50IGxpc3RlbmVyLiBMaXN0ZW5lcnMgd2l0aCBoaWdoZXIgcHJpb3JpdHkgd2lsbCBiZSBleGVjdXRlZCBiZWZvcmUgbGlzdGVuZXJzIHdpdGggbG93ZXIgcHJpb3JpdHkuIExpc3RlbmVycyB3aXRoIHNhbWUgcHJpb3JpdHkgbGV2ZWwgd2lsbCBiZSBleGVjdXRlZCBhdCB0aGUgc2FtZSBvcmRlciBhcyB0aGV5IHdlcmUgYWRkZWQuIChkZWZhdWx0ID0gMClcbiAgICAgICAgICogQHJldHVybiB7U2lnbmFsQmluZGluZ30gQW4gT2JqZWN0IHJlcHJlc2VudGluZyB0aGUgYmluZGluZyBiZXR3ZWVuIHRoZSBTaWduYWwgYW5kIGxpc3RlbmVyLlxuICAgICAgICAgKi9cbiAgICAgICAgYWRkIDogZnVuY3Rpb24gKGxpc3RlbmVyLCBsaXN0ZW5lckNvbnRleHQsIHByaW9yaXR5KSB7XG4gICAgICAgICAgICB2YWxpZGF0ZUxpc3RlbmVyKGxpc3RlbmVyLCAnYWRkJyk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVnaXN0ZXJMaXN0ZW5lcihsaXN0ZW5lciwgZmFsc2UsIGxpc3RlbmVyQ29udGV4dCwgcHJpb3JpdHkpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBZGQgbGlzdGVuZXIgdG8gdGhlIHNpZ25hbCB0aGF0IHNob3VsZCBiZSByZW1vdmVkIGFmdGVyIGZpcnN0IGV4ZWN1dGlvbiAod2lsbCBiZSBleGVjdXRlZCBvbmx5IG9uY2UpLlxuICAgICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBsaXN0ZW5lciBTaWduYWwgaGFuZGxlciBmdW5jdGlvbi5cbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IFtsaXN0ZW5lckNvbnRleHRdIENvbnRleHQgb24gd2hpY2ggbGlzdGVuZXIgd2lsbCBiZSBleGVjdXRlZCAob2JqZWN0IHRoYXQgc2hvdWxkIHJlcHJlc2VudCB0aGUgYHRoaXNgIHZhcmlhYmxlIGluc2lkZSBsaXN0ZW5lciBmdW5jdGlvbikuXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbcHJpb3JpdHldIFRoZSBwcmlvcml0eSBsZXZlbCBvZiB0aGUgZXZlbnQgbGlzdGVuZXIuIExpc3RlbmVycyB3aXRoIGhpZ2hlciBwcmlvcml0eSB3aWxsIGJlIGV4ZWN1dGVkIGJlZm9yZSBsaXN0ZW5lcnMgd2l0aCBsb3dlciBwcmlvcml0eS4gTGlzdGVuZXJzIHdpdGggc2FtZSBwcmlvcml0eSBsZXZlbCB3aWxsIGJlIGV4ZWN1dGVkIGF0IHRoZSBzYW1lIG9yZGVyIGFzIHRoZXkgd2VyZSBhZGRlZC4gKGRlZmF1bHQgPSAwKVxuICAgICAgICAgKiBAcmV0dXJuIHtTaWduYWxCaW5kaW5nfSBBbiBPYmplY3QgcmVwcmVzZW50aW5nIHRoZSBiaW5kaW5nIGJldHdlZW4gdGhlIFNpZ25hbCBhbmQgbGlzdGVuZXIuXG4gICAgICAgICAqL1xuICAgICAgICBhZGRPbmNlIDogZnVuY3Rpb24gKGxpc3RlbmVyLCBsaXN0ZW5lckNvbnRleHQsIHByaW9yaXR5KSB7XG4gICAgICAgICAgICB2YWxpZGF0ZUxpc3RlbmVyKGxpc3RlbmVyLCAnYWRkT25jZScpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlZ2lzdGVyTGlzdGVuZXIobGlzdGVuZXIsIHRydWUsIGxpc3RlbmVyQ29udGV4dCwgcHJpb3JpdHkpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSZW1vdmUgYSBzaW5nbGUgbGlzdGVuZXIgZnJvbSB0aGUgZGlzcGF0Y2ggcXVldWUuXG4gICAgICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGxpc3RlbmVyIEhhbmRsZXIgZnVuY3Rpb24gdGhhdCBzaG91bGQgYmUgcmVtb3ZlZC5cbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IFtjb250ZXh0XSBFeGVjdXRpb24gY29udGV4dCAoc2luY2UgeW91IGNhbiBhZGQgdGhlIHNhbWUgaGFuZGxlciBtdWx0aXBsZSB0aW1lcyBpZiBleGVjdXRpbmcgaW4gYSBkaWZmZXJlbnQgY29udGV4dCkuXG4gICAgICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufSBMaXN0ZW5lciBoYW5kbGVyIGZ1bmN0aW9uLlxuICAgICAgICAgKi9cbiAgICAgICAgcmVtb3ZlIDogZnVuY3Rpb24gKGxpc3RlbmVyLCBjb250ZXh0KSB7XG4gICAgICAgICAgICB2YWxpZGF0ZUxpc3RlbmVyKGxpc3RlbmVyLCAncmVtb3ZlJyk7XG5cbiAgICAgICAgICAgIHZhciBpID0gdGhpcy5faW5kZXhPZkxpc3RlbmVyKGxpc3RlbmVyLCBjb250ZXh0KTtcbiAgICAgICAgICAgIGlmIChpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2JpbmRpbmdzW2ldLl9kZXN0cm95KCk7IC8vbm8gcmVhc29uIHRvIGEgU2lnbmFsQmluZGluZyBleGlzdCBpZiBpdCBpc24ndCBhdHRhY2hlZCB0byBhIHNpZ25hbFxuICAgICAgICAgICAgICAgIHRoaXMuX2JpbmRpbmdzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBsaXN0ZW5lcjtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogUmVtb3ZlIGFsbCBsaXN0ZW5lcnMgZnJvbSB0aGUgU2lnbmFsLlxuICAgICAgICAgKi9cbiAgICAgICAgcmVtb3ZlQWxsIDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIG4gPSB0aGlzLl9iaW5kaW5ncy5sZW5ndGg7XG4gICAgICAgICAgICB3aGlsZSAobi0tKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYmluZGluZ3Nbbl0uX2Rlc3Ryb3koKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX2JpbmRpbmdzLmxlbmd0aCA9IDA7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEByZXR1cm4ge251bWJlcn0gTnVtYmVyIG9mIGxpc3RlbmVycyBhdHRhY2hlZCB0byB0aGUgU2lnbmFsLlxuICAgICAgICAgKi9cbiAgICAgICAgZ2V0TnVtTGlzdGVuZXJzIDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2JpbmRpbmdzLmxlbmd0aDtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogU3RvcCBwcm9wYWdhdGlvbiBvZiB0aGUgZXZlbnQsIGJsb2NraW5nIHRoZSBkaXNwYXRjaCB0byBuZXh0IGxpc3RlbmVycyBvbiB0aGUgcXVldWUuXG4gICAgICAgICAqIDxwPjxzdHJvbmc+SU1QT1JUQU5UOjwvc3Ryb25nPiBzaG91bGQgYmUgY2FsbGVkIG9ubHkgZHVyaW5nIHNpZ25hbCBkaXNwYXRjaCwgY2FsbGluZyBpdCBiZWZvcmUvYWZ0ZXIgZGlzcGF0Y2ggd29uJ3QgYWZmZWN0IHNpZ25hbCBicm9hZGNhc3QuPC9wPlxuICAgICAgICAgKiBAc2VlIFNpZ25hbC5wcm90b3R5cGUuZGlzYWJsZVxuICAgICAgICAgKi9cbiAgICAgICAgaGFsdCA6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuX3Nob3VsZFByb3BhZ2F0ZSA9IGZhbHNlO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBEaXNwYXRjaC9Ccm9hZGNhc3QgU2lnbmFsIHRvIGFsbCBsaXN0ZW5lcnMgYWRkZWQgdG8gdGhlIHF1ZXVlLlxuICAgICAgICAgKiBAcGFyYW0gey4uLip9IFtwYXJhbXNdIFBhcmFtZXRlcnMgdGhhdCBzaG91bGQgYmUgcGFzc2VkIHRvIGVhY2ggaGFuZGxlci5cbiAgICAgICAgICovXG4gICAgICAgIGRpc3BhdGNoIDogZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICAgICAgaWYgKCEgdGhpcy5hY3RpdmUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBwYXJhbXNBcnIgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpLFxuICAgICAgICAgICAgICAgIG4gPSB0aGlzLl9iaW5kaW5ncy5sZW5ndGgsXG4gICAgICAgICAgICAgICAgYmluZGluZ3M7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLm1lbW9yaXplKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fcHJldlBhcmFtcyA9IHBhcmFtc0FycjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCEgbikge1xuICAgICAgICAgICAgICAgIC8vc2hvdWxkIGNvbWUgYWZ0ZXIgbWVtb3JpemVcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGJpbmRpbmdzID0gdGhpcy5fYmluZGluZ3Muc2xpY2UoKTsgLy9jbG9uZSBhcnJheSBpbiBjYXNlIGFkZC9yZW1vdmUgaXRlbXMgZHVyaW5nIGRpc3BhdGNoXG4gICAgICAgICAgICB0aGlzLl9zaG91bGRQcm9wYWdhdGUgPSB0cnVlOyAvL2luIGNhc2UgYGhhbHRgIHdhcyBjYWxsZWQgYmVmb3JlIGRpc3BhdGNoIG9yIGR1cmluZyB0aGUgcHJldmlvdXMgZGlzcGF0Y2guXG5cbiAgICAgICAgICAgIC8vZXhlY3V0ZSBhbGwgY2FsbGJhY2tzIHVudGlsIGVuZCBvZiB0aGUgbGlzdCBvciB1bnRpbCBhIGNhbGxiYWNrIHJldHVybnMgYGZhbHNlYCBvciBzdG9wcyBwcm9wYWdhdGlvblxuICAgICAgICAgICAgLy9yZXZlcnNlIGxvb3Agc2luY2UgbGlzdGVuZXJzIHdpdGggaGlnaGVyIHByaW9yaXR5IHdpbGwgYmUgYWRkZWQgYXQgdGhlIGVuZCBvZiB0aGUgbGlzdFxuICAgICAgICAgICAgZG8geyBuLS07IH0gd2hpbGUgKGJpbmRpbmdzW25dICYmIHRoaXMuX3Nob3VsZFByb3BhZ2F0ZSAmJiBiaW5kaW5nc1tuXS5leGVjdXRlKHBhcmFtc0FycikgIT09IGZhbHNlKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogRm9yZ2V0IG1lbW9yaXplZCBhcmd1bWVudHMuXG4gICAgICAgICAqIEBzZWUgU2lnbmFsLm1lbW9yaXplXG4gICAgICAgICAqL1xuICAgICAgICBmb3JnZXQgOiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgdGhpcy5fcHJldlBhcmFtcyA9IG51bGw7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJlbW92ZSBhbGwgYmluZGluZ3MgZnJvbSBzaWduYWwgYW5kIGRlc3Ryb3kgYW55IHJlZmVyZW5jZSB0byBleHRlcm5hbCBvYmplY3RzIChkZXN0cm95IFNpZ25hbCBvYmplY3QpLlxuICAgICAgICAgKiA8cD48c3Ryb25nPklNUE9SVEFOVDo8L3N0cm9uZz4gY2FsbGluZyBhbnkgbWV0aG9kIG9uIHRoZSBzaWduYWwgaW5zdGFuY2UgYWZ0ZXIgY2FsbGluZyBkaXNwb3NlIHdpbGwgdGhyb3cgZXJyb3JzLjwvcD5cbiAgICAgICAgICovXG4gICAgICAgIGRpc3Bvc2UgOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUFsbCgpO1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMuX2JpbmRpbmdzO1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMuX3ByZXZQYXJhbXM7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEByZXR1cm4ge3N0cmluZ30gU3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBvYmplY3QuXG4gICAgICAgICAqL1xuICAgICAgICB0b1N0cmluZyA6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAnW1NpZ25hbCBhY3RpdmU6JysgdGhpcy5hY3RpdmUgKycgbnVtTGlzdGVuZXJzOicrIHRoaXMuZ2V0TnVtTGlzdGVuZXJzKCkgKyddJztcbiAgICAgICAgfVxuXG4gICAgfTtcblxuXG4gICAgLy8gTmFtZXNwYWNlIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgICAvKipcbiAgICAgKiBTaWduYWxzIG5hbWVzcGFjZVxuICAgICAqIEBuYW1lc3BhY2VcbiAgICAgKiBAbmFtZSBzaWduYWxzXG4gICAgICovXG4gICAgdmFyIHNpZ25hbHMgPSBTaWduYWw7XG5cbiAgICAvKipcbiAgICAgKiBDdXN0b20gZXZlbnQgYnJvYWRjYXN0ZXJcbiAgICAgKiBAc2VlIFNpZ25hbFxuICAgICAqL1xuICAgIC8vIGFsaWFzIGZvciBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eSAoc2VlICNnaC00NClcbiAgICBzaWduYWxzLlNpZ25hbCA9IFNpZ25hbDtcblxuXG5cbiAgICAvL2V4cG9ydHMgdG8gbXVsdGlwbGUgZW52aXJvbm1lbnRzXG4gICAgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKXsgLy9BTURcbiAgICAgICAgZGVmaW5lKGZ1bmN0aW9uICgpIHsgcmV0dXJuIHNpZ25hbHM7IH0pO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgJiYgbW9kdWxlLmV4cG9ydHMpeyAvL25vZGVcbiAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSBzaWduYWxzO1xuICAgIH0gZWxzZSB7IC8vYnJvd3NlclxuICAgICAgICAvL3VzZSBzdHJpbmcgYmVjYXVzZSBvZiBHb29nbGUgY2xvc3VyZSBjb21waWxlciBBRFZBTkNFRF9NT0RFXG4gICAgICAgIC8qanNsaW50IHN1Yjp0cnVlICovXG4gICAgICAgIGdsb2JhbFsnc2lnbmFscyddID0gc2lnbmFscztcbiAgICB9XG5cbn0odGhpcykpO1xuIiwidmFyIGVscyA9IHtcblx0cGxheWVyIDogZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgndGV4dC0tcGxheWVyJylbMF0sXG5cdGdlbmVyYWwgOiBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCd0ZXh0LS1nZW5lcmFsJylbMF0sXG5cdGFpIDogZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgndGV4dC0tYWknKVswXVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihjbGFzc1Bvc3RGaXgsIHRleHQpIHtcblxuXHRlbHNbY2xhc3NQb3N0Rml4XS5pbm5lckhUTUwgPSB0ZXh0O1xufTsiXX0=\n"],"sourceRoot":"/source/"}