{"version":3,"sources":["main.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length",1,"module","cleanUpNextTick","draining","currentQueue","queue","concat","queueIndex","drainQueue","timeout","setTimeout","len","run","clearTimeout","Item","fun","array","this","noop","process","nextTick","args","Array","arguments","push","prototype","apply","title","browser","env","argv","version","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","binding","name","cwd","chdir","dir","umask",2,"Q","Signal","action","delay","hasLogs","execute","_deferred","defer","startTimer","_delay","onDelayFinished","promise","_currentState","STATE_ON_TIME","_stateIsOnTimeSignal","dispatch","_requestedAction","fireAction","firedAction","killTimer","STATE_TOO_SOON","reject","resolve","getRequestedAction","destroy","_timer","callback","stateIsOnTimeSignal","../utils/kew","../utils/signals",3,"writeInDiv","Move","constants","signalBus","sample","init","divClass","numMoves","isAutomatedPlayer","chanceOfFailing","_numMoves","_classPostFix","_chanceOfFailing","_isAutomatedPlayer","createCombo","ACTION_FIRED","add","onActionFired","_allMovesString","_chain","addRandomMove","_currentMove","remove","randomAction","ALL_ACTIONS","newMove","start","validateChain","shift","onCurrentMoveIsReady","executeMove","then","moveExecuted","fail","moveFailed","fin","moveFinished","shouldFail","requestedAction","Math","random","message","../utils/sampleArray","../utils/writeInDiv","./Move","./constants","./signalBus",4,"window","addEventListener","onKeyDown","keyCode","ACTION_ENTER","ACTION_UP","ACTION_DOWN","ACTION_LEFT","ACTION_RIGHT",5,6,7,"isPlaying","stop","humanPlayer","datGuiProps","moves","aiPlayer","aiDelay","aiMissChance","gameOver","onError","playerWon","actionHandler","Player","gui","dat","GUI","step","./core/Player","./core/actionHandler","./core/constants","./core/signalBus","./utils/writeInDiv",8,"Promise","onSuccess","onFail","_isPromise","_successFn","_failFn","_scope","_boundArgs","_hasContext","_nextContext","undefined","_currentContext","nextTickCallback","scope","thrown","getNextTickFunction","setNextTickFunction","fn","PromiseStats","errorsEmitted","errorsHandled","resolver","deferred","err","data","isPromise","obj","isPromiseLike","replaceEl","arr","idx","val","replaceElFulfilled","value","state","replaceElRejected","reason","all","promises","isArray","slice","allInternal","outputs","finished","counter","bind","allSettled","spread","delayMsOrVal","opt_delayMs","returnVal","delayMs","fcall","var_args","rootArgs","nfcall","splice","ncall","bindPromise","makeNodeResolver","stats","_handleError","_errorHandled","_useContext","context","clearContext","setContext","getContext","_error","_hasData","_child","_promises","_chainPromise","_onComplete","_data","_withInput","_ended","_withError","thenBound","failBound","spreadBound","onComplete","end","_end","done","onFailure","self","timeoutMs","timeoutMsg","isTimeout","_nextTick","ms","_process",9,"floor",10,"global","SignalBinding","signal","listener","isOnce","listenerContext","priority","_listener","_isOnce","_signal","_priority","validateListener","fnName","replace","_bindings","_prevParams","active","params","paramsArr","handlerReturn","detach","isBound","getListener","getSignal","_destroy","toString","VERSION","memorize","_shouldPropagate","_registerListener","prevIndex","_indexOfListener","_addBinding","cur","has","addOnce","removeAll","getNumListeners","halt","bindings","forget","dispose","signals","define","amd",11,"els","player","document","getElementsByClassName","general","ai","classPostFix","text","innerHTML"],"mappings":"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","file":"main.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n// shim for using process in browser\n\nvar process = module.exports = {};\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = setTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    clearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        setTimeout(drainQueue, 0);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n},{}],2:[function(require,module,exports){\nvar Q = require('../utils/kew'),\n\tSignal = require('../utils/signals');\n\nmodule.exports = function(action, delay, hasLogs) {\n\n\tvar STATE_TOO_SOON = 0,\n\t\tSTATE_ON_TIME = 1;\n\n\tvar _timer,\n\t\t_deferred,\n\t\t_stateIsOnTimeSignal = new Signal(),\n\t\t_currentState = STATE_TOO_SOON,\n\t\t_requestedAction = action,\n\t\t_delay = delay;\n\n\n\tfunction execute() {\n\n\t\t_deferred = Q.defer();\n\n\t\tstartTimer(_delay, onDelayFinished);\n\n\t\treturn _deferred.promise;\n\t}\n\n\tfunction onDelayFinished() {\n\n\t\t_currentState = STATE_ON_TIME;\n\t\t_stateIsOnTimeSignal.dispatch(_requestedAction);\n\t}\n\n\tfunction fireAction(firedAction) {\n\n\t\tkillTimer();\n\n\t\tif(_currentState === STATE_TOO_SOON) {\n\n\t\t\t_deferred.reject('too soon!');\n\n\t\t} else if(firedAction !== _requestedAction) {\n\n\t\t\t_deferred.reject('wrong action!');\n\n\t\t} else {\n\n\t\t\t_deferred.resolve('success!');\n\t\t}\n\t}\n\n\tfunction getRequestedAction() {\n\n\t\treturn _requestedAction;\n\t}\n\n\tfunction destroy() {\n\n\t\tkillTimer();\n\t}\n\n\tfunction killTimer() {\n\n\t\tclearTimeout(_timer);\n\t}\n\n\tfunction startTimer(delay, callback) {\n\n\t\t_timer = setTimeout(callback, delay);\n\t}\n\n\tthis.stateIsOnTimeSignal = _stateIsOnTimeSignal;\n\tthis.getRequestedAction = getRequestedAction;\n\tthis.fireAction = fireAction;\n\tthis.execute = execute;\n\tthis.destroy = destroy;\n};\n},{\"../utils/kew\":8,\"../utils/signals\":10}],3:[function(require,module,exports){\nvar Q = require('../utils/kew'),\n\twriteInDiv = require('../utils/writeInDiv'),\n\tMove = require('./Move'),\n\tconstants = require('./constants'),\n\tsignalBus = require('./signalBus'),\n\tsample = require('../utils/sampleArray');\n\nmodule.exports = function() {\n\n\tvar _deferred,\n\t\t_allMovesString,\n\t\t_numMoves,\n\t\t_classPostFix,\n\t\t_chanceOfFailing,\n\t\t_delay,\n\t\t_chain,\n\t\t_currentMove,\n\t\t_isAutomatedPlayer;\n\n\n\tfunction init(divClass, numMoves, delay, isAutomatedPlayer, chanceOfFailing) {\n\n\t\t_numMoves = numMoves;\n\t\t_deferred = Q.defer();\n\t\t_classPostFix = divClass;\n\t\t_delay = delay;\n\t\t_chanceOfFailing = chanceOfFailing;\n\t\t_isAutomatedPlayer = isAutomatedPlayer;\n\n\t\tcreateCombo();\n\n\t\tif(!_isAutomatedPlayer) {\n\n\t\t\tsignalBus.ACTION_FIRED.add(onActionFired);\n\t\t}\n\t}\n\n\tfunction createCombo() {\n\n\t\tvar i = 0;\n\n\t\t_allMovesString = '';\n\n\t\t_chain = [];\n\n\t\tfor(i; i < _numMoves; i++) {\n\n\t\t\t_allMovesString += addRandomMove() + ', ';\n\t\t}\n\n\t\t_allMovesString += '<br>';\n\t}\n\n\tfunction destroy() {\n\n\t\tvar i = 0;\n\n\t\tif(_currentMove) {\n\n\t\t\t_currentMove.destroy();\n\t\t}\n\n\t\tfor(i; i < _chain.length; i++) {\n\n\t\t\t_chain[i].destroy();\n\t\t}\n\n\t\t_chain = null;\n\t\tsignalBus.ACTION_FIRED.remove(onActionFired);\n\t}\n\n\tfunction onActionFired(firedAction) {\n\n\t\tif(_currentMove) {\n\n\t\t\t_currentMove.fireAction(firedAction);\n\t\t}\n\t}\n\n\tfunction addRandomMove() {\n\n\t\tvar randomAction = sample(constants.ALL_ACTIONS),\n\t\t\tnewMove = new Move(randomAction, _delay);\n\n\t\t_chain.push(newMove);\n\n\t\treturn randomAction;\n\t}\n\n\tfunction start() {\n\n\t\tvalidateChain();\n\n\t\twriteInDiv(_classPostFix, 'Get READY!');\n\n\t\treturn _deferred.promise;\n\t}\n\n\tfunction validateChain() {\n\n\t\t_currentMove = _chain.shift();\n\n\t\tif(_currentMove) {\n\n\t\t\t_currentMove.stateIsOnTimeSignal.add(onCurrentMoveIsReady);\n\t\t\texecuteMove();\n\n\t\t} else {\n\n\t\t\t_deferred.resolve();\n\t\t}\n\t}\n\n\tfunction executeMove() {\n\n\t\t_currentMove.execute()\n\t\t\t.then(moveExecuted)\n\t\t\t.fail(moveFailed)\n\t\t\t.fin(moveFinished)\n\t}\n\n\tfunction onCurrentMoveIsReady() {\n\n\t\tvar requestedAction = _currentMove.getRequestedAction(),\n\t\t\tshouldFail;\n\n\t\tif(_isAutomatedPlayer) {\n\n\t\t\tshouldFail = Math.random() < _chanceOfFailing;\n\n\t\t\tif(shouldFail) {\n\n\t\t\t\t_currentMove.fireAction();\n\n\t\t\t} else {\n\n\t\t\t\t_currentMove.fireAction(requestedAction);\n\t\t\t}\n\n\t\t} else {\n\n\t\t\twriteInDiv(_classPostFix, _allMovesString);\n\t\t}\n\t}\n\n\tfunction moveExecuted() {\n\n\t\tif(_isAutomatedPlayer) {\n\n\t\t\twriteInDiv(_classPostFix, 'AI has ' + _chain.length + ' moves left');\n\n\t\t} else {\n\n\t\t\twriteInDiv(_classPostFix, _allMovesString + 'Got it!');\n\t\t}\n\t}\n\n\tfunction moveFailed(message) {\n\n\t\tcreateCombo();\n\n\t\tif(!_isAutomatedPlayer) {\n\n\t\t\twriteInDiv(_classPostFix, _allMovesString + 'Woops, ' + message);\n\n\t\t} else {\n\n\t\t\twriteInDiv(_classPostFix, 'AI missed!');\n\t\t}\n\t}\n\n\tfunction moveFinished() {\n\n\t\t_currentMove.destroy();\n\t\tvalidateChain();\n\t}\n\n\tthis.init = init;\n\tthis.start = start;\n\tthis.destroy = destroy;\n};\n},{\"../utils/kew\":8,\"../utils/sampleArray\":9,\"../utils/writeInDiv\":11,\"./Move\":2,\"./constants\":5,\"./signalBus\":6}],4:[function(require,module,exports){\nvar constants = require('./constants'),\n\tsignalBus = require('./signalBus');\n\nfunction init() {\n\n\twindow.addEventListener('keydown', onKeyDown);\n}\n\nfunction onKeyDown(e) {\n\n\tvar action;\n\n\tswitch(e.keyCode) {\n\n\t\tcase 13: action = constants.ACTION_ENTER; break;\n\n\t\tcase 38: action = constants.ACTION_UP; break;\n\t\tcase 40: action = constants.ACTION_DOWN; break;\n\t\tcase 37: action = constants.ACTION_LEFT; break;\n\t\tcase 39: action = constants.ACTION_RIGHT; break;\n\t}\n\n\tsignalBus.ACTION_FIRED.dispatch(action);\n}\n\nexports.init = init;\n},{\"./constants\":5,\"./signalBus\":6}],5:[function(require,module,exports){\nvar ACTION_UP = 'ACTION_UP',\n\tACTION_ENTER = 'ACTION_ENTER',\n\tACTION_DOWN = 'ACTION_DOWN',\n\tACTION_LEFT = 'ACTION_LEFT',\n\tACTION_RIGHT = 'ACTION_RIGHT';\n\nexports.ACTION_ENTER = ACTION_ENTER;\nexports.ACTION_UP = ACTION_UP;\nexports.ACTION_DOWN = ACTION_DOWN;\nexports.ACTION_LEFT = ACTION_LEFT;\nexports.ACTION_RIGHT = ACTION_RIGHT;\nexports.ALL_ACTIONS = [ACTION_UP, ACTION_DOWN, ACTION_LEFT, ACTION_RIGHT];\n\n\n},{}],6:[function(require,module,exports){\nvar Signal = require('../utils/signals');\n\nexports.ACTION_FIRED = new Signal();\n},{\"../utils/signals\":10}],7:[function(require,module,exports){\nvar actionHandler = require('./core/actionHandler'),\n\tsignalBus = require('./core/signalBus'),\n\twriteInDiv = require('./utils/writeInDiv'),\n\tconstants = require('./core/constants'),\n\tPlayer = require('./core/Player');\n\n\nvar humanPlayer = new Player(),\n\taiPlayer = new Player(),\n\tisPlaying = false,\n\tdatGuiProps = new function() {\n\n\t\tthis.moves = 5;\n\t\tthis.aiDelay = 2000;\n\t\tthis.aiMissChance = 0;\n\n\t\tthis.start = start;\n\t\tthis.stop = stop;\n\t}();\n\nvar gui = new dat.GUI();\ngui.add(datGuiProps, 'moves', 0, 10).step(1);\ngui.add(datGuiProps, 'aiDelay', 0, 5000).step(100);\ngui.add(datGuiProps, 'aiMissChance', 0, 1).step(0.05);\ngui.add(datGuiProps, 'start');\ngui.add(datGuiProps, 'stop');\n\nwriteInDiv('general', 'Press `ENTER` to start');\nactionHandler.init();\n\nsignalBus.ACTION_FIRED.add(onActionFired);\n\nfunction onActionFired(action) {\n\n\tif(action === constants.ACTION_ENTER) {\n\n\t\tif(!isPlaying) {\n\n\t\t\tstart();\n\n\t\t} else {\n\n\t\t\tstop();\n\t\t}\n\t}\n}\n\nfunction start() {\n\n\tif(isPlaying) {\n\n\t\tstop();\n\t}\n\n\twriteInDiv('general', '');\n\n\tisPlaying = true;\n\thumanPlayer.init('player', datGuiProps.moves, 0, false);\n\taiPlayer.init('ai', datGuiProps.moves, datGuiProps.aiDelay, true, datGuiProps.aiMissChance);\n\n\thumanPlayer.start()\n\t\t.then(function(){\n\t\t\tgameOver(true);\n\t\t}).fail(onError);\n\taiPlayer.start()\n\t\t.then(function(){\n\n\t\t\tgameOver(false);\n\t\t}).fail(onError);\n}\n\nfunction onError(e) {\n\tconsole.error(e);\n}\n\nfunction gameOver(playerWon) {\n\n\twriteInDiv('player', '');\n\twriteInDiv('ai', '');\n\tif(playerWon) {\n\n\t\twriteInDiv('general', 'You won!<br>Press `ENTER` to replay');\n\n\t} else {\n\n\t\twriteInDiv('general', 'You lost...<br>Press `ENTER` to replay');\n\t}\n\n\tstop();\n}\n\nfunction stop() {\n\n\tisPlaying = false;\n\n\thumanPlayer.destroy();\n\taiPlayer.destroy();\n}\n},{\"./core/Player\":3,\"./core/actionHandler\":4,\"./core/constants\":5,\"./core/signalBus\":6,\"./utils/writeInDiv\":11}],8:[function(require,module,exports){\n(function (process){\n\n/**\n * An object representing a \"promise\" for a future value\n *\n * @param {?function(T, ?)=} onSuccess a function to handle successful\n *     resolution of this promise\n * @param {?function(!Error, ?)=} onFail a function to handle failed\n *     resolution of this promise\n * @constructor\n * @template T\n */\nfunction Promise(onSuccess, onFail) {\n  this.promise = this\n  this._isPromise = true\n  this._successFn = onSuccess\n  this._failFn = onFail\n  this._scope = this\n  this._boundArgs = null\n  this._hasContext = false\n  this._nextContext = undefined\n  this._currentContext = undefined\n}\n\n/**\n * @param {function()} callback\n */\nfunction nextTick (callback) {\n  callback()\n}\n\nif (typeof process !== 'undefined' && typeof process.nextTick === 'function') {\n  nextTick = process.nextTick\n}\n\n/**\n * All callback execution should go through this function.  While the\n * implementation below is simple, it can be replaced with more sophisticated\n * implementations that enforce QoS on the event loop.\n *\n * @param {Promise} defer\n * @param {Function} callback\n * @param {Object|undefined} scope\n * @param {Array} args\n */\nfunction nextTickCallback (defer, callback, scope, args) {\n  try {\n    defer.resolve(callback.apply(scope, args))\n  } catch (thrown) {\n    defer.reject(thrown)\n  }\n}\n\n/**\n * Used for accessing the nextTick function from outside the kew module.\n *\n * @return {Function}\n */\nfunction getNextTickFunction () {\n  return nextTick\n}\n\n/**\n * Used for overriding the nextTick function from outside the kew module so that\n * the user can plug and play lower level schedulers\n * @param {!Function} fn\n */\nfunction setNextTickFunction (fn) {\n  nextTick = fn\n}\n\n/**\n * Keep track of the number of promises that are rejected along side\n * the number of rejected promises we call _failFn on so we can look\n * for leaked rejections.\n * @constructor\n */\nfunction PromiseStats() {\n  /** @type {number} */\n  this.errorsEmitted = 0\n\n  /** @type {number} */\n  this.errorsHandled = 0\n}\n\nvar stats = new PromiseStats()\n\nPromise.prototype._handleError = function () {\n  if (!this._errorHandled) {\n    stats.errorsHandled++\n    this._errorHandled = true\n  }\n}\n\n/**\n * Specify that the current promise should have a specified context\n * @param  {*} context context\n * @private\n */\nPromise.prototype._useContext = function (context) {\n  this._nextContext = this._currentContext = context\n  this._hasContext = true\n  return this\n}\n\nPromise.prototype.clearContext = function () {\n  this._hasContext = false\n  this._nextContext = undefined\n  return this\n}\n\n/**\n * Set the context for all promise handlers to follow\n *\n * NOTE(dpup): This should be considered deprecated.  It does not do what most\n * people would expect.  The context will be passed as a second argument to all\n * subsequent callbacks.\n *\n * @param {*} context An arbitrary context\n */\nPromise.prototype.setContext = function (context) {\n  this._nextContext = context\n  this._hasContext = true\n  return this\n}\n\n/**\n * Get the context for a promise\n * @return {*} the context set by setContext\n */\nPromise.prototype.getContext = function () {\n  return this._nextContext\n}\n\n/**\n * Resolve this promise with a specified value\n *\n * @param {*=} data\n */\nPromise.prototype.resolve = function (data) {\n  if (this._error || this._hasData) throw new Error(\"Unable to resolve or reject the same promise twice\")\n\n  var i\n  if (data && isPromise(data)) {\n    this._child = data\n    if (this._promises) {\n      for (i = 0; i < this._promises.length; i += 1) {\n        data._chainPromise(this._promises[i])\n      }\n      delete this._promises\n    }\n\n    if (this._onComplete) {\n      for (i = 0; i < this._onComplete.length; i+= 1) {\n        data.fin(this._onComplete[i])\n      }\n      delete this._onComplete\n    }\n  } else if (data && isPromiseLike(data)) {\n    data.then(\n      function(data) { this.resolve(data) }.bind(this),\n      function(err) { this.reject(err) }.bind(this)\n    )\n  } else {\n    this._hasData = true\n    this._data = data\n\n    if (this._onComplete) {\n      for (i = 0; i < this._onComplete.length; i++) {\n        this._onComplete[i]()\n      }\n    }\n\n    if (this._promises) {\n      for (i = 0; i < this._promises.length; i += 1) {\n        this._promises[i]._useContext(this._nextContext)\n        this._promises[i]._withInput(data)\n      }\n      delete this._promises\n    }\n  }\n}\n\n/**\n * Reject this promise with an error\n *\n * @param {!Error} e\n */\nPromise.prototype.reject = function (e) {\n  if (this._error || this._hasData) throw new Error(\"Unable to resolve or reject the same promise twice\")\n\n  var i\n  this._error = e\n  stats.errorsEmitted++\n\n  if (this._ended) {\n    this._handleError()\n    process.nextTick(function onPromiseThrow() {\n      throw e\n    })\n  }\n\n  if (this._onComplete) {\n    for (i = 0; i < this._onComplete.length; i++) {\n      this._onComplete[i]()\n    }\n  }\n\n  if (this._promises) {\n    this._handleError()\n    for (i = 0; i < this._promises.length; i += 1) {\n      this._promises[i]._useContext(this._nextContext)\n      this._promises[i]._withError(e)\n    }\n    delete this._promises\n  }\n}\n\n/**\n * Provide a callback to be called whenever this promise successfully\n * resolves. Allows for an optional second callback to handle the failure\n * case.\n *\n * @param {?function(this:void, T, ?): RESULT|undefined} onSuccess\n * @param {?function(this:void, !Error, ?): RESULT=} onFail\n * @return {!Promise.<RESULT>} returns a new promise with the output of the onSuccess or\n *     onFail handler\n * @template RESULT\n */\nPromise.prototype.then = function (onSuccess, onFail) {\n  var promise = new Promise(onSuccess, onFail)\n  if (this._nextContext) promise._useContext(this._nextContext)\n\n  if (this._child) this._child._chainPromise(promise)\n  else this._chainPromise(promise)\n\n  return promise\n}\n\n/**\n * Provide a callback to be called whenever this promise successfully\n * resolves. The callback will be executed in the context of the provided scope.\n *\n * @param {function(this:SCOPE, ...): RESULT} onSuccess\n * @param {SCOPE} scope Object whose context callback will be executed in.\n * @param {...*} var_args Additional arguments to be passed to the promise callback.\n * @return {!Promise.<RESULT>} returns a new promise with the output of the onSuccess\n * @template SCOPE, RESULT\n */\nPromise.prototype.thenBound = function (onSuccess, scope, var_args) {\n  var promise = new Promise(onSuccess)\n  if (this._nextContext) promise._useContext(this._nextContext)\n\n  promise._scope = scope\n  if (arguments.length > 2) {\n    promise._boundArgs = Array.prototype.slice.call(arguments, 2)\n  }\n\n  // Chaining must happen after setting args and scope since it may fire callback.\n  if (this._child) this._child._chainPromise(promise)\n  else this._chainPromise(promise)\n\n  return promise\n}\n\n/**\n * Provide a callback to be called whenever this promise is rejected\n *\n * @param {function(this:void, !Error, ?)} onFail\n * @return {!Promise.<T>} returns a new promise with the output of the onFail handler\n */\nPromise.prototype.fail = function (onFail) {\n  return this.then(null, onFail)\n}\n\n/**\n * Provide a callback to be called whenever this promise is rejected.\n * The callback will be executed in the context of the provided scope.\n *\n * @param {function(this:SCOPE, ...)} onFail\n * @param {SCOPE} scope Object whose context callback will be executed in.\n * @param {...?} var_args\n * @return {!Promise.<T>} returns a new promise with the output of the onSuccess\n * @template SCOPE\n */\nPromise.prototype.failBound = function (onFail, scope, var_args) {\n  var promise = new Promise(null, onFail)\n  if (this._nextContext) promise._useContext(this._nextContext)\n\n  promise._scope = scope\n  if (arguments.length > 2) {\n    promise._boundArgs = Array.prototype.slice.call(arguments, 2)\n  }\n\n  // Chaining must happen after setting args and scope since it may fire callback.\n  if (this._child) this._child._chainPromise(promise)\n  else this._chainPromise(promise)\n\n  return promise\n}\n\n/**\n * Spread a promises outputs to the functions arguments.\n * @param {?function(this:void, ...): RESULT|undefined} onSuccess\n * @return {!Promise.<RESULT>} returns a new promise with the output of the onSuccess or\n *     onFail handler\n * @template RESULT\n */\nPromise.prototype.spread = function (onSuccess) {\n  return this.then(allInternal)\n  .then(function (array) {\n    return onSuccess.apply(null, array)\n  })\n}\n\n/**\n * Spread a promises outputs to the functions arguments.\n * @param {function(this:SCOPE, ...): RESULT} onSuccess\n * @param {SCOPE} scope Object whose context callback will be executed in.\n * @param {...*} var_args Additional arguments to be passed to the promise callback.\n * @return {!Promise.<RESULT>} returns a new promise with the output of the onSuccess\n * @template SCOPE, RESULT\n */\nPromise.prototype.spreadBound = function (onSuccess, scope, var_args) {\n  var args = Array.prototype.slice.call(arguments, 2)\n  return this.then(allInternal)\n  .then(function (array) {\n    return onSuccess.apply(scope, args.concat(array))\n  })\n}\n\n/**\n * Provide a callback to be called whenever this promise is either resolved\n * or rejected.\n *\n * @param {function()} onComplete\n * @return {!Promise.<T>} returns the current promise\n */\nPromise.prototype.fin = function (onComplete) {\n  if (this._hasData || this._error) {\n    onComplete()\n    return this\n  }\n\n  if (this._child) {\n    this._child.fin(onComplete)\n  } else {\n    if (!this._onComplete) this._onComplete = [onComplete]\n    else this._onComplete.push(onComplete)\n  }\n\n  return this\n}\n\n/**\n * Mark this promise as \"ended\". If the promise is rejected, this will throw an\n * error in whatever scope it happens to be in\n *\n * @return {!Promise.<T>} returns the current promise\n * @deprecated Prefer done(), because it's consistent with Q.\n */\nPromise.prototype.end = function () {\n  this._end()\n  return this\n}\n\n\n/**\n * Mark this promise as \"ended\".\n * @private\n */\nPromise.prototype._end = function () {\n  if (this._error) {\n    this._handleError()\n    throw this._error\n  }\n  this._ended = true\n  return this\n}\n\n/**\n * Close the promise. Any errors after this completes will be thrown to the global handler.\n *\n * @param {?function(this:void, T, ?)=} onSuccess a function to handle successful\n *     resolution of this promise\n * @param {?function(this:void, !Error, ?)=} onFailure a function to handle failed\n *     resolution of this promise\n * @return {void}\n */\nPromise.prototype.done = function (onSuccess, onFailure) {\n  var self = this\n  if (onSuccess || onFailure) {\n    self = self.then(onSuccess, onFailure)\n  }\n  self._end()\n}\n\n/**\n * Return a new promise that behaves the same as the current promise except\n * that it will be rejected if the current promise does not get fulfilled\n * after a certain amount of time.\n *\n * @param {number} timeoutMs The timeout threshold in msec\n * @param {string=} timeoutMsg error message\n * @return {!Promise.<T>} a new promise with timeout\n */\n Promise.prototype.timeout = function (timeoutMs, timeoutMsg) {\n  var deferred = new Promise()\n  var isTimeout = false\n\n  var timeout = setTimeout(function() {\n    deferred.reject(new Error(timeoutMsg || 'Promise timeout after ' + timeoutMs + ' ms.'))\n    isTimeout = true\n  }, timeoutMs)\n\n  this.then(function (data) {\n    if (!isTimeout) {\n      clearTimeout(timeout)\n      deferred.resolve(data)\n    }\n  },\n  function (err) {\n    if (!isTimeout) {\n      clearTimeout(timeout)\n      deferred.reject(err)\n    }\n  })\n\n  return deferred.promise\n}\n\n/**\n * Attempt to resolve this promise with the specified input\n *\n * @param {*} data the input\n */\nPromise.prototype._withInput = function (data) {\n  if (this._successFn) {\n    this._nextTick(this._successFn, [data, this._currentContext])\n  } else {\n    this.resolve(data)\n  }\n\n  // context is no longer needed\n  delete this._currentContext\n}\n\n/**\n * Attempt to reject this promise with the specified error\n *\n * @param {!Error} e\n * @private\n */\nPromise.prototype._withError = function (e) {\n  if (this._failFn) {\n    this._nextTick(this._failFn, [e, this._currentContext])\n  } else {\n    this.reject(e)\n  }\n\n  // context is no longer needed\n  delete this._currentContext\n}\n\n/**\n * Calls a function in the correct scope, and includes bound arguments.\n * @param {Function} fn\n * @param {Array} args\n * @private\n */\nPromise.prototype._nextTick = function (fn, args) {\n  if (this._boundArgs) {\n    args = this._boundArgs.concat(args)\n  }\n  nextTick(nextTickCallback.bind(null, this, fn, this._scope, args))\n}\n\n/**\n * Chain a promise to the current promise\n *\n * @param {!Promise} promise the promise to chain\n * @private\n */\nPromise.prototype._chainPromise = function (promise) {\n  var i\n  if (this._hasContext) promise._useContext(this._nextContext)\n\n  if (this._child) {\n    this._child._chainPromise(promise)\n  } else if (this._hasData) {\n    promise._withInput(this._data)\n  } else if (this._error) {\n    // We can't rely on _withError() because it's called on the chained promises\n    // and we need to use the source's _errorHandled state\n    this._handleError()\n    promise._withError(this._error)\n  } else if (!this._promises) {\n    this._promises = [promise]\n  } else {\n    this._promises.push(promise)\n  }\n}\n\n/**\n * Utility function used for creating a node-style resolver\n * for deferreds\n *\n * @param {!Promise} deferred a promise that looks like a deferred\n * @param {Error=} err an optional error\n * @param {*=} data optional data\n */\nfunction resolver(deferred, err, data) {\n  if (err) deferred.reject(err)\n  else deferred.resolve(data)\n}\n\n/**\n * Creates a node-style resolver for a deferred by wrapping\n * resolver()\n *\n * @return {function(?Error, *)} node-style callback\n */\nPromise.prototype.makeNodeResolver = function () {\n  return resolver.bind(null, this)\n}\n\n/**\n * Return true iff the given object is a promise of this library.\n *\n * Because kew's API is slightly different than other promise libraries,\n * it's important that we have a test for its promise type. If you want\n * to test for a more general A+ promise, you should do a cap test for\n * the features you want.\n *\n * @param {*} obj The object to test\n * @return {boolean} Whether the object is a promise\n */\nfunction isPromise(obj) {\n  return !!obj._isPromise\n}\n\n/**\n * Return true iff the given object is a promise-like object, e.g. appears to\n * implement Promises/A+ specification\n *\n * @param {*} obj The object to test\n * @return {boolean} Whether the object is a promise-like object\n */\nfunction isPromiseLike(obj) {\n  return (typeof obj === 'object' || typeof obj === 'function') &&\n    typeof obj.then === 'function'\n}\n\n/**\n * Static function which creates and resolves a promise immediately\n *\n * @param {T} data data to resolve the promise with\n * @return {!Promise.<T>}\n * @template T\n */\nfunction resolve(data) {\n  var promise = new Promise()\n  promise.resolve(data)\n  return promise\n}\n\n/**\n * Static function which creates and rejects a promise immediately\n *\n * @param {!Error} e error to reject the promise with\n * @return {!Promise}\n */\nfunction reject(e) {\n  var promise = new Promise()\n  promise.reject(e)\n  return promise\n}\n\n/**\n * Replace an element in an array with a new value. Used by .all() to\n * call from .then()\n *\n * @param {!Array} arr\n * @param {number} idx\n * @param {*} val\n * @return {*} the val that's being injected into the array\n */\nfunction replaceEl(arr, idx, val) {\n  arr[idx] = val\n  return val\n}\n\n/**\n * Replace an element in an array as it is resolved with its value.\n * Used by .allSettled().\n *\n * @param {!Array} arr\n * @param {number} idx\n * @param {*} value The value from a resolved promise.\n * @return {*} the data that's being passed in\n */\nfunction replaceElFulfilled(arr, idx, value) {\n  arr[idx] = {\n    state: 'fulfilled',\n    value: value\n  }\n  return value\n}\n\n/**\n * Replace an element in an array as it is rejected with the reason.\n * Used by .allSettled().\n *\n * @param {!Array} arr\n * @param {number} idx\n * @param {*} reason The reason why the original promise is rejected\n * @return {*} the data that's being passed in\n */\nfunction replaceElRejected(arr, idx, reason) {\n  arr[idx] = {\n    state: 'rejected',\n    reason: reason\n  }\n  return reason\n}\n\n/**\n * Takes in an array of promises or literals and returns a promise which returns\n * an array of values when all have resolved. If any fail, the promise fails.\n *\n * @param {!Array.<!Promise>} promises\n * @return {!Promise.<!Array>}\n */\nfunction all(promises) {\n  if (arguments.length != 1 || !Array.isArray(promises)) {\n    promises = Array.prototype.slice.call(arguments, 0)\n  }\n  return allInternal(promises)\n}\n\n/**\n * A version of all() that does not accept var_args\n *\n * @param {!Array.<!Promise>} promises\n * @return {!Promise.<!Array>}\n */\nfunction allInternal(promises) {\n  if (!promises.length) return resolve([])\n\n  var outputs = []\n  var finished = false\n  var promise = new Promise()\n  var counter = promises.length\n\n  for (var i = 0; i < promises.length; i += 1) {\n    if (!promises[i] || !isPromiseLike(promises[i])) {\n      outputs[i] = promises[i]\n      counter -= 1\n    } else {\n      promises[i].then(replaceEl.bind(null, outputs, i))\n      .then(function decrementAllCounter() {\n        counter--\n        if (!finished && counter === 0) {\n          finished = true\n          promise.resolve(outputs)\n        }\n      }, function onAllError(e) {\n        if (!finished) {\n          finished = true\n          promise.reject(e)\n        }\n      })\n    }\n  }\n\n  if (counter === 0 && !finished) {\n    finished = true\n    promise.resolve(outputs)\n  }\n\n  return promise\n}\n\n/**\n * Takes in an array of promises or values and returns a promise that is\n * fulfilled with an array of state objects when all have resolved or\n * rejected. If a promise is resolved, its corresponding state object is\n * {state: 'fulfilled', value: Object}; whereas if a promise is rejected, its\n * corresponding state object is {state: 'rejected', reason: Object}.\n *\n * @param {!Array} promises or values\n * @return {!Promise.<!Array>} Promise fulfilled with state objects for each input\n */\nfunction allSettled(promises) {\n  if (!Array.isArray(promises)) {\n    throw Error('The input to \"allSettled()\" should be an array of Promise or values')\n  }\n  if (!promises.length) return resolve([])\n\n  var outputs = []\n  var promise = new Promise()\n  var counter = promises.length\n\n  for (var i = 0; i < promises.length; i += 1) {\n    if (!promises[i] || !isPromiseLike(promises[i])) {\n      replaceElFulfilled(outputs, i, promises[i])\n      if ((--counter) === 0) promise.resolve(outputs)\n    } else {\n      promises[i]\n        .then(replaceElFulfilled.bind(null, outputs, i), replaceElRejected.bind(null, outputs, i))\n        .then(function () {\n          if ((--counter) === 0) promise.resolve(outputs)\n        })\n    }\n  }\n\n  return promise\n}\n\n/**\n * Takes an array of results and spreads them to the arguments of a function.\n * @param {!Array} array\n * @param {!Function} fn\n */\nfunction spread(array, fn) {\n  resolve(array).spread(fn)\n}\n\n/**\n * Create a new Promise which looks like a deferred\n *\n * @return {!Promise}\n */\nfunction defer() {\n  return new Promise()\n}\n\n/**\n * Return a promise which will wait a specified number of ms to resolve\n *\n * @param {*} delayMsOrVal A delay (in ms) if this takes one argument, or ther\n *     return value if it takes two.\n * @param {number=} opt_delayMs\n * @return {!Promise}\n */\nfunction delay(delayMsOrVal, opt_delayMs) {\n  var returnVal = undefined\n  var delayMs = delayMsOrVal\n  if (typeof opt_delayMs != 'undefined') {\n    delayMs = opt_delayMs\n    returnVal = delayMsOrVal\n  }\n\n  if (typeof delayMs != 'number') {\n    throw new Error('Bad delay value ' + delayMs)\n  }\n\n  var defer = new Promise()\n  setTimeout(function onDelay() {\n    defer.resolve(returnVal)\n  }, delayMs)\n  return defer\n}\n\n/**\n * Returns a promise that has the same result as `this`, but fulfilled\n * after at least ms milliseconds\n * @param {number} ms\n */\nPromise.prototype.delay = function (ms) {\n  return this.then(function (val) {\n    return delay(val, ms)\n  })\n}\n\n/**\n * Return a promise which will evaluate the function fn in a future turn with\n * the provided args\n *\n * @param {function(...)} fn\n * @param {...*} var_args a variable number of arguments\n * @return {!Promise}\n */\nfunction fcall(fn, var_args) {\n  var rootArgs = Array.prototype.slice.call(arguments, 1)\n  var defer = new Promise()\n  nextTick(nextTickCallback.bind(null, defer, fn, undefined, rootArgs))\n  return defer\n}\n\n\n/**\n * Returns a promise that will be invoked with the result of a node style\n * callback. All args to fn should be given except for the final callback arg\n *\n * @param {function(...)} fn\n * @param {...*} var_args a variable number of arguments\n * @return {!Promise}\n */\nfunction nfcall(fn, var_args) {\n  // Insert an undefined argument for scope and let bindPromise() do the work.\n  var args = Array.prototype.slice.call(arguments, 0)\n  args.splice(1, 0, undefined)\n  return ncall.apply(undefined, args)\n}\n\n\n/**\n * Like `nfcall`, but permits passing a `this` context for the call.\n *\n * @param {function(...)} fn\n * @param {Object} scope\n * @param {...*} var_args\n * @return {!Promise}\n */\nfunction ncall(fn, scope, var_args) {\n  return bindPromise.apply(null, arguments)()\n}\n\n\n/**\n * Binds a function to a scope with an optional number of curried arguments. Attaches\n * a node style callback as the last argument and returns a promise\n *\n * @param {function(...)} fn\n * @param {Object} scope\n * @param {...*} var_args a variable number of arguments\n * @return {function(...)}: !Promise}\n */\nfunction bindPromise(fn, scope, var_args) {\n  var rootArgs = Array.prototype.slice.call(arguments, 2)\n  return function onBoundPromise(var_args) {\n    var defer = new Promise()\n    try {\n      fn.apply(scope, rootArgs.concat(Array.prototype.slice.call(arguments, 0), defer.makeNodeResolver()))\n    } catch (e) {\n      defer.reject(e)\n    }\n    return defer\n  }\n}\n\nmodule.exports = {\n  all: all,\n  bindPromise: bindPromise,\n  defer: defer,\n  delay: delay,\n  fcall: fcall,\n  isPromise: isPromise,\n  isPromiseLike: isPromiseLike,\n  ncall: ncall,\n  nfcall: nfcall,\n  resolve: resolve,\n  reject: reject,\n  spread: spread,\n  stats: stats,\n  allSettled: allSettled,\n  Promise: Promise,\n  getNextTickFunction: getNextTickFunction,\n  setNextTickFunction: setNextTickFunction,\n}\n\n}).call(this,require('_process'))\n\n},{\"_process\":1}],9:[function(require,module,exports){\nmodule.exports = function(array) {\n\n\treturn array[Math.floor(Math.random()*array.length)];\n};\n},{}],10:[function(require,module,exports){\n/*jslint onevar:true, undef:true, newcap:true, regexp:true, bitwise:true, maxerr:50, indent:4, white:false, nomen:false, plusplus:false */\n/*global define:false, require:false, exports:false, module:false, signals:false */\n\n/** @license\n * JS Signals <http://millermedeiros.github.com/js-signals/>\n * Released under the MIT license\n * Author: Miller Medeiros\n * Version: 1.0.0 - Build: 268 (2012/11/29 05:48 PM)\n */\n\n(function(global){\n\n    // SignalBinding -------------------------------------------------\n    //================================================================\n\n    /**\n     * Object that represents a binding between a Signal and a listener function.\n     * <br />- <strong>This is an internal constructor and shouldn't be called by regular users.</strong>\n     * <br />- inspired by Joa Ebert AS3 SignalBinding and Robert Penner's Slot classes.\n     * @author Miller Medeiros\n     * @constructor\n     * @internal\n     * @name SignalBinding\n     * @param {Signal} signal Reference to Signal object that listener is currently bound to.\n     * @param {Function} listener Handler function bound to the signal.\n     * @param {boolean} isOnce If binding should be executed just once.\n     * @param {Object} [listenerContext] Context on which listener will be executed (object that should represent the `this` variable inside listener function).\n     * @param {Number} [priority] The priority level of the event listener. (default = 0).\n     */\n    function SignalBinding(signal, listener, isOnce, listenerContext, priority) {\n\n        /**\n         * Handler function bound to the signal.\n         * @type Function\n         * @private\n         */\n        this._listener = listener;\n\n        /**\n         * If binding should be executed just once.\n         * @type boolean\n         * @private\n         */\n        this._isOnce = isOnce;\n\n        /**\n         * Context on which listener will be executed (object that should represent the `this` variable inside listener function).\n         * @memberOf SignalBinding.prototype\n         * @name context\n         * @type Object|undefined|null\n         */\n        this.context = listenerContext;\n\n        /**\n         * Reference to Signal object that listener is currently bound to.\n         * @type Signal\n         * @private\n         */\n        this._signal = signal;\n\n        /**\n         * Listener priority\n         * @type Number\n         * @private\n         */\n        this._priority = priority || 0;\n    }\n\n    SignalBinding.prototype = {\n\n        /**\n         * If binding is active and should be executed.\n         * @type boolean\n         */\n        active : true,\n\n        /**\n         * Default parameters passed to listener during `Signal.dispatch` and `SignalBinding.execute`. (curried parameters)\n         * @type Array|null\n         */\n        params : null,\n\n        /**\n         * Call listener passing arbitrary parameters.\n         * <p>If binding was added using `Signal.addOnce()` it will be automatically removed from signal dispatch queue, this method is used internally for the signal dispatch.</p>\n         * @param {Array} [paramsArr] Array of parameters that should be passed to the listener\n         * @return {*} Value returned by the listener.\n         */\n        execute : function (paramsArr) {\n            var handlerReturn, params;\n            if (this.active && !!this._listener) {\n                params = this.params? this.params.concat(paramsArr) : paramsArr;\n                handlerReturn = this._listener.apply(this.context, params);\n                if (this._isOnce) {\n                    this.detach();\n                }\n            }\n            return handlerReturn;\n        },\n\n        /**\n         * Detach binding from signal.\n         * - alias to: mySignal.remove(myBinding.getListener());\n         * @return {Function|null} Handler function bound to the signal or `null` if binding was previously detached.\n         */\n        detach : function () {\n            return this.isBound()? this._signal.remove(this._listener, this.context) : null;\n        },\n\n        /**\n         * @return {Boolean} `true` if binding is still bound to the signal and have a listener.\n         */\n        isBound : function () {\n            return (!!this._signal && !!this._listener);\n        },\n\n        /**\n         * @return {boolean} If SignalBinding will only be executed once.\n         */\n        isOnce : function () {\n            return this._isOnce;\n        },\n\n        /**\n         * @return {Function} Handler function bound to the signal.\n         */\n        getListener : function () {\n            return this._listener;\n        },\n\n        /**\n         * @return {Signal} Signal that listener is currently bound to.\n         */\n        getSignal : function () {\n            return this._signal;\n        },\n\n        /**\n         * Delete instance properties\n         * @private\n         */\n        _destroy : function () {\n            delete this._signal;\n            delete this._listener;\n            delete this.context;\n        },\n\n        /**\n         * @return {string} String representation of the object.\n         */\n        toString : function () {\n            return '[SignalBinding isOnce:' + this._isOnce +', isBound:'+ this.isBound() +', active:' + this.active + ']';\n        }\n\n    };\n\n\n/*global SignalBinding:false*/\n\n    // Signal --------------------------------------------------------\n    //================================================================\n\n    function validateListener(listener, fnName) {\n        if (typeof listener !== 'function') {\n            throw new Error( 'listener is a required param of {fn}() and should be a Function.'.replace('{fn}', fnName) );\n        }\n    }\n\n    /**\n     * Custom event broadcaster\n     * <br />- inspired by Robert Penner's AS3 Signals.\n     * @name Signal\n     * @author Miller Medeiros\n     * @constructor\n     */\n    function Signal() {\n        /**\n         * @type Array.<SignalBinding>\n         * @private\n         */\n        this._bindings = [];\n        this._prevParams = null;\n\n        // enforce dispatch to aways work on same context (#47)\n        var self = this;\n        this.dispatch = function(){\n            Signal.prototype.dispatch.apply(self, arguments);\n        };\n    }\n\n    Signal.prototype = {\n\n        /**\n         * Signals Version Number\n         * @type String\n         * @const\n         */\n        VERSION : '1.0.0',\n\n        /**\n         * If Signal should keep record of previously dispatched parameters and\n         * automatically execute listener during `add()`/`addOnce()` if Signal was\n         * already dispatched before.\n         * @type boolean\n         */\n        memorize : false,\n\n        /**\n         * @type boolean\n         * @private\n         */\n        _shouldPropagate : true,\n\n        /**\n         * If Signal is active and should broadcast events.\n         * <p><strong>IMPORTANT:</strong> Setting this property during a dispatch will only affect the next dispatch, if you want to stop the propagation of a signal use `halt()` instead.</p>\n         * @type boolean\n         */\n        active : true,\n\n        /**\n         * @param {Function} listener\n         * @param {boolean} isOnce\n         * @param {Object} [listenerContext]\n         * @param {Number} [priority]\n         * @return {SignalBinding}\n         * @private\n         */\n        _registerListener : function (listener, isOnce, listenerContext, priority) {\n\n            var prevIndex = this._indexOfListener(listener, listenerContext),\n                binding;\n\n            if (prevIndex !== -1) {\n                binding = this._bindings[prevIndex];\n                if (binding.isOnce() !== isOnce) {\n                    throw new Error('You cannot add'+ (isOnce? '' : 'Once') +'() then add'+ (!isOnce? '' : 'Once') +'() the same listener without removing the relationship first.');\n                }\n            } else {\n                binding = new SignalBinding(this, listener, isOnce, listenerContext, priority);\n                this._addBinding(binding);\n            }\n\n            if(this.memorize && this._prevParams){\n                binding.execute(this._prevParams);\n            }\n\n            return binding;\n        },\n\n        /**\n         * @param {SignalBinding} binding\n         * @private\n         */\n        _addBinding : function (binding) {\n            //simplified insertion sort\n            var n = this._bindings.length;\n            do { --n; } while (this._bindings[n] && binding._priority <= this._bindings[n]._priority);\n            this._bindings.splice(n + 1, 0, binding);\n        },\n\n        /**\n         * @param {Function} listener\n         * @return {number}\n         * @private\n         */\n        _indexOfListener : function (listener, context) {\n            var n = this._bindings.length,\n                cur;\n            while (n--) {\n                cur = this._bindings[n];\n                if (cur._listener === listener && cur.context === context) {\n                    return n;\n                }\n            }\n            return -1;\n        },\n\n        /**\n         * Check if listener was attached to Signal.\n         * @param {Function} listener\n         * @param {Object} [context]\n         * @return {boolean} if Signal has the specified listener.\n         */\n        has : function (listener, context) {\n            return this._indexOfListener(listener, context) !== -1;\n        },\n\n        /**\n         * Add a listener to the signal.\n         * @param {Function} listener Signal handler function.\n         * @param {Object} [listenerContext] Context on which listener will be executed (object that should represent the `this` variable inside listener function).\n         * @param {Number} [priority] The priority level of the event listener. Listeners with higher priority will be executed before listeners with lower priority. Listeners with same priority level will be executed at the same order as they were added. (default = 0)\n         * @return {SignalBinding} An Object representing the binding between the Signal and listener.\n         */\n        add : function (listener, listenerContext, priority) {\n            validateListener(listener, 'add');\n            return this._registerListener(listener, false, listenerContext, priority);\n        },\n\n        /**\n         * Add listener to the signal that should be removed after first execution (will be executed only once).\n         * @param {Function} listener Signal handler function.\n         * @param {Object} [listenerContext] Context on which listener will be executed (object that should represent the `this` variable inside listener function).\n         * @param {Number} [priority] The priority level of the event listener. Listeners with higher priority will be executed before listeners with lower priority. Listeners with same priority level will be executed at the same order as they were added. (default = 0)\n         * @return {SignalBinding} An Object representing the binding between the Signal and listener.\n         */\n        addOnce : function (listener, listenerContext, priority) {\n            validateListener(listener, 'addOnce');\n            return this._registerListener(listener, true, listenerContext, priority);\n        },\n\n        /**\n         * Remove a single listener from the dispatch queue.\n         * @param {Function} listener Handler function that should be removed.\n         * @param {Object} [context] Execution context (since you can add the same handler multiple times if executing in a different context).\n         * @return {Function} Listener handler function.\n         */\n        remove : function (listener, context) {\n            validateListener(listener, 'remove');\n\n            var i = this._indexOfListener(listener, context);\n            if (i !== -1) {\n                this._bindings[i]._destroy(); //no reason to a SignalBinding exist if it isn't attached to a signal\n                this._bindings.splice(i, 1);\n            }\n            return listener;\n        },\n\n        /**\n         * Remove all listeners from the Signal.\n         */\n        removeAll : function () {\n            var n = this._bindings.length;\n            while (n--) {\n                this._bindings[n]._destroy();\n            }\n            this._bindings.length = 0;\n        },\n\n        /**\n         * @return {number} Number of listeners attached to the Signal.\n         */\n        getNumListeners : function () {\n            return this._bindings.length;\n        },\n\n        /**\n         * Stop propagation of the event, blocking the dispatch to next listeners on the queue.\n         * <p><strong>IMPORTANT:</strong> should be called only during signal dispatch, calling it before/after dispatch won't affect signal broadcast.</p>\n         * @see Signal.prototype.disable\n         */\n        halt : function () {\n            this._shouldPropagate = false;\n        },\n\n        /**\n         * Dispatch/Broadcast Signal to all listeners added to the queue.\n         * @param {...*} [params] Parameters that should be passed to each handler.\n         */\n        dispatch : function (params) {\n            if (! this.active) {\n                return;\n            }\n\n            var paramsArr = Array.prototype.slice.call(arguments),\n                n = this._bindings.length,\n                bindings;\n\n            if (this.memorize) {\n                this._prevParams = paramsArr;\n            }\n\n            if (! n) {\n                //should come after memorize\n                return;\n            }\n\n            bindings = this._bindings.slice(); //clone array in case add/remove items during dispatch\n            this._shouldPropagate = true; //in case `halt` was called before dispatch or during the previous dispatch.\n\n            //execute all callbacks until end of the list or until a callback returns `false` or stops propagation\n            //reverse loop since listeners with higher priority will be added at the end of the list\n            do { n--; } while (bindings[n] && this._shouldPropagate && bindings[n].execute(paramsArr) !== false);\n        },\n\n        /**\n         * Forget memorized arguments.\n         * @see Signal.memorize\n         */\n        forget : function(){\n            this._prevParams = null;\n        },\n\n        /**\n         * Remove all bindings from signal and destroy any reference to external objects (destroy Signal object).\n         * <p><strong>IMPORTANT:</strong> calling any method on the signal instance after calling dispose will throw errors.</p>\n         */\n        dispose : function () {\n            this.removeAll();\n            delete this._bindings;\n            delete this._prevParams;\n        },\n\n        /**\n         * @return {string} String representation of the object.\n         */\n        toString : function () {\n            return '[Signal active:'+ this.active +' numListeners:'+ this.getNumListeners() +']';\n        }\n\n    };\n\n\n    // Namespace -----------------------------------------------------\n    //================================================================\n\n    /**\n     * Signals namespace\n     * @namespace\n     * @name signals\n     */\n    var signals = Signal;\n\n    /**\n     * Custom event broadcaster\n     * @see Signal\n     */\n    // alias for backwards compatibility (see #gh-44)\n    signals.Signal = Signal;\n\n\n\n    //exports to multiple environments\n    if(typeof define === 'function' && define.amd){ //AMD\n        define(function () { return signals; });\n    } else if (typeof module !== 'undefined' && module.exports){ //node\n        module.exports = signals;\n    } else { //browser\n        //use string because of Google closure compiler ADVANCED_MODE\n        /*jslint sub:true */\n        global['signals'] = signals;\n    }\n\n}(this));\n\n},{}],11:[function(require,module,exports){\nvar els = {\n\tplayer : document.getElementsByClassName('text--player')[0],\n\tgeneral : document.getElementsByClassName('text--general')[0],\n\tai : document.getElementsByClassName('text--ai')[0]\n};\n\nmodule.exports = function(classPostFix, text) {\n\n\tels[classPostFix].innerHTML = text;\n};\n},{}]},{},[7])\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvcHJvY2Vzcy9icm93c2VyLmpzIiwic3JjL2Fzc2V0cy9zY3JpcHRzL2NvcmUvTW92ZS5qcyIsInNyYy9hc3NldHMvc2NyaXB0cy9jb3JlL1BsYXllci5qcyIsInNyYy9hc3NldHMvc2NyaXB0cy9jb3JlL2FjdGlvbkhhbmRsZXIuanMiLCJzcmMvYXNzZXRzL3NjcmlwdHMvY29yZS9jb25zdGFudHMuanMiLCJzcmMvYXNzZXRzL3NjcmlwdHMvY29yZS9zaWduYWxCdXMuanMiLCJzcmMvYXNzZXRzL3NjcmlwdHMvbWFpbi5qcyIsInNyYy9hc3NldHMvc2NyaXB0cy91dGlscy9rZXcuanMiLCJzcmMvYXNzZXRzL3NjcmlwdHMvdXRpbHMvc2FtcGxlQXJyYXkuanMiLCJzcmMvYXNzZXRzL3NjcmlwdHMvdXRpbHMvc2lnbmFscy5qcyIsInNyYy9hc3NldHMvc2NyaXB0cy91dGlscy93cml0ZUluRGl2LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNiQTtBQUNBO0FBQ0E7O0FDRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDakdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQzUxQkE7QUFDQTtBQUNBO0FBQ0E7O0FDSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3YkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiLy8gc2hpbSBmb3IgdXNpbmcgcHJvY2VzcyBpbiBicm93c2VyXG5cbnZhciBwcm9jZXNzID0gbW9kdWxlLmV4cG9ydHMgPSB7fTtcbnZhciBxdWV1ZSA9IFtdO1xudmFyIGRyYWluaW5nID0gZmFsc2U7XG52YXIgY3VycmVudFF1ZXVlO1xudmFyIHF1ZXVlSW5kZXggPSAtMTtcblxuZnVuY3Rpb24gY2xlYW5VcE5leHRUaWNrKCkge1xuICAgIGRyYWluaW5nID0gZmFsc2U7XG4gICAgaWYgKGN1cnJlbnRRdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgcXVldWUgPSBjdXJyZW50UXVldWUuY29uY2F0KHF1ZXVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBxdWV1ZUluZGV4ID0gLTE7XG4gICAgfVxuICAgIGlmIChxdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgZHJhaW5RdWV1ZSgpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZHJhaW5RdWV1ZSgpIHtcbiAgICBpZiAoZHJhaW5pbmcpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgdGltZW91dCA9IHNldFRpbWVvdXQoY2xlYW5VcE5leHRUaWNrKTtcbiAgICBkcmFpbmluZyA9IHRydWU7XG5cbiAgICB2YXIgbGVuID0gcXVldWUubGVuZ3RoO1xuICAgIHdoaWxlKGxlbikge1xuICAgICAgICBjdXJyZW50UXVldWUgPSBxdWV1ZTtcbiAgICAgICAgcXVldWUgPSBbXTtcbiAgICAgICAgd2hpbGUgKCsrcXVldWVJbmRleCA8IGxlbikge1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRRdWV1ZSkge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRRdWV1ZVtxdWV1ZUluZGV4XS5ydW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBxdWV1ZUluZGV4ID0gLTE7XG4gICAgICAgIGxlbiA9IHF1ZXVlLmxlbmd0aDtcbiAgICB9XG4gICAgY3VycmVudFF1ZXVlID0gbnVsbDtcbiAgICBkcmFpbmluZyA9IGZhbHNlO1xuICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTtcbn1cblxucHJvY2Vzcy5uZXh0VGljayA9IGZ1bmN0aW9uIChmdW4pIHtcbiAgICB2YXIgYXJncyA9IG5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoIC0gMSk7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBhcmdzW2kgLSAxXSA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBxdWV1ZS5wdXNoKG5ldyBJdGVtKGZ1biwgYXJncykpO1xuICAgIGlmIChxdWV1ZS5sZW5ndGggPT09IDEgJiYgIWRyYWluaW5nKSB7XG4gICAgICAgIHNldFRpbWVvdXQoZHJhaW5RdWV1ZSwgMCk7XG4gICAgfVxufTtcblxuLy8gdjggbGlrZXMgcHJlZGljdGlibGUgb2JqZWN0c1xuZnVuY3Rpb24gSXRlbShmdW4sIGFycmF5KSB7XG4gICAgdGhpcy5mdW4gPSBmdW47XG4gICAgdGhpcy5hcnJheSA9IGFycmF5O1xufVxuSXRlbS5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZnVuLmFwcGx5KG51bGwsIHRoaXMuYXJyYXkpO1xufTtcbnByb2Nlc3MudGl0bGUgPSAnYnJvd3Nlcic7XG5wcm9jZXNzLmJyb3dzZXIgPSB0cnVlO1xucHJvY2Vzcy5lbnYgPSB7fTtcbnByb2Nlc3MuYXJndiA9IFtdO1xucHJvY2Vzcy52ZXJzaW9uID0gJyc7IC8vIGVtcHR5IHN0cmluZyB0byBhdm9pZCByZWdleHAgaXNzdWVzXG5wcm9jZXNzLnZlcnNpb25zID0ge307XG5cbmZ1bmN0aW9uIG5vb3AoKSB7fVxuXG5wcm9jZXNzLm9uID0gbm9vcDtcbnByb2Nlc3MuYWRkTGlzdGVuZXIgPSBub29wO1xucHJvY2Vzcy5vbmNlID0gbm9vcDtcbnByb2Nlc3Mub2ZmID0gbm9vcDtcbnByb2Nlc3MucmVtb3ZlTGlzdGVuZXIgPSBub29wO1xucHJvY2Vzcy5yZW1vdmVBbGxMaXN0ZW5lcnMgPSBub29wO1xucHJvY2Vzcy5lbWl0ID0gbm9vcDtcblxucHJvY2Vzcy5iaW5kaW5nID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuYmluZGluZyBpcyBub3Qgc3VwcG9ydGVkJyk7XG59O1xuXG5wcm9jZXNzLmN3ZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICcvJyB9O1xucHJvY2Vzcy5jaGRpciA9IGZ1bmN0aW9uIChkaXIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuY2hkaXIgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcbnByb2Nlc3MudW1hc2sgPSBmdW5jdGlvbigpIHsgcmV0dXJuIDA7IH07XG4iLCJ2YXIgUSA9IHJlcXVpcmUoJy4uL3V0aWxzL2tldycpLFxuXHRTaWduYWwgPSByZXF1aXJlKCcuLi91dGlscy9zaWduYWxzJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYWN0aW9uLCBkZWxheSwgaGFzTG9ncykge1xuXG5cdHZhciBTVEFURV9UT09fU09PTiA9IDAsXG5cdFx0U1RBVEVfT05fVElNRSA9IDE7XG5cblx0dmFyIF90aW1lcixcblx0XHRfZGVmZXJyZWQsXG5cdFx0X3N0YXRlSXNPblRpbWVTaWduYWwgPSBuZXcgU2lnbmFsKCksXG5cdFx0X2N1cnJlbnRTdGF0ZSA9IFNUQVRFX1RPT19TT09OLFxuXHRcdF9yZXF1ZXN0ZWRBY3Rpb24gPSBhY3Rpb24sXG5cdFx0X2RlbGF5ID0gZGVsYXk7XG5cblxuXHRmdW5jdGlvbiBleGVjdXRlKCkge1xuXG5cdFx0X2RlZmVycmVkID0gUS5kZWZlcigpO1xuXG5cdFx0c3RhcnRUaW1lcihfZGVsYXksIG9uRGVsYXlGaW5pc2hlZCk7XG5cblx0XHRyZXR1cm4gX2RlZmVycmVkLnByb21pc2U7XG5cdH1cblxuXHRmdW5jdGlvbiBvbkRlbGF5RmluaXNoZWQoKSB7XG5cblx0XHRfY3VycmVudFN0YXRlID0gU1RBVEVfT05fVElNRTtcblx0XHRfc3RhdGVJc09uVGltZVNpZ25hbC5kaXNwYXRjaChfcmVxdWVzdGVkQWN0aW9uKTtcblx0fVxuXG5cdGZ1bmN0aW9uIGZpcmVBY3Rpb24oZmlyZWRBY3Rpb24pIHtcblxuXHRcdGtpbGxUaW1lcigpO1xuXG5cdFx0aWYoX2N1cnJlbnRTdGF0ZSA9PT0gU1RBVEVfVE9PX1NPT04pIHtcblxuXHRcdFx0X2RlZmVycmVkLnJlamVjdCgndG9vIHNvb24hJyk7XG5cblx0XHR9IGVsc2UgaWYoZmlyZWRBY3Rpb24gIT09IF9yZXF1ZXN0ZWRBY3Rpb24pIHtcblxuXHRcdFx0X2RlZmVycmVkLnJlamVjdCgnd3JvbmcgYWN0aW9uIScpO1xuXG5cdFx0fSBlbHNlIHtcblxuXHRcdFx0X2RlZmVycmVkLnJlc29sdmUoJ3N1Y2Nlc3MhJyk7XG5cdFx0fVxuXHR9XG5cblx0ZnVuY3Rpb24gZ2V0UmVxdWVzdGVkQWN0aW9uKCkge1xuXG5cdFx0cmV0dXJuIF9yZXF1ZXN0ZWRBY3Rpb247XG5cdH1cblxuXHRmdW5jdGlvbiBkZXN0cm95KCkge1xuXG5cdFx0a2lsbFRpbWVyKCk7XG5cdH1cblxuXHRmdW5jdGlvbiBraWxsVGltZXIoKSB7XG5cblx0XHRjbGVhclRpbWVvdXQoX3RpbWVyKTtcblx0fVxuXG5cdGZ1bmN0aW9uIHN0YXJ0VGltZXIoZGVsYXksIGNhbGxiYWNrKSB7XG5cblx0XHRfdGltZXIgPSBzZXRUaW1lb3V0KGNhbGxiYWNrLCBkZWxheSk7XG5cdH1cblxuXHR0aGlzLnN0YXRlSXNPblRpbWVTaWduYWwgPSBfc3RhdGVJc09uVGltZVNpZ25hbDtcblx0dGhpcy5nZXRSZXF1ZXN0ZWRBY3Rpb24gPSBnZXRSZXF1ZXN0ZWRBY3Rpb247XG5cdHRoaXMuZmlyZUFjdGlvbiA9IGZpcmVBY3Rpb247XG5cdHRoaXMuZXhlY3V0ZSA9IGV4ZWN1dGU7XG5cdHRoaXMuZGVzdHJveSA9IGRlc3Ryb3k7XG59OyIsInZhciBRID0gcmVxdWlyZSgnLi4vdXRpbHMva2V3JyksXG5cdHdyaXRlSW5EaXYgPSByZXF1aXJlKCcuLi91dGlscy93cml0ZUluRGl2JyksXG5cdE1vdmUgPSByZXF1aXJlKCcuL01vdmUnKSxcblx0Y29uc3RhbnRzID0gcmVxdWlyZSgnLi9jb25zdGFudHMnKSxcblx0c2lnbmFsQnVzID0gcmVxdWlyZSgnLi9zaWduYWxCdXMnKSxcblx0c2FtcGxlID0gcmVxdWlyZSgnLi4vdXRpbHMvc2FtcGxlQXJyYXknKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpIHtcblxuXHR2YXIgX2RlZmVycmVkLFxuXHRcdF9hbGxNb3Zlc1N0cmluZyxcblx0XHRfbnVtTW92ZXMsXG5cdFx0X2NsYXNzUG9zdEZpeCxcblx0XHRfY2hhbmNlT2ZGYWlsaW5nLFxuXHRcdF9kZWxheSxcblx0XHRfY2hhaW4sXG5cdFx0X2N1cnJlbnRNb3ZlLFxuXHRcdF9pc0F1dG9tYXRlZFBsYXllcjtcblxuXG5cdGZ1bmN0aW9uIGluaXQoZGl2Q2xhc3MsIG51bU1vdmVzLCBkZWxheSwgaXNBdXRvbWF0ZWRQbGF5ZXIsIGNoYW5jZU9mRmFpbGluZykge1xuXG5cdFx0X251bU1vdmVzID0gbnVtTW92ZXM7XG5cdFx0X2RlZmVycmVkID0gUS5kZWZlcigpO1xuXHRcdF9jbGFzc1Bvc3RGaXggPSBkaXZDbGFzcztcblx0XHRfZGVsYXkgPSBkZWxheTtcblx0XHRfY2hhbmNlT2ZGYWlsaW5nID0gY2hhbmNlT2ZGYWlsaW5nO1xuXHRcdF9pc0F1dG9tYXRlZFBsYXllciA9IGlzQXV0b21hdGVkUGxheWVyO1xuXG5cdFx0Y3JlYXRlQ29tYm8oKTtcblxuXHRcdGlmKCFfaXNBdXRvbWF0ZWRQbGF5ZXIpIHtcblxuXHRcdFx0c2lnbmFsQnVzLkFDVElPTl9GSVJFRC5hZGQob25BY3Rpb25GaXJlZCk7XG5cdFx0fVxuXHR9XG5cblx0ZnVuY3Rpb24gY3JlYXRlQ29tYm8oKSB7XG5cblx0XHR2YXIgaSA9IDA7XG5cblx0XHRfYWxsTW92ZXNTdHJpbmcgPSAnJztcblxuXHRcdF9jaGFpbiA9IFtdO1xuXG5cdFx0Zm9yKGk7IGkgPCBfbnVtTW92ZXM7IGkrKykge1xuXG5cdFx0XHRfYWxsTW92ZXNTdHJpbmcgKz0gYWRkUmFuZG9tTW92ZSgpICsgJywgJztcblx0XHR9XG5cblx0XHRfYWxsTW92ZXNTdHJpbmcgKz0gJzxicj4nO1xuXHR9XG5cblx0ZnVuY3Rpb24gZGVzdHJveSgpIHtcblxuXHRcdHZhciBpID0gMDtcblxuXHRcdGlmKF9jdXJyZW50TW92ZSkge1xuXG5cdFx0XHRfY3VycmVudE1vdmUuZGVzdHJveSgpO1xuXHRcdH1cblxuXHRcdGZvcihpOyBpIDwgX2NoYWluLmxlbmd0aDsgaSsrKSB7XG5cblx0XHRcdF9jaGFpbltpXS5kZXN0cm95KCk7XG5cdFx0fVxuXG5cdFx0X2NoYWluID0gbnVsbDtcblx0XHRzaWduYWxCdXMuQUNUSU9OX0ZJUkVELnJlbW92ZShvbkFjdGlvbkZpcmVkKTtcblx0fVxuXG5cdGZ1bmN0aW9uIG9uQWN0aW9uRmlyZWQoZmlyZWRBY3Rpb24pIHtcblxuXHRcdGlmKF9jdXJyZW50TW92ZSkge1xuXG5cdFx0XHRfY3VycmVudE1vdmUuZmlyZUFjdGlvbihmaXJlZEFjdGlvbik7XG5cdFx0fVxuXHR9XG5cblx0ZnVuY3Rpb24gYWRkUmFuZG9tTW92ZSgpIHtcblxuXHRcdHZhciByYW5kb21BY3Rpb24gPSBzYW1wbGUoY29uc3RhbnRzLkFMTF9BQ1RJT05TKSxcblx0XHRcdG5ld01vdmUgPSBuZXcgTW92ZShyYW5kb21BY3Rpb24sIF9kZWxheSk7XG5cblx0XHRfY2hhaW4ucHVzaChuZXdNb3ZlKTtcblxuXHRcdHJldHVybiByYW5kb21BY3Rpb247XG5cdH1cblxuXHRmdW5jdGlvbiBzdGFydCgpIHtcblxuXHRcdHZhbGlkYXRlQ2hhaW4oKTtcblxuXHRcdHdyaXRlSW5EaXYoX2NsYXNzUG9zdEZpeCwgJ0dldCBSRUFEWSEnKTtcblxuXHRcdHJldHVybiBfZGVmZXJyZWQucHJvbWlzZTtcblx0fVxuXG5cdGZ1bmN0aW9uIHZhbGlkYXRlQ2hhaW4oKSB7XG5cblx0XHRfY3VycmVudE1vdmUgPSBfY2hhaW4uc2hpZnQoKTtcblxuXHRcdGlmKF9jdXJyZW50TW92ZSkge1xuXG5cdFx0XHRfY3VycmVudE1vdmUuc3RhdGVJc09uVGltZVNpZ25hbC5hZGQob25DdXJyZW50TW92ZUlzUmVhZHkpO1xuXHRcdFx0ZXhlY3V0ZU1vdmUoKTtcblxuXHRcdH0gZWxzZSB7XG5cblx0XHRcdF9kZWZlcnJlZC5yZXNvbHZlKCk7XG5cdFx0fVxuXHR9XG5cblx0ZnVuY3Rpb24gZXhlY3V0ZU1vdmUoKSB7XG5cblx0XHRfY3VycmVudE1vdmUuZXhlY3V0ZSgpXG5cdFx0XHQudGhlbihtb3ZlRXhlY3V0ZWQpXG5cdFx0XHQuZmFpbChtb3ZlRmFpbGVkKVxuXHRcdFx0LmZpbihtb3ZlRmluaXNoZWQpXG5cdH1cblxuXHRmdW5jdGlvbiBvbkN1cnJlbnRNb3ZlSXNSZWFkeSgpIHtcblxuXHRcdHZhciByZXF1ZXN0ZWRBY3Rpb24gPSBfY3VycmVudE1vdmUuZ2V0UmVxdWVzdGVkQWN0aW9uKCksXG5cdFx0XHRzaG91bGRGYWlsO1xuXG5cdFx0aWYoX2lzQXV0b21hdGVkUGxheWVyKSB7XG5cblx0XHRcdHNob3VsZEZhaWwgPSBNYXRoLnJhbmRvbSgpIDwgX2NoYW5jZU9mRmFpbGluZztcblxuXHRcdFx0aWYoc2hvdWxkRmFpbCkge1xuXG5cdFx0XHRcdF9jdXJyZW50TW92ZS5maXJlQWN0aW9uKCk7XG5cblx0XHRcdH0gZWxzZSB7XG5cblx0XHRcdFx0X2N1cnJlbnRNb3ZlLmZpcmVBY3Rpb24ocmVxdWVzdGVkQWN0aW9uKTtcblx0XHRcdH1cblxuXHRcdH0gZWxzZSB7XG5cblx0XHRcdHdyaXRlSW5EaXYoX2NsYXNzUG9zdEZpeCwgX2FsbE1vdmVzU3RyaW5nKTtcblx0XHR9XG5cdH1cblxuXHRmdW5jdGlvbiBtb3ZlRXhlY3V0ZWQoKSB7XG5cblx0XHRpZihfaXNBdXRvbWF0ZWRQbGF5ZXIpIHtcblxuXHRcdFx0d3JpdGVJbkRpdihfY2xhc3NQb3N0Rml4LCAnQUkgaGFzICcgKyBfY2hhaW4ubGVuZ3RoICsgJyBtb3ZlcyBsZWZ0Jyk7XG5cblx0XHR9IGVsc2Uge1xuXG5cdFx0XHR3cml0ZUluRGl2KF9jbGFzc1Bvc3RGaXgsIF9hbGxNb3Zlc1N0cmluZyArICdHb3QgaXQhJyk7XG5cdFx0fVxuXHR9XG5cblx0ZnVuY3Rpb24gbW92ZUZhaWxlZChtZXNzYWdlKSB7XG5cblx0XHRjcmVhdGVDb21ibygpO1xuXG5cdFx0aWYoIV9pc0F1dG9tYXRlZFBsYXllcikge1xuXG5cdFx0XHR3cml0ZUluRGl2KF9jbGFzc1Bvc3RGaXgsIF9hbGxNb3Zlc1N0cmluZyArICdXb29wcywgJyArIG1lc3NhZ2UpO1xuXG5cdFx0fSBlbHNlIHtcblxuXHRcdFx0d3JpdGVJbkRpdihfY2xhc3NQb3N0Rml4LCAnQUkgbWlzc2VkIScpO1xuXHRcdH1cblx0fVxuXG5cdGZ1bmN0aW9uIG1vdmVGaW5pc2hlZCgpIHtcblxuXHRcdF9jdXJyZW50TW92ZS5kZXN0cm95KCk7XG5cdFx0dmFsaWRhdGVDaGFpbigpO1xuXHR9XG5cblx0dGhpcy5pbml0ID0gaW5pdDtcblx0dGhpcy5zdGFydCA9IHN0YXJ0O1xuXHR0aGlzLmRlc3Ryb3kgPSBkZXN0cm95O1xufTsiLCJ2YXIgY29uc3RhbnRzID0gcmVxdWlyZSgnLi9jb25zdGFudHMnKSxcblx0c2lnbmFsQnVzID0gcmVxdWlyZSgnLi9zaWduYWxCdXMnKTtcblxuZnVuY3Rpb24gaW5pdCgpIHtcblxuXHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIG9uS2V5RG93bik7XG59XG5cbmZ1bmN0aW9uIG9uS2V5RG93bihlKSB7XG5cblx0dmFyIGFjdGlvbjtcblxuXHRzd2l0Y2goZS5rZXlDb2RlKSB7XG5cblx0XHRjYXNlIDEzOiBhY3Rpb24gPSBjb25zdGFudHMuQUNUSU9OX0VOVEVSOyBicmVhaztcblxuXHRcdGNhc2UgMzg6IGFjdGlvbiA9IGNvbnN0YW50cy5BQ1RJT05fVVA7IGJyZWFrO1xuXHRcdGNhc2UgNDA6IGFjdGlvbiA9IGNvbnN0YW50cy5BQ1RJT05fRE9XTjsgYnJlYWs7XG5cdFx0Y2FzZSAzNzogYWN0aW9uID0gY29uc3RhbnRzLkFDVElPTl9MRUZUOyBicmVhaztcblx0XHRjYXNlIDM5OiBhY3Rpb24gPSBjb25zdGFudHMuQUNUSU9OX1JJR0hUOyBicmVhaztcblx0fVxuXG5cdHNpZ25hbEJ1cy5BQ1RJT05fRklSRUQuZGlzcGF0Y2goYWN0aW9uKTtcbn1cblxuZXhwb3J0cy5pbml0ID0gaW5pdDsiLCJ2YXIgQUNUSU9OX1VQID0gJ0FDVElPTl9VUCcsXG5cdEFDVElPTl9FTlRFUiA9ICdBQ1RJT05fRU5URVInLFxuXHRBQ1RJT05fRE9XTiA9ICdBQ1RJT05fRE9XTicsXG5cdEFDVElPTl9MRUZUID0gJ0FDVElPTl9MRUZUJyxcblx0QUNUSU9OX1JJR0hUID0gJ0FDVElPTl9SSUdIVCc7XG5cbmV4cG9ydHMuQUNUSU9OX0VOVEVSID0gQUNUSU9OX0VOVEVSO1xuZXhwb3J0cy5BQ1RJT05fVVAgPSBBQ1RJT05fVVA7XG5leHBvcnRzLkFDVElPTl9ET1dOID0gQUNUSU9OX0RPV047XG5leHBvcnRzLkFDVElPTl9MRUZUID0gQUNUSU9OX0xFRlQ7XG5leHBvcnRzLkFDVElPTl9SSUdIVCA9IEFDVElPTl9SSUdIVDtcbmV4cG9ydHMuQUxMX0FDVElPTlMgPSBbQUNUSU9OX1VQLCBBQ1RJT05fRE9XTiwgQUNUSU9OX0xFRlQsIEFDVElPTl9SSUdIVF07XG5cbiIsInZhciBTaWduYWwgPSByZXF1aXJlKCcuLi91dGlscy9zaWduYWxzJyk7XG5cbmV4cG9ydHMuQUNUSU9OX0ZJUkVEID0gbmV3IFNpZ25hbCgpOyIsInZhciBhY3Rpb25IYW5kbGVyID0gcmVxdWlyZSgnLi9jb3JlL2FjdGlvbkhhbmRsZXInKSxcblx0c2lnbmFsQnVzID0gcmVxdWlyZSgnLi9jb3JlL3NpZ25hbEJ1cycpLFxuXHR3cml0ZUluRGl2ID0gcmVxdWlyZSgnLi91dGlscy93cml0ZUluRGl2JyksXG5cdGNvbnN0YW50cyA9IHJlcXVpcmUoJy4vY29yZS9jb25zdGFudHMnKSxcblx0UGxheWVyID0gcmVxdWlyZSgnLi9jb3JlL1BsYXllcicpO1xuXG5cbnZhciBodW1hblBsYXllciA9IG5ldyBQbGF5ZXIoKSxcblx0YWlQbGF5ZXIgPSBuZXcgUGxheWVyKCksXG5cdGlzUGxheWluZyA9IGZhbHNlLFxuXHRkYXRHdWlQcm9wcyA9IG5ldyBmdW5jdGlvbigpIHtcblxuXHRcdHRoaXMubW92ZXMgPSA1O1xuXHRcdHRoaXMuYWlEZWxheSA9IDIwMDA7XG5cdFx0dGhpcy5haU1pc3NDaGFuY2UgPSAwO1xuXG5cdFx0dGhpcy5zdGFydCA9IHN0YXJ0O1xuXHRcdHRoaXMuc3RvcCA9IHN0b3A7XG5cdH0oKTtcblxudmFyIGd1aSA9IG5ldyBkYXQuR1VJKCk7XG5ndWkuYWRkKGRhdEd1aVByb3BzLCAnbW92ZXMnLCAwLCAxMCkuc3RlcCgxKTtcbmd1aS5hZGQoZGF0R3VpUHJvcHMsICdhaURlbGF5JywgMCwgNTAwMCkuc3RlcCgxMDApO1xuZ3VpLmFkZChkYXRHdWlQcm9wcywgJ2FpTWlzc0NoYW5jZScsIDAsIDEpLnN0ZXAoMC4wNSk7XG5ndWkuYWRkKGRhdEd1aVByb3BzLCAnc3RhcnQnKTtcbmd1aS5hZGQoZGF0R3VpUHJvcHMsICdzdG9wJyk7XG5cbndyaXRlSW5EaXYoJ2dlbmVyYWwnLCAnUHJlc3MgYEVOVEVSYCB0byBzdGFydCcpO1xuYWN0aW9uSGFuZGxlci5pbml0KCk7XG5cbnNpZ25hbEJ1cy5BQ1RJT05fRklSRUQuYWRkKG9uQWN0aW9uRmlyZWQpO1xuXG5mdW5jdGlvbiBvbkFjdGlvbkZpcmVkKGFjdGlvbikge1xuXG5cdGlmKGFjdGlvbiA9PT0gY29uc3RhbnRzLkFDVElPTl9FTlRFUikge1xuXG5cdFx0aWYoIWlzUGxheWluZykge1xuXG5cdFx0XHRzdGFydCgpO1xuXG5cdFx0fSBlbHNlIHtcblxuXHRcdFx0c3RvcCgpO1xuXHRcdH1cblx0fVxufVxuXG5mdW5jdGlvbiBzdGFydCgpIHtcblxuXHRpZihpc1BsYXlpbmcpIHtcblxuXHRcdHN0b3AoKTtcblx0fVxuXG5cdHdyaXRlSW5EaXYoJ2dlbmVyYWwnLCAnJyk7XG5cblx0aXNQbGF5aW5nID0gdHJ1ZTtcblx0aHVtYW5QbGF5ZXIuaW5pdCgncGxheWVyJywgZGF0R3VpUHJvcHMubW92ZXMsIDAsIGZhbHNlKTtcblx0YWlQbGF5ZXIuaW5pdCgnYWknLCBkYXRHdWlQcm9wcy5tb3ZlcywgZGF0R3VpUHJvcHMuYWlEZWxheSwgdHJ1ZSwgZGF0R3VpUHJvcHMuYWlNaXNzQ2hhbmNlKTtcblxuXHRodW1hblBsYXllci5zdGFydCgpXG5cdFx0LnRoZW4oZnVuY3Rpb24oKXtcblx0XHRcdGdhbWVPdmVyKHRydWUpO1xuXHRcdH0pLmZhaWwob25FcnJvcik7XG5cdGFpUGxheWVyLnN0YXJ0KClcblx0XHQudGhlbihmdW5jdGlvbigpe1xuXG5cdFx0XHRnYW1lT3ZlcihmYWxzZSk7XG5cdFx0fSkuZmFpbChvbkVycm9yKTtcbn1cblxuZnVuY3Rpb24gb25FcnJvcihlKSB7XG5cdGNvbnNvbGUuZXJyb3IoZSk7XG59XG5cbmZ1bmN0aW9uIGdhbWVPdmVyKHBsYXllcldvbikge1xuXG5cdHdyaXRlSW5EaXYoJ3BsYXllcicsICcnKTtcblx0d3JpdGVJbkRpdignYWknLCAnJyk7XG5cdGlmKHBsYXllcldvbikge1xuXG5cdFx0d3JpdGVJbkRpdignZ2VuZXJhbCcsICdZb3Ugd29uITxicj5QcmVzcyBgRU5URVJgIHRvIHJlcGxheScpO1xuXG5cdH0gZWxzZSB7XG5cblx0XHR3cml0ZUluRGl2KCdnZW5lcmFsJywgJ1lvdSBsb3N0Li4uPGJyPlByZXNzIGBFTlRFUmAgdG8gcmVwbGF5Jyk7XG5cdH1cblxuXHRzdG9wKCk7XG59XG5cbmZ1bmN0aW9uIHN0b3AoKSB7XG5cblx0aXNQbGF5aW5nID0gZmFsc2U7XG5cblx0aHVtYW5QbGF5ZXIuZGVzdHJveSgpO1xuXHRhaVBsYXllci5kZXN0cm95KCk7XG59IiwiXG4vKipcbiAqIEFuIG9iamVjdCByZXByZXNlbnRpbmcgYSBcInByb21pc2VcIiBmb3IgYSBmdXR1cmUgdmFsdWVcbiAqXG4gKiBAcGFyYW0gez9mdW5jdGlvbihULCA/KT19IG9uU3VjY2VzcyBhIGZ1bmN0aW9uIHRvIGhhbmRsZSBzdWNjZXNzZnVsXG4gKiAgICAgcmVzb2x1dGlvbiBvZiB0aGlzIHByb21pc2VcbiAqIEBwYXJhbSB7P2Z1bmN0aW9uKCFFcnJvciwgPyk9fSBvbkZhaWwgYSBmdW5jdGlvbiB0byBoYW5kbGUgZmFpbGVkXG4gKiAgICAgcmVzb2x1dGlvbiBvZiB0aGlzIHByb21pc2VcbiAqIEBjb25zdHJ1Y3RvclxuICogQHRlbXBsYXRlIFRcbiAqL1xuZnVuY3Rpb24gUHJvbWlzZShvblN1Y2Nlc3MsIG9uRmFpbCkge1xuICB0aGlzLnByb21pc2UgPSB0aGlzXG4gIHRoaXMuX2lzUHJvbWlzZSA9IHRydWVcbiAgdGhpcy5fc3VjY2Vzc0ZuID0gb25TdWNjZXNzXG4gIHRoaXMuX2ZhaWxGbiA9IG9uRmFpbFxuICB0aGlzLl9zY29wZSA9IHRoaXNcbiAgdGhpcy5fYm91bmRBcmdzID0gbnVsbFxuICB0aGlzLl9oYXNDb250ZXh0ID0gZmFsc2VcbiAgdGhpcy5fbmV4dENvbnRleHQgPSB1bmRlZmluZWRcbiAgdGhpcy5fY3VycmVudENvbnRleHQgPSB1bmRlZmluZWRcbn1cblxuLyoqXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCl9IGNhbGxiYWNrXG4gKi9cbmZ1bmN0aW9uIG5leHRUaWNrIChjYWxsYmFjaykge1xuICBjYWxsYmFjaygpXG59XG5cbmlmICh0eXBlb2YgcHJvY2VzcyAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIHByb2Nlc3MubmV4dFRpY2sgPT09ICdmdW5jdGlvbicpIHtcbiAgbmV4dFRpY2sgPSBwcm9jZXNzLm5leHRUaWNrXG59XG5cbi8qKlxuICogQWxsIGNhbGxiYWNrIGV4ZWN1dGlvbiBzaG91bGQgZ28gdGhyb3VnaCB0aGlzIGZ1bmN0aW9uLiAgV2hpbGUgdGhlXG4gKiBpbXBsZW1lbnRhdGlvbiBiZWxvdyBpcyBzaW1wbGUsIGl0IGNhbiBiZSByZXBsYWNlZCB3aXRoIG1vcmUgc29waGlzdGljYXRlZFxuICogaW1wbGVtZW50YXRpb25zIHRoYXQgZW5mb3JjZSBRb1Mgb24gdGhlIGV2ZW50IGxvb3AuXG4gKlxuICogQHBhcmFtIHtQcm9taXNlfSBkZWZlclxuICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2tcbiAqIEBwYXJhbSB7T2JqZWN0fHVuZGVmaW5lZH0gc2NvcGVcbiAqIEBwYXJhbSB7QXJyYXl9IGFyZ3NcbiAqL1xuZnVuY3Rpb24gbmV4dFRpY2tDYWxsYmFjayAoZGVmZXIsIGNhbGxiYWNrLCBzY29wZSwgYXJncykge1xuICB0cnkge1xuICAgIGRlZmVyLnJlc29sdmUoY2FsbGJhY2suYXBwbHkoc2NvcGUsIGFyZ3MpKVxuICB9IGNhdGNoICh0aHJvd24pIHtcbiAgICBkZWZlci5yZWplY3QodGhyb3duKVxuICB9XG59XG5cbi8qKlxuICogVXNlZCBmb3IgYWNjZXNzaW5nIHRoZSBuZXh0VGljayBmdW5jdGlvbiBmcm9tIG91dHNpZGUgdGhlIGtldyBtb2R1bGUuXG4gKlxuICogQHJldHVybiB7RnVuY3Rpb259XG4gKi9cbmZ1bmN0aW9uIGdldE5leHRUaWNrRnVuY3Rpb24gKCkge1xuICByZXR1cm4gbmV4dFRpY2tcbn1cblxuLyoqXG4gKiBVc2VkIGZvciBvdmVycmlkaW5nIHRoZSBuZXh0VGljayBmdW5jdGlvbiBmcm9tIG91dHNpZGUgdGhlIGtldyBtb2R1bGUgc28gdGhhdFxuICogdGhlIHVzZXIgY2FuIHBsdWcgYW5kIHBsYXkgbG93ZXIgbGV2ZWwgc2NoZWR1bGVyc1xuICogQHBhcmFtIHshRnVuY3Rpb259IGZuXG4gKi9cbmZ1bmN0aW9uIHNldE5leHRUaWNrRnVuY3Rpb24gKGZuKSB7XG4gIG5leHRUaWNrID0gZm5cbn1cblxuLyoqXG4gKiBLZWVwIHRyYWNrIG9mIHRoZSBudW1iZXIgb2YgcHJvbWlzZXMgdGhhdCBhcmUgcmVqZWN0ZWQgYWxvbmcgc2lkZVxuICogdGhlIG51bWJlciBvZiByZWplY3RlZCBwcm9taXNlcyB3ZSBjYWxsIF9mYWlsRm4gb24gc28gd2UgY2FuIGxvb2tcbiAqIGZvciBsZWFrZWQgcmVqZWN0aW9ucy5cbiAqIEBjb25zdHJ1Y3RvclxuICovXG5mdW5jdGlvbiBQcm9taXNlU3RhdHMoKSB7XG4gIC8qKiBAdHlwZSB7bnVtYmVyfSAqL1xuICB0aGlzLmVycm9yc0VtaXR0ZWQgPSAwXG5cbiAgLyoqIEB0eXBlIHtudW1iZXJ9ICovXG4gIHRoaXMuZXJyb3JzSGFuZGxlZCA9IDBcbn1cblxudmFyIHN0YXRzID0gbmV3IFByb21pc2VTdGF0cygpXG5cblByb21pc2UucHJvdG90eXBlLl9oYW5kbGVFcnJvciA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKCF0aGlzLl9lcnJvckhhbmRsZWQpIHtcbiAgICBzdGF0cy5lcnJvcnNIYW5kbGVkKytcbiAgICB0aGlzLl9lcnJvckhhbmRsZWQgPSB0cnVlXG4gIH1cbn1cblxuLyoqXG4gKiBTcGVjaWZ5IHRoYXQgdGhlIGN1cnJlbnQgcHJvbWlzZSBzaG91bGQgaGF2ZSBhIHNwZWNpZmllZCBjb250ZXh0XG4gKiBAcGFyYW0gIHsqfSBjb250ZXh0IGNvbnRleHRcbiAqIEBwcml2YXRlXG4gKi9cblByb21pc2UucHJvdG90eXBlLl91c2VDb250ZXh0ID0gZnVuY3Rpb24gKGNvbnRleHQpIHtcbiAgdGhpcy5fbmV4dENvbnRleHQgPSB0aGlzLl9jdXJyZW50Q29udGV4dCA9IGNvbnRleHRcbiAgdGhpcy5faGFzQ29udGV4dCA9IHRydWVcbiAgcmV0dXJuIHRoaXNcbn1cblxuUHJvbWlzZS5wcm90b3R5cGUuY2xlYXJDb250ZXh0ID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLl9oYXNDb250ZXh0ID0gZmFsc2VcbiAgdGhpcy5fbmV4dENvbnRleHQgPSB1bmRlZmluZWRcbiAgcmV0dXJuIHRoaXNcbn1cblxuLyoqXG4gKiBTZXQgdGhlIGNvbnRleHQgZm9yIGFsbCBwcm9taXNlIGhhbmRsZXJzIHRvIGZvbGxvd1xuICpcbiAqIE5PVEUoZHB1cCk6IFRoaXMgc2hvdWxkIGJlIGNvbnNpZGVyZWQgZGVwcmVjYXRlZC4gIEl0IGRvZXMgbm90IGRvIHdoYXQgbW9zdFxuICogcGVvcGxlIHdvdWxkIGV4cGVjdC4gIFRoZSBjb250ZXh0IHdpbGwgYmUgcGFzc2VkIGFzIGEgc2Vjb25kIGFyZ3VtZW50IHRvIGFsbFxuICogc3Vic2VxdWVudCBjYWxsYmFja3MuXG4gKlxuICogQHBhcmFtIHsqfSBjb250ZXh0IEFuIGFyYml0cmFyeSBjb250ZXh0XG4gKi9cblByb21pc2UucHJvdG90eXBlLnNldENvbnRleHQgPSBmdW5jdGlvbiAoY29udGV4dCkge1xuICB0aGlzLl9uZXh0Q29udGV4dCA9IGNvbnRleHRcbiAgdGhpcy5faGFzQ29udGV4dCA9IHRydWVcbiAgcmV0dXJuIHRoaXNcbn1cblxuLyoqXG4gKiBHZXQgdGhlIGNvbnRleHQgZm9yIGEgcHJvbWlzZVxuICogQHJldHVybiB7Kn0gdGhlIGNvbnRleHQgc2V0IGJ5IHNldENvbnRleHRcbiAqL1xuUHJvbWlzZS5wcm90b3R5cGUuZ2V0Q29udGV4dCA9IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIHRoaXMuX25leHRDb250ZXh0XG59XG5cbi8qKlxuICogUmVzb2x2ZSB0aGlzIHByb21pc2Ugd2l0aCBhIHNwZWNpZmllZCB2YWx1ZVxuICpcbiAqIEBwYXJhbSB7Kj19IGRhdGFcbiAqL1xuUHJvbWlzZS5wcm90b3R5cGUucmVzb2x2ZSA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gIGlmICh0aGlzLl9lcnJvciB8fCB0aGlzLl9oYXNEYXRhKSB0aHJvdyBuZXcgRXJyb3IoXCJVbmFibGUgdG8gcmVzb2x2ZSBvciByZWplY3QgdGhlIHNhbWUgcHJvbWlzZSB0d2ljZVwiKVxuXG4gIHZhciBpXG4gIGlmIChkYXRhICYmIGlzUHJvbWlzZShkYXRhKSkge1xuICAgIHRoaXMuX2NoaWxkID0gZGF0YVxuICAgIGlmICh0aGlzLl9wcm9taXNlcykge1xuICAgICAgZm9yIChpID0gMDsgaSA8IHRoaXMuX3Byb21pc2VzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGRhdGEuX2NoYWluUHJvbWlzZSh0aGlzLl9wcm9taXNlc1tpXSlcbiAgICAgIH1cbiAgICAgIGRlbGV0ZSB0aGlzLl9wcm9taXNlc1xuICAgIH1cblxuICAgIGlmICh0aGlzLl9vbkNvbXBsZXRlKSB7XG4gICAgICBmb3IgKGkgPSAwOyBpIDwgdGhpcy5fb25Db21wbGV0ZS5sZW5ndGg7IGkrPSAxKSB7XG4gICAgICAgIGRhdGEuZmluKHRoaXMuX29uQ29tcGxldGVbaV0pXG4gICAgICB9XG4gICAgICBkZWxldGUgdGhpcy5fb25Db21wbGV0ZVxuICAgIH1cbiAgfSBlbHNlIGlmIChkYXRhICYmIGlzUHJvbWlzZUxpa2UoZGF0YSkpIHtcbiAgICBkYXRhLnRoZW4oXG4gICAgICBmdW5jdGlvbihkYXRhKSB7IHRoaXMucmVzb2x2ZShkYXRhKSB9LmJpbmQodGhpcyksXG4gICAgICBmdW5jdGlvbihlcnIpIHsgdGhpcy5yZWplY3QoZXJyKSB9LmJpbmQodGhpcylcbiAgICApXG4gIH0gZWxzZSB7XG4gICAgdGhpcy5faGFzRGF0YSA9IHRydWVcbiAgICB0aGlzLl9kYXRhID0gZGF0YVxuXG4gICAgaWYgKHRoaXMuX29uQ29tcGxldGUpIHtcbiAgICAgIGZvciAoaSA9IDA7IGkgPCB0aGlzLl9vbkNvbXBsZXRlLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHRoaXMuX29uQ29tcGxldGVbaV0oKVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh0aGlzLl9wcm9taXNlcykge1xuICAgICAgZm9yIChpID0gMDsgaSA8IHRoaXMuX3Byb21pc2VzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIHRoaXMuX3Byb21pc2VzW2ldLl91c2VDb250ZXh0KHRoaXMuX25leHRDb250ZXh0KVxuICAgICAgICB0aGlzLl9wcm9taXNlc1tpXS5fd2l0aElucHV0KGRhdGEpXG4gICAgICB9XG4gICAgICBkZWxldGUgdGhpcy5fcHJvbWlzZXNcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBSZWplY3QgdGhpcyBwcm9taXNlIHdpdGggYW4gZXJyb3JcbiAqXG4gKiBAcGFyYW0geyFFcnJvcn0gZVxuICovXG5Qcm9taXNlLnByb3RvdHlwZS5yZWplY3QgPSBmdW5jdGlvbiAoZSkge1xuICBpZiAodGhpcy5fZXJyb3IgfHwgdGhpcy5faGFzRGF0YSkgdGhyb3cgbmV3IEVycm9yKFwiVW5hYmxlIHRvIHJlc29sdmUgb3IgcmVqZWN0IHRoZSBzYW1lIHByb21pc2UgdHdpY2VcIilcblxuICB2YXIgaVxuICB0aGlzLl9lcnJvciA9IGVcbiAgc3RhdHMuZXJyb3JzRW1pdHRlZCsrXG5cbiAgaWYgKHRoaXMuX2VuZGVkKSB7XG4gICAgdGhpcy5faGFuZGxlRXJyb3IoKVxuICAgIHByb2Nlc3MubmV4dFRpY2soZnVuY3Rpb24gb25Qcm9taXNlVGhyb3coKSB7XG4gICAgICB0aHJvdyBlXG4gICAgfSlcbiAgfVxuXG4gIGlmICh0aGlzLl9vbkNvbXBsZXRlKSB7XG4gICAgZm9yIChpID0gMDsgaSA8IHRoaXMuX29uQ29tcGxldGUubGVuZ3RoOyBpKyspIHtcbiAgICAgIHRoaXMuX29uQ29tcGxldGVbaV0oKVxuICAgIH1cbiAgfVxuXG4gIGlmICh0aGlzLl9wcm9taXNlcykge1xuICAgIHRoaXMuX2hhbmRsZUVycm9yKClcbiAgICBmb3IgKGkgPSAwOyBpIDwgdGhpcy5fcHJvbWlzZXMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgIHRoaXMuX3Byb21pc2VzW2ldLl91c2VDb250ZXh0KHRoaXMuX25leHRDb250ZXh0KVxuICAgICAgdGhpcy5fcHJvbWlzZXNbaV0uX3dpdGhFcnJvcihlKVxuICAgIH1cbiAgICBkZWxldGUgdGhpcy5fcHJvbWlzZXNcbiAgfVxufVxuXG4vKipcbiAqIFByb3ZpZGUgYSBjYWxsYmFjayB0byBiZSBjYWxsZWQgd2hlbmV2ZXIgdGhpcyBwcm9taXNlIHN1Y2Nlc3NmdWxseVxuICogcmVzb2x2ZXMuIEFsbG93cyBmb3IgYW4gb3B0aW9uYWwgc2Vjb25kIGNhbGxiYWNrIHRvIGhhbmRsZSB0aGUgZmFpbHVyZVxuICogY2FzZS5cbiAqXG4gKiBAcGFyYW0gez9mdW5jdGlvbih0aGlzOnZvaWQsIFQsID8pOiBSRVNVTFR8dW5kZWZpbmVkfSBvblN1Y2Nlc3NcbiAqIEBwYXJhbSB7P2Z1bmN0aW9uKHRoaXM6dm9pZCwgIUVycm9yLCA/KTogUkVTVUxUPX0gb25GYWlsXG4gKiBAcmV0dXJuIHshUHJvbWlzZS48UkVTVUxUPn0gcmV0dXJucyBhIG5ldyBwcm9taXNlIHdpdGggdGhlIG91dHB1dCBvZiB0aGUgb25TdWNjZXNzIG9yXG4gKiAgICAgb25GYWlsIGhhbmRsZXJcbiAqIEB0ZW1wbGF0ZSBSRVNVTFRcbiAqL1xuUHJvbWlzZS5wcm90b3R5cGUudGhlbiA9IGZ1bmN0aW9uIChvblN1Y2Nlc3MsIG9uRmFpbCkge1xuICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKG9uU3VjY2Vzcywgb25GYWlsKVxuICBpZiAodGhpcy5fbmV4dENvbnRleHQpIHByb21pc2UuX3VzZUNvbnRleHQodGhpcy5fbmV4dENvbnRleHQpXG5cbiAgaWYgKHRoaXMuX2NoaWxkKSB0aGlzLl9jaGlsZC5fY2hhaW5Qcm9taXNlKHByb21pc2UpXG4gIGVsc2UgdGhpcy5fY2hhaW5Qcm9taXNlKHByb21pc2UpXG5cbiAgcmV0dXJuIHByb21pc2Vcbn1cblxuLyoqXG4gKiBQcm92aWRlIGEgY2FsbGJhY2sgdG8gYmUgY2FsbGVkIHdoZW5ldmVyIHRoaXMgcHJvbWlzZSBzdWNjZXNzZnVsbHlcbiAqIHJlc29sdmVzLiBUaGUgY2FsbGJhY2sgd2lsbCBiZSBleGVjdXRlZCBpbiB0aGUgY29udGV4dCBvZiB0aGUgcHJvdmlkZWQgc2NvcGUuXG4gKlxuICogQHBhcmFtIHtmdW5jdGlvbih0aGlzOlNDT1BFLCAuLi4pOiBSRVNVTFR9IG9uU3VjY2Vzc1xuICogQHBhcmFtIHtTQ09QRX0gc2NvcGUgT2JqZWN0IHdob3NlIGNvbnRleHQgY2FsbGJhY2sgd2lsbCBiZSBleGVjdXRlZCBpbi5cbiAqIEBwYXJhbSB7Li4uKn0gdmFyX2FyZ3MgQWRkaXRpb25hbCBhcmd1bWVudHMgdG8gYmUgcGFzc2VkIHRvIHRoZSBwcm9taXNlIGNhbGxiYWNrLlxuICogQHJldHVybiB7IVByb21pc2UuPFJFU1VMVD59IHJldHVybnMgYSBuZXcgcHJvbWlzZSB3aXRoIHRoZSBvdXRwdXQgb2YgdGhlIG9uU3VjY2Vzc1xuICogQHRlbXBsYXRlIFNDT1BFLCBSRVNVTFRcbiAqL1xuUHJvbWlzZS5wcm90b3R5cGUudGhlbkJvdW5kID0gZnVuY3Rpb24gKG9uU3VjY2Vzcywgc2NvcGUsIHZhcl9hcmdzKSB7XG4gIHZhciBwcm9taXNlID0gbmV3IFByb21pc2Uob25TdWNjZXNzKVxuICBpZiAodGhpcy5fbmV4dENvbnRleHQpIHByb21pc2UuX3VzZUNvbnRleHQodGhpcy5fbmV4dENvbnRleHQpXG5cbiAgcHJvbWlzZS5fc2NvcGUgPSBzY29wZVxuICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDIpIHtcbiAgICBwcm9taXNlLl9ib3VuZEFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpXG4gIH1cblxuICAvLyBDaGFpbmluZyBtdXN0IGhhcHBlbiBhZnRlciBzZXR0aW5nIGFyZ3MgYW5kIHNjb3BlIHNpbmNlIGl0IG1heSBmaXJlIGNhbGxiYWNrLlxuICBpZiAodGhpcy5fY2hpbGQpIHRoaXMuX2NoaWxkLl9jaGFpblByb21pc2UocHJvbWlzZSlcbiAgZWxzZSB0aGlzLl9jaGFpblByb21pc2UocHJvbWlzZSlcblxuICByZXR1cm4gcHJvbWlzZVxufVxuXG4vKipcbiAqIFByb3ZpZGUgYSBjYWxsYmFjayB0byBiZSBjYWxsZWQgd2hlbmV2ZXIgdGhpcyBwcm9taXNlIGlzIHJlamVjdGVkXG4gKlxuICogQHBhcmFtIHtmdW5jdGlvbih0aGlzOnZvaWQsICFFcnJvciwgPyl9IG9uRmFpbFxuICogQHJldHVybiB7IVByb21pc2UuPFQ+fSByZXR1cm5zIGEgbmV3IHByb21pc2Ugd2l0aCB0aGUgb3V0cHV0IG9mIHRoZSBvbkZhaWwgaGFuZGxlclxuICovXG5Qcm9taXNlLnByb3RvdHlwZS5mYWlsID0gZnVuY3Rpb24gKG9uRmFpbCkge1xuICByZXR1cm4gdGhpcy50aGVuKG51bGwsIG9uRmFpbClcbn1cblxuLyoqXG4gKiBQcm92aWRlIGEgY2FsbGJhY2sgdG8gYmUgY2FsbGVkIHdoZW5ldmVyIHRoaXMgcHJvbWlzZSBpcyByZWplY3RlZC5cbiAqIFRoZSBjYWxsYmFjayB3aWxsIGJlIGV4ZWN1dGVkIGluIHRoZSBjb250ZXh0IG9mIHRoZSBwcm92aWRlZCBzY29wZS5cbiAqXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKHRoaXM6U0NPUEUsIC4uLil9IG9uRmFpbFxuICogQHBhcmFtIHtTQ09QRX0gc2NvcGUgT2JqZWN0IHdob3NlIGNvbnRleHQgY2FsbGJhY2sgd2lsbCBiZSBleGVjdXRlZCBpbi5cbiAqIEBwYXJhbSB7Li4uP30gdmFyX2FyZ3NcbiAqIEByZXR1cm4geyFQcm9taXNlLjxUPn0gcmV0dXJucyBhIG5ldyBwcm9taXNlIHdpdGggdGhlIG91dHB1dCBvZiB0aGUgb25TdWNjZXNzXG4gKiBAdGVtcGxhdGUgU0NPUEVcbiAqL1xuUHJvbWlzZS5wcm90b3R5cGUuZmFpbEJvdW5kID0gZnVuY3Rpb24gKG9uRmFpbCwgc2NvcGUsIHZhcl9hcmdzKSB7XG4gIHZhciBwcm9taXNlID0gbmV3IFByb21pc2UobnVsbCwgb25GYWlsKVxuICBpZiAodGhpcy5fbmV4dENvbnRleHQpIHByb21pc2UuX3VzZUNvbnRleHQodGhpcy5fbmV4dENvbnRleHQpXG5cbiAgcHJvbWlzZS5fc2NvcGUgPSBzY29wZVxuICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDIpIHtcbiAgICBwcm9taXNlLl9ib3VuZEFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpXG4gIH1cblxuICAvLyBDaGFpbmluZyBtdXN0IGhhcHBlbiBhZnRlciBzZXR0aW5nIGFyZ3MgYW5kIHNjb3BlIHNpbmNlIGl0IG1heSBmaXJlIGNhbGxiYWNrLlxuICBpZiAodGhpcy5fY2hpbGQpIHRoaXMuX2NoaWxkLl9jaGFpblByb21pc2UocHJvbWlzZSlcbiAgZWxzZSB0aGlzLl9jaGFpblByb21pc2UocHJvbWlzZSlcblxuICByZXR1cm4gcHJvbWlzZVxufVxuXG4vKipcbiAqIFNwcmVhZCBhIHByb21pc2VzIG91dHB1dHMgdG8gdGhlIGZ1bmN0aW9ucyBhcmd1bWVudHMuXG4gKiBAcGFyYW0gez9mdW5jdGlvbih0aGlzOnZvaWQsIC4uLik6IFJFU1VMVHx1bmRlZmluZWR9IG9uU3VjY2Vzc1xuICogQHJldHVybiB7IVByb21pc2UuPFJFU1VMVD59IHJldHVybnMgYSBuZXcgcHJvbWlzZSB3aXRoIHRoZSBvdXRwdXQgb2YgdGhlIG9uU3VjY2VzcyBvclxuICogICAgIG9uRmFpbCBoYW5kbGVyXG4gKiBAdGVtcGxhdGUgUkVTVUxUXG4gKi9cblByb21pc2UucHJvdG90eXBlLnNwcmVhZCA9IGZ1bmN0aW9uIChvblN1Y2Nlc3MpIHtcbiAgcmV0dXJuIHRoaXMudGhlbihhbGxJbnRlcm5hbClcbiAgLnRoZW4oZnVuY3Rpb24gKGFycmF5KSB7XG4gICAgcmV0dXJuIG9uU3VjY2Vzcy5hcHBseShudWxsLCBhcnJheSlcbiAgfSlcbn1cblxuLyoqXG4gKiBTcHJlYWQgYSBwcm9taXNlcyBvdXRwdXRzIHRvIHRoZSBmdW5jdGlvbnMgYXJndW1lbnRzLlxuICogQHBhcmFtIHtmdW5jdGlvbih0aGlzOlNDT1BFLCAuLi4pOiBSRVNVTFR9IG9uU3VjY2Vzc1xuICogQHBhcmFtIHtTQ09QRX0gc2NvcGUgT2JqZWN0IHdob3NlIGNvbnRleHQgY2FsbGJhY2sgd2lsbCBiZSBleGVjdXRlZCBpbi5cbiAqIEBwYXJhbSB7Li4uKn0gdmFyX2FyZ3MgQWRkaXRpb25hbCBhcmd1bWVudHMgdG8gYmUgcGFzc2VkIHRvIHRoZSBwcm9taXNlIGNhbGxiYWNrLlxuICogQHJldHVybiB7IVByb21pc2UuPFJFU1VMVD59IHJldHVybnMgYSBuZXcgcHJvbWlzZSB3aXRoIHRoZSBvdXRwdXQgb2YgdGhlIG9uU3VjY2Vzc1xuICogQHRlbXBsYXRlIFNDT1BFLCBSRVNVTFRcbiAqL1xuUHJvbWlzZS5wcm90b3R5cGUuc3ByZWFkQm91bmQgPSBmdW5jdGlvbiAob25TdWNjZXNzLCBzY29wZSwgdmFyX2FyZ3MpIHtcbiAgdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpXG4gIHJldHVybiB0aGlzLnRoZW4oYWxsSW50ZXJuYWwpXG4gIC50aGVuKGZ1bmN0aW9uIChhcnJheSkge1xuICAgIHJldHVybiBvblN1Y2Nlc3MuYXBwbHkoc2NvcGUsIGFyZ3MuY29uY2F0KGFycmF5KSlcbiAgfSlcbn1cblxuLyoqXG4gKiBQcm92aWRlIGEgY2FsbGJhY2sgdG8gYmUgY2FsbGVkIHdoZW5ldmVyIHRoaXMgcHJvbWlzZSBpcyBlaXRoZXIgcmVzb2x2ZWRcbiAqIG9yIHJlamVjdGVkLlxuICpcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oKX0gb25Db21wbGV0ZVxuICogQHJldHVybiB7IVByb21pc2UuPFQ+fSByZXR1cm5zIHRoZSBjdXJyZW50IHByb21pc2VcbiAqL1xuUHJvbWlzZS5wcm90b3R5cGUuZmluID0gZnVuY3Rpb24gKG9uQ29tcGxldGUpIHtcbiAgaWYgKHRoaXMuX2hhc0RhdGEgfHwgdGhpcy5fZXJyb3IpIHtcbiAgICBvbkNvbXBsZXRlKClcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgaWYgKHRoaXMuX2NoaWxkKSB7XG4gICAgdGhpcy5fY2hpbGQuZmluKG9uQ29tcGxldGUpXG4gIH0gZWxzZSB7XG4gICAgaWYgKCF0aGlzLl9vbkNvbXBsZXRlKSB0aGlzLl9vbkNvbXBsZXRlID0gW29uQ29tcGxldGVdXG4gICAgZWxzZSB0aGlzLl9vbkNvbXBsZXRlLnB1c2gob25Db21wbGV0ZSlcbiAgfVxuXG4gIHJldHVybiB0aGlzXG59XG5cbi8qKlxuICogTWFyayB0aGlzIHByb21pc2UgYXMgXCJlbmRlZFwiLiBJZiB0aGUgcHJvbWlzZSBpcyByZWplY3RlZCwgdGhpcyB3aWxsIHRocm93IGFuXG4gKiBlcnJvciBpbiB3aGF0ZXZlciBzY29wZSBpdCBoYXBwZW5zIHRvIGJlIGluXG4gKlxuICogQHJldHVybiB7IVByb21pc2UuPFQ+fSByZXR1cm5zIHRoZSBjdXJyZW50IHByb21pc2VcbiAqIEBkZXByZWNhdGVkIFByZWZlciBkb25lKCksIGJlY2F1c2UgaXQncyBjb25zaXN0ZW50IHdpdGggUS5cbiAqL1xuUHJvbWlzZS5wcm90b3R5cGUuZW5kID0gZnVuY3Rpb24gKCkge1xuICB0aGlzLl9lbmQoKVxuICByZXR1cm4gdGhpc1xufVxuXG5cbi8qKlxuICogTWFyayB0aGlzIHByb21pc2UgYXMgXCJlbmRlZFwiLlxuICogQHByaXZhdGVcbiAqL1xuUHJvbWlzZS5wcm90b3R5cGUuX2VuZCA9IGZ1bmN0aW9uICgpIHtcbiAgaWYgKHRoaXMuX2Vycm9yKSB7XG4gICAgdGhpcy5faGFuZGxlRXJyb3IoKVxuICAgIHRocm93IHRoaXMuX2Vycm9yXG4gIH1cbiAgdGhpcy5fZW5kZWQgPSB0cnVlXG4gIHJldHVybiB0aGlzXG59XG5cbi8qKlxuICogQ2xvc2UgdGhlIHByb21pc2UuIEFueSBlcnJvcnMgYWZ0ZXIgdGhpcyBjb21wbGV0ZXMgd2lsbCBiZSB0aHJvd24gdG8gdGhlIGdsb2JhbCBoYW5kbGVyLlxuICpcbiAqIEBwYXJhbSB7P2Z1bmN0aW9uKHRoaXM6dm9pZCwgVCwgPyk9fSBvblN1Y2Nlc3MgYSBmdW5jdGlvbiB0byBoYW5kbGUgc3VjY2Vzc2Z1bFxuICogICAgIHJlc29sdXRpb24gb2YgdGhpcyBwcm9taXNlXG4gKiBAcGFyYW0gez9mdW5jdGlvbih0aGlzOnZvaWQsICFFcnJvciwgPyk9fSBvbkZhaWx1cmUgYSBmdW5jdGlvbiB0byBoYW5kbGUgZmFpbGVkXG4gKiAgICAgcmVzb2x1dGlvbiBvZiB0aGlzIHByb21pc2VcbiAqIEByZXR1cm4ge3ZvaWR9XG4gKi9cblByb21pc2UucHJvdG90eXBlLmRvbmUgPSBmdW5jdGlvbiAob25TdWNjZXNzLCBvbkZhaWx1cmUpIHtcbiAgdmFyIHNlbGYgPSB0aGlzXG4gIGlmIChvblN1Y2Nlc3MgfHwgb25GYWlsdXJlKSB7XG4gICAgc2VsZiA9IHNlbGYudGhlbihvblN1Y2Nlc3MsIG9uRmFpbHVyZSlcbiAgfVxuICBzZWxmLl9lbmQoKVxufVxuXG4vKipcbiAqIFJldHVybiBhIG5ldyBwcm9taXNlIHRoYXQgYmVoYXZlcyB0aGUgc2FtZSBhcyB0aGUgY3VycmVudCBwcm9taXNlIGV4Y2VwdFxuICogdGhhdCBpdCB3aWxsIGJlIHJlamVjdGVkIGlmIHRoZSBjdXJyZW50IHByb21pc2UgZG9lcyBub3QgZ2V0IGZ1bGZpbGxlZFxuICogYWZ0ZXIgYSBjZXJ0YWluIGFtb3VudCBvZiB0aW1lLlxuICpcbiAqIEBwYXJhbSB7bnVtYmVyfSB0aW1lb3V0TXMgVGhlIHRpbWVvdXQgdGhyZXNob2xkIGluIG1zZWNcbiAqIEBwYXJhbSB7c3RyaW5nPX0gdGltZW91dE1zZyBlcnJvciBtZXNzYWdlXG4gKiBAcmV0dXJuIHshUHJvbWlzZS48VD59IGEgbmV3IHByb21pc2Ugd2l0aCB0aW1lb3V0XG4gKi9cbiBQcm9taXNlLnByb3RvdHlwZS50aW1lb3V0ID0gZnVuY3Rpb24gKHRpbWVvdXRNcywgdGltZW91dE1zZykge1xuICB2YXIgZGVmZXJyZWQgPSBuZXcgUHJvbWlzZSgpXG4gIHZhciBpc1RpbWVvdXQgPSBmYWxzZVxuXG4gIHZhciB0aW1lb3V0ID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICBkZWZlcnJlZC5yZWplY3QobmV3IEVycm9yKHRpbWVvdXRNc2cgfHwgJ1Byb21pc2UgdGltZW91dCBhZnRlciAnICsgdGltZW91dE1zICsgJyBtcy4nKSlcbiAgICBpc1RpbWVvdXQgPSB0cnVlXG4gIH0sIHRpbWVvdXRNcylcblxuICB0aGlzLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICBpZiAoIWlzVGltZW91dCkge1xuICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpXG4gICAgICBkZWZlcnJlZC5yZXNvbHZlKGRhdGEpXG4gICAgfVxuICB9LFxuICBmdW5jdGlvbiAoZXJyKSB7XG4gICAgaWYgKCFpc1RpbWVvdXQpIHtcbiAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KVxuICAgICAgZGVmZXJyZWQucmVqZWN0KGVycilcbiAgICB9XG4gIH0pXG5cbiAgcmV0dXJuIGRlZmVycmVkLnByb21pc2Vcbn1cblxuLyoqXG4gKiBBdHRlbXB0IHRvIHJlc29sdmUgdGhpcyBwcm9taXNlIHdpdGggdGhlIHNwZWNpZmllZCBpbnB1dFxuICpcbiAqIEBwYXJhbSB7Kn0gZGF0YSB0aGUgaW5wdXRcbiAqL1xuUHJvbWlzZS5wcm90b3R5cGUuX3dpdGhJbnB1dCA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gIGlmICh0aGlzLl9zdWNjZXNzRm4pIHtcbiAgICB0aGlzLl9uZXh0VGljayh0aGlzLl9zdWNjZXNzRm4sIFtkYXRhLCB0aGlzLl9jdXJyZW50Q29udGV4dF0pXG4gIH0gZWxzZSB7XG4gICAgdGhpcy5yZXNvbHZlKGRhdGEpXG4gIH1cblxuICAvLyBjb250ZXh0IGlzIG5vIGxvbmdlciBuZWVkZWRcbiAgZGVsZXRlIHRoaXMuX2N1cnJlbnRDb250ZXh0XG59XG5cbi8qKlxuICogQXR0ZW1wdCB0byByZWplY3QgdGhpcyBwcm9taXNlIHdpdGggdGhlIHNwZWNpZmllZCBlcnJvclxuICpcbiAqIEBwYXJhbSB7IUVycm9yfSBlXG4gKiBAcHJpdmF0ZVxuICovXG5Qcm9taXNlLnByb3RvdHlwZS5fd2l0aEVycm9yID0gZnVuY3Rpb24gKGUpIHtcbiAgaWYgKHRoaXMuX2ZhaWxGbikge1xuICAgIHRoaXMuX25leHRUaWNrKHRoaXMuX2ZhaWxGbiwgW2UsIHRoaXMuX2N1cnJlbnRDb250ZXh0XSlcbiAgfSBlbHNlIHtcbiAgICB0aGlzLnJlamVjdChlKVxuICB9XG5cbiAgLy8gY29udGV4dCBpcyBubyBsb25nZXIgbmVlZGVkXG4gIGRlbGV0ZSB0aGlzLl9jdXJyZW50Q29udGV4dFxufVxuXG4vKipcbiAqIENhbGxzIGEgZnVuY3Rpb24gaW4gdGhlIGNvcnJlY3Qgc2NvcGUsIGFuZCBpbmNsdWRlcyBib3VuZCBhcmd1bWVudHMuXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBmblxuICogQHBhcmFtIHtBcnJheX0gYXJnc1xuICogQHByaXZhdGVcbiAqL1xuUHJvbWlzZS5wcm90b3R5cGUuX25leHRUaWNrID0gZnVuY3Rpb24gKGZuLCBhcmdzKSB7XG4gIGlmICh0aGlzLl9ib3VuZEFyZ3MpIHtcbiAgICBhcmdzID0gdGhpcy5fYm91bmRBcmdzLmNvbmNhdChhcmdzKVxuICB9XG4gIG5leHRUaWNrKG5leHRUaWNrQ2FsbGJhY2suYmluZChudWxsLCB0aGlzLCBmbiwgdGhpcy5fc2NvcGUsIGFyZ3MpKVxufVxuXG4vKipcbiAqIENoYWluIGEgcHJvbWlzZSB0byB0aGUgY3VycmVudCBwcm9taXNlXG4gKlxuICogQHBhcmFtIHshUHJvbWlzZX0gcHJvbWlzZSB0aGUgcHJvbWlzZSB0byBjaGFpblxuICogQHByaXZhdGVcbiAqL1xuUHJvbWlzZS5wcm90b3R5cGUuX2NoYWluUHJvbWlzZSA9IGZ1bmN0aW9uIChwcm9taXNlKSB7XG4gIHZhciBpXG4gIGlmICh0aGlzLl9oYXNDb250ZXh0KSBwcm9taXNlLl91c2VDb250ZXh0KHRoaXMuX25leHRDb250ZXh0KVxuXG4gIGlmICh0aGlzLl9jaGlsZCkge1xuICAgIHRoaXMuX2NoaWxkLl9jaGFpblByb21pc2UocHJvbWlzZSlcbiAgfSBlbHNlIGlmICh0aGlzLl9oYXNEYXRhKSB7XG4gICAgcHJvbWlzZS5fd2l0aElucHV0KHRoaXMuX2RhdGEpXG4gIH0gZWxzZSBpZiAodGhpcy5fZXJyb3IpIHtcbiAgICAvLyBXZSBjYW4ndCByZWx5IG9uIF93aXRoRXJyb3IoKSBiZWNhdXNlIGl0J3MgY2FsbGVkIG9uIHRoZSBjaGFpbmVkIHByb21pc2VzXG4gICAgLy8gYW5kIHdlIG5lZWQgdG8gdXNlIHRoZSBzb3VyY2UncyBfZXJyb3JIYW5kbGVkIHN0YXRlXG4gICAgdGhpcy5faGFuZGxlRXJyb3IoKVxuICAgIHByb21pc2UuX3dpdGhFcnJvcih0aGlzLl9lcnJvcilcbiAgfSBlbHNlIGlmICghdGhpcy5fcHJvbWlzZXMpIHtcbiAgICB0aGlzLl9wcm9taXNlcyA9IFtwcm9taXNlXVxuICB9IGVsc2Uge1xuICAgIHRoaXMuX3Byb21pc2VzLnB1c2gocHJvbWlzZSlcbiAgfVxufVxuXG4vKipcbiAqIFV0aWxpdHkgZnVuY3Rpb24gdXNlZCBmb3IgY3JlYXRpbmcgYSBub2RlLXN0eWxlIHJlc29sdmVyXG4gKiBmb3IgZGVmZXJyZWRzXG4gKlxuICogQHBhcmFtIHshUHJvbWlzZX0gZGVmZXJyZWQgYSBwcm9taXNlIHRoYXQgbG9va3MgbGlrZSBhIGRlZmVycmVkXG4gKiBAcGFyYW0ge0Vycm9yPX0gZXJyIGFuIG9wdGlvbmFsIGVycm9yXG4gKiBAcGFyYW0geyo9fSBkYXRhIG9wdGlvbmFsIGRhdGFcbiAqL1xuZnVuY3Rpb24gcmVzb2x2ZXIoZGVmZXJyZWQsIGVyciwgZGF0YSkge1xuICBpZiAoZXJyKSBkZWZlcnJlZC5yZWplY3QoZXJyKVxuICBlbHNlIGRlZmVycmVkLnJlc29sdmUoZGF0YSlcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgbm9kZS1zdHlsZSByZXNvbHZlciBmb3IgYSBkZWZlcnJlZCBieSB3cmFwcGluZ1xuICogcmVzb2x2ZXIoKVxuICpcbiAqIEByZXR1cm4ge2Z1bmN0aW9uKD9FcnJvciwgKil9IG5vZGUtc3R5bGUgY2FsbGJhY2tcbiAqL1xuUHJvbWlzZS5wcm90b3R5cGUubWFrZU5vZGVSZXNvbHZlciA9IGZ1bmN0aW9uICgpIHtcbiAgcmV0dXJuIHJlc29sdmVyLmJpbmQobnVsbCwgdGhpcylcbn1cblxuLyoqXG4gKiBSZXR1cm4gdHJ1ZSBpZmYgdGhlIGdpdmVuIG9iamVjdCBpcyBhIHByb21pc2Ugb2YgdGhpcyBsaWJyYXJ5LlxuICpcbiAqIEJlY2F1c2Uga2V3J3MgQVBJIGlzIHNsaWdodGx5IGRpZmZlcmVudCB0aGFuIG90aGVyIHByb21pc2UgbGlicmFyaWVzLFxuICogaXQncyBpbXBvcnRhbnQgdGhhdCB3ZSBoYXZlIGEgdGVzdCBmb3IgaXRzIHByb21pc2UgdHlwZS4gSWYgeW91IHdhbnRcbiAqIHRvIHRlc3QgZm9yIGEgbW9yZSBnZW5lcmFsIEErIHByb21pc2UsIHlvdSBzaG91bGQgZG8gYSBjYXAgdGVzdCBmb3JcbiAqIHRoZSBmZWF0dXJlcyB5b3Ugd2FudC5cbiAqXG4gKiBAcGFyYW0geyp9IG9iaiBUaGUgb2JqZWN0IHRvIHRlc3RcbiAqIEByZXR1cm4ge2Jvb2xlYW59IFdoZXRoZXIgdGhlIG9iamVjdCBpcyBhIHByb21pc2VcbiAqL1xuZnVuY3Rpb24gaXNQcm9taXNlKG9iaikge1xuICByZXR1cm4gISFvYmouX2lzUHJvbWlzZVxufVxuXG4vKipcbiAqIFJldHVybiB0cnVlIGlmZiB0aGUgZ2l2ZW4gb2JqZWN0IGlzIGEgcHJvbWlzZS1saWtlIG9iamVjdCwgZS5nLiBhcHBlYXJzIHRvXG4gKiBpbXBsZW1lbnQgUHJvbWlzZXMvQSsgc3BlY2lmaWNhdGlvblxuICpcbiAqIEBwYXJhbSB7Kn0gb2JqIFRoZSBvYmplY3QgdG8gdGVzdFxuICogQHJldHVybiB7Ym9vbGVhbn0gV2hldGhlciB0aGUgb2JqZWN0IGlzIGEgcHJvbWlzZS1saWtlIG9iamVjdFxuICovXG5mdW5jdGlvbiBpc1Byb21pc2VMaWtlKG9iaikge1xuICByZXR1cm4gKHR5cGVvZiBvYmogPT09ICdvYmplY3QnIHx8IHR5cGVvZiBvYmogPT09ICdmdW5jdGlvbicpICYmXG4gICAgdHlwZW9mIG9iai50aGVuID09PSAnZnVuY3Rpb24nXG59XG5cbi8qKlxuICogU3RhdGljIGZ1bmN0aW9uIHdoaWNoIGNyZWF0ZXMgYW5kIHJlc29sdmVzIGEgcHJvbWlzZSBpbW1lZGlhdGVseVxuICpcbiAqIEBwYXJhbSB7VH0gZGF0YSBkYXRhIHRvIHJlc29sdmUgdGhlIHByb21pc2Ugd2l0aFxuICogQHJldHVybiB7IVByb21pc2UuPFQ+fVxuICogQHRlbXBsYXRlIFRcbiAqL1xuZnVuY3Rpb24gcmVzb2x2ZShkYXRhKSB7XG4gIHZhciBwcm9taXNlID0gbmV3IFByb21pc2UoKVxuICBwcm9taXNlLnJlc29sdmUoZGF0YSlcbiAgcmV0dXJuIHByb21pc2Vcbn1cblxuLyoqXG4gKiBTdGF0aWMgZnVuY3Rpb24gd2hpY2ggY3JlYXRlcyBhbmQgcmVqZWN0cyBhIHByb21pc2UgaW1tZWRpYXRlbHlcbiAqXG4gKiBAcGFyYW0geyFFcnJvcn0gZSBlcnJvciB0byByZWplY3QgdGhlIHByb21pc2Ugd2l0aFxuICogQHJldHVybiB7IVByb21pc2V9XG4gKi9cbmZ1bmN0aW9uIHJlamVjdChlKSB7XG4gIHZhciBwcm9taXNlID0gbmV3IFByb21pc2UoKVxuICBwcm9taXNlLnJlamVjdChlKVxuICByZXR1cm4gcHJvbWlzZVxufVxuXG4vKipcbiAqIFJlcGxhY2UgYW4gZWxlbWVudCBpbiBhbiBhcnJheSB3aXRoIGEgbmV3IHZhbHVlLiBVc2VkIGJ5IC5hbGwoKSB0b1xuICogY2FsbCBmcm9tIC50aGVuKClcbiAqXG4gKiBAcGFyYW0geyFBcnJheX0gYXJyXG4gKiBAcGFyYW0ge251bWJlcn0gaWR4XG4gKiBAcGFyYW0geyp9IHZhbFxuICogQHJldHVybiB7Kn0gdGhlIHZhbCB0aGF0J3MgYmVpbmcgaW5qZWN0ZWQgaW50byB0aGUgYXJyYXlcbiAqL1xuZnVuY3Rpb24gcmVwbGFjZUVsKGFyciwgaWR4LCB2YWwpIHtcbiAgYXJyW2lkeF0gPSB2YWxcbiAgcmV0dXJuIHZhbFxufVxuXG4vKipcbiAqIFJlcGxhY2UgYW4gZWxlbWVudCBpbiBhbiBhcnJheSBhcyBpdCBpcyByZXNvbHZlZCB3aXRoIGl0cyB2YWx1ZS5cbiAqIFVzZWQgYnkgLmFsbFNldHRsZWQoKS5cbiAqXG4gKiBAcGFyYW0geyFBcnJheX0gYXJyXG4gKiBAcGFyYW0ge251bWJlcn0gaWR4XG4gKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSBmcm9tIGEgcmVzb2x2ZWQgcHJvbWlzZS5cbiAqIEByZXR1cm4geyp9IHRoZSBkYXRhIHRoYXQncyBiZWluZyBwYXNzZWQgaW5cbiAqL1xuZnVuY3Rpb24gcmVwbGFjZUVsRnVsZmlsbGVkKGFyciwgaWR4LCB2YWx1ZSkge1xuICBhcnJbaWR4XSA9IHtcbiAgICBzdGF0ZTogJ2Z1bGZpbGxlZCcsXG4gICAgdmFsdWU6IHZhbHVlXG4gIH1cbiAgcmV0dXJuIHZhbHVlXG59XG5cbi8qKlxuICogUmVwbGFjZSBhbiBlbGVtZW50IGluIGFuIGFycmF5IGFzIGl0IGlzIHJlamVjdGVkIHdpdGggdGhlIHJlYXNvbi5cbiAqIFVzZWQgYnkgLmFsbFNldHRsZWQoKS5cbiAqXG4gKiBAcGFyYW0geyFBcnJheX0gYXJyXG4gKiBAcGFyYW0ge251bWJlcn0gaWR4XG4gKiBAcGFyYW0geyp9IHJlYXNvbiBUaGUgcmVhc29uIHdoeSB0aGUgb3JpZ2luYWwgcHJvbWlzZSBpcyByZWplY3RlZFxuICogQHJldHVybiB7Kn0gdGhlIGRhdGEgdGhhdCdzIGJlaW5nIHBhc3NlZCBpblxuICovXG5mdW5jdGlvbiByZXBsYWNlRWxSZWplY3RlZChhcnIsIGlkeCwgcmVhc29uKSB7XG4gIGFycltpZHhdID0ge1xuICAgIHN0YXRlOiAncmVqZWN0ZWQnLFxuICAgIHJlYXNvbjogcmVhc29uXG4gIH1cbiAgcmV0dXJuIHJlYXNvblxufVxuXG4vKipcbiAqIFRha2VzIGluIGFuIGFycmF5IG9mIHByb21pc2VzIG9yIGxpdGVyYWxzIGFuZCByZXR1cm5zIGEgcHJvbWlzZSB3aGljaCByZXR1cm5zXG4gKiBhbiBhcnJheSBvZiB2YWx1ZXMgd2hlbiBhbGwgaGF2ZSByZXNvbHZlZC4gSWYgYW55IGZhaWwsIHRoZSBwcm9taXNlIGZhaWxzLlxuICpcbiAqIEBwYXJhbSB7IUFycmF5LjwhUHJvbWlzZT59IHByb21pc2VzXG4gKiBAcmV0dXJuIHshUHJvbWlzZS48IUFycmF5Pn1cbiAqL1xuZnVuY3Rpb24gYWxsKHByb21pc2VzKSB7XG4gIGlmIChhcmd1bWVudHMubGVuZ3RoICE9IDEgfHwgIUFycmF5LmlzQXJyYXkocHJvbWlzZXMpKSB7XG4gICAgcHJvbWlzZXMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDApXG4gIH1cbiAgcmV0dXJuIGFsbEludGVybmFsKHByb21pc2VzKVxufVxuXG4vKipcbiAqIEEgdmVyc2lvbiBvZiBhbGwoKSB0aGF0IGRvZXMgbm90IGFjY2VwdCB2YXJfYXJnc1xuICpcbiAqIEBwYXJhbSB7IUFycmF5LjwhUHJvbWlzZT59IHByb21pc2VzXG4gKiBAcmV0dXJuIHshUHJvbWlzZS48IUFycmF5Pn1cbiAqL1xuZnVuY3Rpb24gYWxsSW50ZXJuYWwocHJvbWlzZXMpIHtcbiAgaWYgKCFwcm9taXNlcy5sZW5ndGgpIHJldHVybiByZXNvbHZlKFtdKVxuXG4gIHZhciBvdXRwdXRzID0gW11cbiAgdmFyIGZpbmlzaGVkID0gZmFsc2VcbiAgdmFyIHByb21pc2UgPSBuZXcgUHJvbWlzZSgpXG4gIHZhciBjb3VudGVyID0gcHJvbWlzZXMubGVuZ3RoXG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9taXNlcy5sZW5ndGg7IGkgKz0gMSkge1xuICAgIGlmICghcHJvbWlzZXNbaV0gfHwgIWlzUHJvbWlzZUxpa2UocHJvbWlzZXNbaV0pKSB7XG4gICAgICBvdXRwdXRzW2ldID0gcHJvbWlzZXNbaV1cbiAgICAgIGNvdW50ZXIgLT0gMVxuICAgIH0gZWxzZSB7XG4gICAgICBwcm9taXNlc1tpXS50aGVuKHJlcGxhY2VFbC5iaW5kKG51bGwsIG91dHB1dHMsIGkpKVxuICAgICAgLnRoZW4oZnVuY3Rpb24gZGVjcmVtZW50QWxsQ291bnRlcigpIHtcbiAgICAgICAgY291bnRlci0tXG4gICAgICAgIGlmICghZmluaXNoZWQgJiYgY291bnRlciA9PT0gMCkge1xuICAgICAgICAgIGZpbmlzaGVkID0gdHJ1ZVxuICAgICAgICAgIHByb21pc2UucmVzb2x2ZShvdXRwdXRzKVxuICAgICAgICB9XG4gICAgICB9LCBmdW5jdGlvbiBvbkFsbEVycm9yKGUpIHtcbiAgICAgICAgaWYgKCFmaW5pc2hlZCkge1xuICAgICAgICAgIGZpbmlzaGVkID0gdHJ1ZVxuICAgICAgICAgIHByb21pc2UucmVqZWN0KGUpXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfVxuICB9XG5cbiAgaWYgKGNvdW50ZXIgPT09IDAgJiYgIWZpbmlzaGVkKSB7XG4gICAgZmluaXNoZWQgPSB0cnVlXG4gICAgcHJvbWlzZS5yZXNvbHZlKG91dHB1dHMpXG4gIH1cblxuICByZXR1cm4gcHJvbWlzZVxufVxuXG4vKipcbiAqIFRha2VzIGluIGFuIGFycmF5IG9mIHByb21pc2VzIG9yIHZhbHVlcyBhbmQgcmV0dXJucyBhIHByb21pc2UgdGhhdCBpc1xuICogZnVsZmlsbGVkIHdpdGggYW4gYXJyYXkgb2Ygc3RhdGUgb2JqZWN0cyB3aGVuIGFsbCBoYXZlIHJlc29sdmVkIG9yXG4gKiByZWplY3RlZC4gSWYgYSBwcm9taXNlIGlzIHJlc29sdmVkLCBpdHMgY29ycmVzcG9uZGluZyBzdGF0ZSBvYmplY3QgaXNcbiAqIHtzdGF0ZTogJ2Z1bGZpbGxlZCcsIHZhbHVlOiBPYmplY3R9OyB3aGVyZWFzIGlmIGEgcHJvbWlzZSBpcyByZWplY3RlZCwgaXRzXG4gKiBjb3JyZXNwb25kaW5nIHN0YXRlIG9iamVjdCBpcyB7c3RhdGU6ICdyZWplY3RlZCcsIHJlYXNvbjogT2JqZWN0fS5cbiAqXG4gKiBAcGFyYW0geyFBcnJheX0gcHJvbWlzZXMgb3IgdmFsdWVzXG4gKiBAcmV0dXJuIHshUHJvbWlzZS48IUFycmF5Pn0gUHJvbWlzZSBmdWxmaWxsZWQgd2l0aCBzdGF0ZSBvYmplY3RzIGZvciBlYWNoIGlucHV0XG4gKi9cbmZ1bmN0aW9uIGFsbFNldHRsZWQocHJvbWlzZXMpIHtcbiAgaWYgKCFBcnJheS5pc0FycmF5KHByb21pc2VzKSkge1xuICAgIHRocm93IEVycm9yKCdUaGUgaW5wdXQgdG8gXCJhbGxTZXR0bGVkKClcIiBzaG91bGQgYmUgYW4gYXJyYXkgb2YgUHJvbWlzZSBvciB2YWx1ZXMnKVxuICB9XG4gIGlmICghcHJvbWlzZXMubGVuZ3RoKSByZXR1cm4gcmVzb2x2ZShbXSlcblxuICB2YXIgb3V0cHV0cyA9IFtdXG4gIHZhciBwcm9taXNlID0gbmV3IFByb21pc2UoKVxuICB2YXIgY291bnRlciA9IHByb21pc2VzLmxlbmd0aFxuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvbWlzZXMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICBpZiAoIXByb21pc2VzW2ldIHx8ICFpc1Byb21pc2VMaWtlKHByb21pc2VzW2ldKSkge1xuICAgICAgcmVwbGFjZUVsRnVsZmlsbGVkKG91dHB1dHMsIGksIHByb21pc2VzW2ldKVxuICAgICAgaWYgKCgtLWNvdW50ZXIpID09PSAwKSBwcm9taXNlLnJlc29sdmUob3V0cHV0cylcbiAgICB9IGVsc2Uge1xuICAgICAgcHJvbWlzZXNbaV1cbiAgICAgICAgLnRoZW4ocmVwbGFjZUVsRnVsZmlsbGVkLmJpbmQobnVsbCwgb3V0cHV0cywgaSksIHJlcGxhY2VFbFJlamVjdGVkLmJpbmQobnVsbCwgb3V0cHV0cywgaSkpXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBpZiAoKC0tY291bnRlcikgPT09IDApIHByb21pc2UucmVzb2x2ZShvdXRwdXRzKVxuICAgICAgICB9KVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBwcm9taXNlXG59XG5cbi8qKlxuICogVGFrZXMgYW4gYXJyYXkgb2YgcmVzdWx0cyBhbmQgc3ByZWFkcyB0aGVtIHRvIHRoZSBhcmd1bWVudHMgb2YgYSBmdW5jdGlvbi5cbiAqIEBwYXJhbSB7IUFycmF5fSBhcnJheVxuICogQHBhcmFtIHshRnVuY3Rpb259IGZuXG4gKi9cbmZ1bmN0aW9uIHNwcmVhZChhcnJheSwgZm4pIHtcbiAgcmVzb2x2ZShhcnJheSkuc3ByZWFkKGZuKVxufVxuXG4vKipcbiAqIENyZWF0ZSBhIG5ldyBQcm9taXNlIHdoaWNoIGxvb2tzIGxpa2UgYSBkZWZlcnJlZFxuICpcbiAqIEByZXR1cm4geyFQcm9taXNlfVxuICovXG5mdW5jdGlvbiBkZWZlcigpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKClcbn1cblxuLyoqXG4gKiBSZXR1cm4gYSBwcm9taXNlIHdoaWNoIHdpbGwgd2FpdCBhIHNwZWNpZmllZCBudW1iZXIgb2YgbXMgdG8gcmVzb2x2ZVxuICpcbiAqIEBwYXJhbSB7Kn0gZGVsYXlNc09yVmFsIEEgZGVsYXkgKGluIG1zKSBpZiB0aGlzIHRha2VzIG9uZSBhcmd1bWVudCwgb3IgdGhlclxuICogICAgIHJldHVybiB2YWx1ZSBpZiBpdCB0YWtlcyB0d28uXG4gKiBAcGFyYW0ge251bWJlcj19IG9wdF9kZWxheU1zXG4gKiBAcmV0dXJuIHshUHJvbWlzZX1cbiAqL1xuZnVuY3Rpb24gZGVsYXkoZGVsYXlNc09yVmFsLCBvcHRfZGVsYXlNcykge1xuICB2YXIgcmV0dXJuVmFsID0gdW5kZWZpbmVkXG4gIHZhciBkZWxheU1zID0gZGVsYXlNc09yVmFsXG4gIGlmICh0eXBlb2Ygb3B0X2RlbGF5TXMgIT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBkZWxheU1zID0gb3B0X2RlbGF5TXNcbiAgICByZXR1cm5WYWwgPSBkZWxheU1zT3JWYWxcbiAgfVxuXG4gIGlmICh0eXBlb2YgZGVsYXlNcyAhPSAnbnVtYmVyJykge1xuICAgIHRocm93IG5ldyBFcnJvcignQmFkIGRlbGF5IHZhbHVlICcgKyBkZWxheU1zKVxuICB9XG5cbiAgdmFyIGRlZmVyID0gbmV3IFByb21pc2UoKVxuICBzZXRUaW1lb3V0KGZ1bmN0aW9uIG9uRGVsYXkoKSB7XG4gICAgZGVmZXIucmVzb2x2ZShyZXR1cm5WYWwpXG4gIH0sIGRlbGF5TXMpXG4gIHJldHVybiBkZWZlclxufVxuXG4vKipcbiAqIFJldHVybnMgYSBwcm9taXNlIHRoYXQgaGFzIHRoZSBzYW1lIHJlc3VsdCBhcyBgdGhpc2AsIGJ1dCBmdWxmaWxsZWRcbiAqIGFmdGVyIGF0IGxlYXN0IG1zIG1pbGxpc2Vjb25kc1xuICogQHBhcmFtIHtudW1iZXJ9IG1zXG4gKi9cblByb21pc2UucHJvdG90eXBlLmRlbGF5ID0gZnVuY3Rpb24gKG1zKSB7XG4gIHJldHVybiB0aGlzLnRoZW4oZnVuY3Rpb24gKHZhbCkge1xuICAgIHJldHVybiBkZWxheSh2YWwsIG1zKVxuICB9KVxufVxuXG4vKipcbiAqIFJldHVybiBhIHByb21pc2Ugd2hpY2ggd2lsbCBldmFsdWF0ZSB0aGUgZnVuY3Rpb24gZm4gaW4gYSBmdXR1cmUgdHVybiB3aXRoXG4gKiB0aGUgcHJvdmlkZWQgYXJnc1xuICpcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oLi4uKX0gZm5cbiAqIEBwYXJhbSB7Li4uKn0gdmFyX2FyZ3MgYSB2YXJpYWJsZSBudW1iZXIgb2YgYXJndW1lbnRzXG4gKiBAcmV0dXJuIHshUHJvbWlzZX1cbiAqL1xuZnVuY3Rpb24gZmNhbGwoZm4sIHZhcl9hcmdzKSB7XG4gIHZhciByb290QXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSlcbiAgdmFyIGRlZmVyID0gbmV3IFByb21pc2UoKVxuICBuZXh0VGljayhuZXh0VGlja0NhbGxiYWNrLmJpbmQobnVsbCwgZGVmZXIsIGZuLCB1bmRlZmluZWQsIHJvb3RBcmdzKSlcbiAgcmV0dXJuIGRlZmVyXG59XG5cblxuLyoqXG4gKiBSZXR1cm5zIGEgcHJvbWlzZSB0aGF0IHdpbGwgYmUgaW52b2tlZCB3aXRoIHRoZSByZXN1bHQgb2YgYSBub2RlIHN0eWxlXG4gKiBjYWxsYmFjay4gQWxsIGFyZ3MgdG8gZm4gc2hvdWxkIGJlIGdpdmVuIGV4Y2VwdCBmb3IgdGhlIGZpbmFsIGNhbGxiYWNrIGFyZ1xuICpcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oLi4uKX0gZm5cbiAqIEBwYXJhbSB7Li4uKn0gdmFyX2FyZ3MgYSB2YXJpYWJsZSBudW1iZXIgb2YgYXJndW1lbnRzXG4gKiBAcmV0dXJuIHshUHJvbWlzZX1cbiAqL1xuZnVuY3Rpb24gbmZjYWxsKGZuLCB2YXJfYXJncykge1xuICAvLyBJbnNlcnQgYW4gdW5kZWZpbmVkIGFyZ3VtZW50IGZvciBzY29wZSBhbmQgbGV0IGJpbmRQcm9taXNlKCkgZG8gdGhlIHdvcmsuXG4gIHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAwKVxuICBhcmdzLnNwbGljZSgxLCAwLCB1bmRlZmluZWQpXG4gIHJldHVybiBuY2FsbC5hcHBseSh1bmRlZmluZWQsIGFyZ3MpXG59XG5cblxuLyoqXG4gKiBMaWtlIGBuZmNhbGxgLCBidXQgcGVybWl0cyBwYXNzaW5nIGEgYHRoaXNgIGNvbnRleHQgZm9yIHRoZSBjYWxsLlxuICpcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oLi4uKX0gZm5cbiAqIEBwYXJhbSB7T2JqZWN0fSBzY29wZVxuICogQHBhcmFtIHsuLi4qfSB2YXJfYXJnc1xuICogQHJldHVybiB7IVByb21pc2V9XG4gKi9cbmZ1bmN0aW9uIG5jYWxsKGZuLCBzY29wZSwgdmFyX2FyZ3MpIHtcbiAgcmV0dXJuIGJpbmRQcm9taXNlLmFwcGx5KG51bGwsIGFyZ3VtZW50cykoKVxufVxuXG5cbi8qKlxuICogQmluZHMgYSBmdW5jdGlvbiB0byBhIHNjb3BlIHdpdGggYW4gb3B0aW9uYWwgbnVtYmVyIG9mIGN1cnJpZWQgYXJndW1lbnRzLiBBdHRhY2hlc1xuICogYSBub2RlIHN0eWxlIGNhbGxiYWNrIGFzIHRoZSBsYXN0IGFyZ3VtZW50IGFuZCByZXR1cm5zIGEgcHJvbWlzZVxuICpcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oLi4uKX0gZm5cbiAqIEBwYXJhbSB7T2JqZWN0fSBzY29wZVxuICogQHBhcmFtIHsuLi4qfSB2YXJfYXJncyBhIHZhcmlhYmxlIG51bWJlciBvZiBhcmd1bWVudHNcbiAqIEByZXR1cm4ge2Z1bmN0aW9uKC4uLil9OiAhUHJvbWlzZX1cbiAqL1xuZnVuY3Rpb24gYmluZFByb21pc2UoZm4sIHNjb3BlLCB2YXJfYXJncykge1xuICB2YXIgcm9vdEFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpXG4gIHJldHVybiBmdW5jdGlvbiBvbkJvdW5kUHJvbWlzZSh2YXJfYXJncykge1xuICAgIHZhciBkZWZlciA9IG5ldyBQcm9taXNlKClcbiAgICB0cnkge1xuICAgICAgZm4uYXBwbHkoc2NvcGUsIHJvb3RBcmdzLmNvbmNhdChBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDApLCBkZWZlci5tYWtlTm9kZVJlc29sdmVyKCkpKVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGRlZmVyLnJlamVjdChlKVxuICAgIH1cbiAgICByZXR1cm4gZGVmZXJcbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgYWxsOiBhbGwsXG4gIGJpbmRQcm9taXNlOiBiaW5kUHJvbWlzZSxcbiAgZGVmZXI6IGRlZmVyLFxuICBkZWxheTogZGVsYXksXG4gIGZjYWxsOiBmY2FsbCxcbiAgaXNQcm9taXNlOiBpc1Byb21pc2UsXG4gIGlzUHJvbWlzZUxpa2U6IGlzUHJvbWlzZUxpa2UsXG4gIG5jYWxsOiBuY2FsbCxcbiAgbmZjYWxsOiBuZmNhbGwsXG4gIHJlc29sdmU6IHJlc29sdmUsXG4gIHJlamVjdDogcmVqZWN0LFxuICBzcHJlYWQ6IHNwcmVhZCxcbiAgc3RhdHM6IHN0YXRzLFxuICBhbGxTZXR0bGVkOiBhbGxTZXR0bGVkLFxuICBQcm9taXNlOiBQcm9taXNlLFxuICBnZXROZXh0VGlja0Z1bmN0aW9uOiBnZXROZXh0VGlja0Z1bmN0aW9uLFxuICBzZXROZXh0VGlja0Z1bmN0aW9uOiBzZXROZXh0VGlja0Z1bmN0aW9uLFxufVxuIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcnJheSkge1xuXG5cdHJldHVybiBhcnJheVtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqYXJyYXkubGVuZ3RoKV07XG59OyIsIi8qanNsaW50IG9uZXZhcjp0cnVlLCB1bmRlZjp0cnVlLCBuZXdjYXA6dHJ1ZSwgcmVnZXhwOnRydWUsIGJpdHdpc2U6dHJ1ZSwgbWF4ZXJyOjUwLCBpbmRlbnQ6NCwgd2hpdGU6ZmFsc2UsIG5vbWVuOmZhbHNlLCBwbHVzcGx1czpmYWxzZSAqL1xuLypnbG9iYWwgZGVmaW5lOmZhbHNlLCByZXF1aXJlOmZhbHNlLCBleHBvcnRzOmZhbHNlLCBtb2R1bGU6ZmFsc2UsIHNpZ25hbHM6ZmFsc2UgKi9cblxuLyoqIEBsaWNlbnNlXG4gKiBKUyBTaWduYWxzIDxodHRwOi8vbWlsbGVybWVkZWlyb3MuZ2l0aHViLmNvbS9qcy1zaWduYWxzLz5cbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZVxuICogQXV0aG9yOiBNaWxsZXIgTWVkZWlyb3NcbiAqIFZlcnNpb246IDEuMC4wIC0gQnVpbGQ6IDI2OCAoMjAxMi8xMS8yOSAwNTo0OCBQTSlcbiAqL1xuXG4oZnVuY3Rpb24oZ2xvYmFsKXtcblxuICAgIC8vIFNpZ25hbEJpbmRpbmcgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gICAgLyoqXG4gICAgICogT2JqZWN0IHRoYXQgcmVwcmVzZW50cyBhIGJpbmRpbmcgYmV0d2VlbiBhIFNpZ25hbCBhbmQgYSBsaXN0ZW5lciBmdW5jdGlvbi5cbiAgICAgKiA8YnIgLz4tIDxzdHJvbmc+VGhpcyBpcyBhbiBpbnRlcm5hbCBjb25zdHJ1Y3RvciBhbmQgc2hvdWxkbid0IGJlIGNhbGxlZCBieSByZWd1bGFyIHVzZXJzLjwvc3Ryb25nPlxuICAgICAqIDxiciAvPi0gaW5zcGlyZWQgYnkgSm9hIEViZXJ0IEFTMyBTaWduYWxCaW5kaW5nIGFuZCBSb2JlcnQgUGVubmVyJ3MgU2xvdCBjbGFzc2VzLlxuICAgICAqIEBhdXRob3IgTWlsbGVyIE1lZGVpcm9zXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQGludGVybmFsXG4gICAgICogQG5hbWUgU2lnbmFsQmluZGluZ1xuICAgICAqIEBwYXJhbSB7U2lnbmFsfSBzaWduYWwgUmVmZXJlbmNlIHRvIFNpZ25hbCBvYmplY3QgdGhhdCBsaXN0ZW5lciBpcyBjdXJyZW50bHkgYm91bmQgdG8uXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gbGlzdGVuZXIgSGFuZGxlciBmdW5jdGlvbiBib3VuZCB0byB0aGUgc2lnbmFsLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNPbmNlIElmIGJpbmRpbmcgc2hvdWxkIGJlIGV4ZWN1dGVkIGp1c3Qgb25jZS5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW2xpc3RlbmVyQ29udGV4dF0gQ29udGV4dCBvbiB3aGljaCBsaXN0ZW5lciB3aWxsIGJlIGV4ZWN1dGVkIChvYmplY3QgdGhhdCBzaG91bGQgcmVwcmVzZW50IHRoZSBgdGhpc2AgdmFyaWFibGUgaW5zaWRlIGxpc3RlbmVyIGZ1bmN0aW9uKS5cbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW3ByaW9yaXR5XSBUaGUgcHJpb3JpdHkgbGV2ZWwgb2YgdGhlIGV2ZW50IGxpc3RlbmVyLiAoZGVmYXVsdCA9IDApLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIFNpZ25hbEJpbmRpbmcoc2lnbmFsLCBsaXN0ZW5lciwgaXNPbmNlLCBsaXN0ZW5lckNvbnRleHQsIHByaW9yaXR5KSB7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEhhbmRsZXIgZnVuY3Rpb24gYm91bmQgdG8gdGhlIHNpZ25hbC5cbiAgICAgICAgICogQHR5cGUgRnVuY3Rpb25cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX2xpc3RlbmVyID0gbGlzdGVuZXI7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIElmIGJpbmRpbmcgc2hvdWxkIGJlIGV4ZWN1dGVkIGp1c3Qgb25jZS5cbiAgICAgICAgICogQHR5cGUgYm9vbGVhblxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5faXNPbmNlID0gaXNPbmNlO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDb250ZXh0IG9uIHdoaWNoIGxpc3RlbmVyIHdpbGwgYmUgZXhlY3V0ZWQgKG9iamVjdCB0aGF0IHNob3VsZCByZXByZXNlbnQgdGhlIGB0aGlzYCB2YXJpYWJsZSBpbnNpZGUgbGlzdGVuZXIgZnVuY3Rpb24pLlxuICAgICAgICAgKiBAbWVtYmVyT2YgU2lnbmFsQmluZGluZy5wcm90b3R5cGVcbiAgICAgICAgICogQG5hbWUgY29udGV4dFxuICAgICAgICAgKiBAdHlwZSBPYmplY3R8dW5kZWZpbmVkfG51bGxcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuY29udGV4dCA9IGxpc3RlbmVyQ29udGV4dDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogUmVmZXJlbmNlIHRvIFNpZ25hbCBvYmplY3QgdGhhdCBsaXN0ZW5lciBpcyBjdXJyZW50bHkgYm91bmQgdG8uXG4gICAgICAgICAqIEB0eXBlIFNpZ25hbFxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fc2lnbmFsID0gc2lnbmFsO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBMaXN0ZW5lciBwcmlvcml0eVxuICAgICAgICAgKiBAdHlwZSBOdW1iZXJcbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX3ByaW9yaXR5ID0gcHJpb3JpdHkgfHwgMDtcbiAgICB9XG5cbiAgICBTaWduYWxCaW5kaW5nLnByb3RvdHlwZSA9IHtcblxuICAgICAgICAvKipcbiAgICAgICAgICogSWYgYmluZGluZyBpcyBhY3RpdmUgYW5kIHNob3VsZCBiZSBleGVjdXRlZC5cbiAgICAgICAgICogQHR5cGUgYm9vbGVhblxuICAgICAgICAgKi9cbiAgICAgICAgYWN0aXZlIDogdHJ1ZSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogRGVmYXVsdCBwYXJhbWV0ZXJzIHBhc3NlZCB0byBsaXN0ZW5lciBkdXJpbmcgYFNpZ25hbC5kaXNwYXRjaGAgYW5kIGBTaWduYWxCaW5kaW5nLmV4ZWN1dGVgLiAoY3VycmllZCBwYXJhbWV0ZXJzKVxuICAgICAgICAgKiBAdHlwZSBBcnJheXxudWxsXG4gICAgICAgICAqL1xuICAgICAgICBwYXJhbXMgOiBudWxsLFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDYWxsIGxpc3RlbmVyIHBhc3NpbmcgYXJiaXRyYXJ5IHBhcmFtZXRlcnMuXG4gICAgICAgICAqIDxwPklmIGJpbmRpbmcgd2FzIGFkZGVkIHVzaW5nIGBTaWduYWwuYWRkT25jZSgpYCBpdCB3aWxsIGJlIGF1dG9tYXRpY2FsbHkgcmVtb3ZlZCBmcm9tIHNpZ25hbCBkaXNwYXRjaCBxdWV1ZSwgdGhpcyBtZXRob2QgaXMgdXNlZCBpbnRlcm5hbGx5IGZvciB0aGUgc2lnbmFsIGRpc3BhdGNoLjwvcD5cbiAgICAgICAgICogQHBhcmFtIHtBcnJheX0gW3BhcmFtc0Fycl0gQXJyYXkgb2YgcGFyYW1ldGVycyB0aGF0IHNob3VsZCBiZSBwYXNzZWQgdG8gdGhlIGxpc3RlbmVyXG4gICAgICAgICAqIEByZXR1cm4geyp9IFZhbHVlIHJldHVybmVkIGJ5IHRoZSBsaXN0ZW5lci5cbiAgICAgICAgICovXG4gICAgICAgIGV4ZWN1dGUgOiBmdW5jdGlvbiAocGFyYW1zQXJyKSB7XG4gICAgICAgICAgICB2YXIgaGFuZGxlclJldHVybiwgcGFyYW1zO1xuICAgICAgICAgICAgaWYgKHRoaXMuYWN0aXZlICYmICEhdGhpcy5fbGlzdGVuZXIpIHtcbiAgICAgICAgICAgICAgICBwYXJhbXMgPSB0aGlzLnBhcmFtcz8gdGhpcy5wYXJhbXMuY29uY2F0KHBhcmFtc0FycikgOiBwYXJhbXNBcnI7XG4gICAgICAgICAgICAgICAgaGFuZGxlclJldHVybiA9IHRoaXMuX2xpc3RlbmVyLmFwcGx5KHRoaXMuY29udGV4dCwgcGFyYW1zKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5faXNPbmNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGV0YWNoKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGhhbmRsZXJSZXR1cm47XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIERldGFjaCBiaW5kaW5nIGZyb20gc2lnbmFsLlxuICAgICAgICAgKiAtIGFsaWFzIHRvOiBteVNpZ25hbC5yZW1vdmUobXlCaW5kaW5nLmdldExpc3RlbmVyKCkpO1xuICAgICAgICAgKiBAcmV0dXJuIHtGdW5jdGlvbnxudWxsfSBIYW5kbGVyIGZ1bmN0aW9uIGJvdW5kIHRvIHRoZSBzaWduYWwgb3IgYG51bGxgIGlmIGJpbmRpbmcgd2FzIHByZXZpb3VzbHkgZGV0YWNoZWQuXG4gICAgICAgICAqL1xuICAgICAgICBkZXRhY2ggOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5pc0JvdW5kKCk/IHRoaXMuX3NpZ25hbC5yZW1vdmUodGhpcy5fbGlzdGVuZXIsIHRoaXMuY29udGV4dCkgOiBudWxsO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAcmV0dXJuIHtCb29sZWFufSBgdHJ1ZWAgaWYgYmluZGluZyBpcyBzdGlsbCBib3VuZCB0byB0aGUgc2lnbmFsIGFuZCBoYXZlIGEgbGlzdGVuZXIuXG4gICAgICAgICAqL1xuICAgICAgICBpc0JvdW5kIDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuICghIXRoaXMuX3NpZ25hbCAmJiAhIXRoaXMuX2xpc3RlbmVyKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogQHJldHVybiB7Ym9vbGVhbn0gSWYgU2lnbmFsQmluZGluZyB3aWxsIG9ubHkgYmUgZXhlY3V0ZWQgb25jZS5cbiAgICAgICAgICovXG4gICAgICAgIGlzT25jZSA6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pc09uY2U7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufSBIYW5kbGVyIGZ1bmN0aW9uIGJvdW5kIHRvIHRoZSBzaWduYWwuXG4gICAgICAgICAqL1xuICAgICAgICBnZXRMaXN0ZW5lciA6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9saXN0ZW5lcjtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogQHJldHVybiB7U2lnbmFsfSBTaWduYWwgdGhhdCBsaXN0ZW5lciBpcyBjdXJyZW50bHkgYm91bmQgdG8uXG4gICAgICAgICAqL1xuICAgICAgICBnZXRTaWduYWwgOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc2lnbmFsO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBEZWxldGUgaW5zdGFuY2UgcHJvcGVydGllc1xuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgX2Rlc3Ryb3kgOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBkZWxldGUgdGhpcy5fc2lnbmFsO1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMuX2xpc3RlbmVyO1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMuY29udGV4dDtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogQHJldHVybiB7c3RyaW5nfSBTdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgdGhlIG9iamVjdC5cbiAgICAgICAgICovXG4gICAgICAgIHRvU3RyaW5nIDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuICdbU2lnbmFsQmluZGluZyBpc09uY2U6JyArIHRoaXMuX2lzT25jZSArJywgaXNCb3VuZDonKyB0aGlzLmlzQm91bmQoKSArJywgYWN0aXZlOicgKyB0aGlzLmFjdGl2ZSArICddJztcbiAgICAgICAgfVxuXG4gICAgfTtcblxuXG4vKmdsb2JhbCBTaWduYWxCaW5kaW5nOmZhbHNlKi9cblxuICAgIC8vIFNpZ25hbCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4gICAgZnVuY3Rpb24gdmFsaWRhdGVMaXN0ZW5lcihsaXN0ZW5lciwgZm5OYW1lKSB7XG4gICAgICAgIGlmICh0eXBlb2YgbGlzdGVuZXIgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvciggJ2xpc3RlbmVyIGlzIGEgcmVxdWlyZWQgcGFyYW0gb2Yge2ZufSgpIGFuZCBzaG91bGQgYmUgYSBGdW5jdGlvbi4nLnJlcGxhY2UoJ3tmbn0nLCBmbk5hbWUpICk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDdXN0b20gZXZlbnQgYnJvYWRjYXN0ZXJcbiAgICAgKiA8YnIgLz4tIGluc3BpcmVkIGJ5IFJvYmVydCBQZW5uZXIncyBBUzMgU2lnbmFscy5cbiAgICAgKiBAbmFtZSBTaWduYWxcbiAgICAgKiBAYXV0aG9yIE1pbGxlciBNZWRlaXJvc1xuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIFNpZ25hbCgpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEB0eXBlIEFycmF5LjxTaWduYWxCaW5kaW5nPlxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fYmluZGluZ3MgPSBbXTtcbiAgICAgICAgdGhpcy5fcHJldlBhcmFtcyA9IG51bGw7XG5cbiAgICAgICAgLy8gZW5mb3JjZSBkaXNwYXRjaCB0byBhd2F5cyB3b3JrIG9uIHNhbWUgY29udGV4dCAoIzQ3KVxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMuZGlzcGF0Y2ggPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgU2lnbmFsLnByb3RvdHlwZS5kaXNwYXRjaC5hcHBseShzZWxmLCBhcmd1bWVudHMpO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIFNpZ25hbC5wcm90b3R5cGUgPSB7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNpZ25hbHMgVmVyc2lvbiBOdW1iZXJcbiAgICAgICAgICogQHR5cGUgU3RyaW5nXG4gICAgICAgICAqIEBjb25zdFxuICAgICAgICAgKi9cbiAgICAgICAgVkVSU0lPTiA6ICcxLjAuMCcsXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIElmIFNpZ25hbCBzaG91bGQga2VlcCByZWNvcmQgb2YgcHJldmlvdXNseSBkaXNwYXRjaGVkIHBhcmFtZXRlcnMgYW5kXG4gICAgICAgICAqIGF1dG9tYXRpY2FsbHkgZXhlY3V0ZSBsaXN0ZW5lciBkdXJpbmcgYGFkZCgpYC9gYWRkT25jZSgpYCBpZiBTaWduYWwgd2FzXG4gICAgICAgICAqIGFscmVhZHkgZGlzcGF0Y2hlZCBiZWZvcmUuXG4gICAgICAgICAqIEB0eXBlIGJvb2xlYW5cbiAgICAgICAgICovXG4gICAgICAgIG1lbW9yaXplIDogZmFsc2UsXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEB0eXBlIGJvb2xlYW5cbiAgICAgICAgICogQHByaXZhdGVcbiAgICAgICAgICovXG4gICAgICAgIF9zaG91bGRQcm9wYWdhdGUgOiB0cnVlLFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJZiBTaWduYWwgaXMgYWN0aXZlIGFuZCBzaG91bGQgYnJvYWRjYXN0IGV2ZW50cy5cbiAgICAgICAgICogPHA+PHN0cm9uZz5JTVBPUlRBTlQ6PC9zdHJvbmc+IFNldHRpbmcgdGhpcyBwcm9wZXJ0eSBkdXJpbmcgYSBkaXNwYXRjaCB3aWxsIG9ubHkgYWZmZWN0IHRoZSBuZXh0IGRpc3BhdGNoLCBpZiB5b3Ugd2FudCB0byBzdG9wIHRoZSBwcm9wYWdhdGlvbiBvZiBhIHNpZ25hbCB1c2UgYGhhbHQoKWAgaW5zdGVhZC48L3A+XG4gICAgICAgICAqIEB0eXBlIGJvb2xlYW5cbiAgICAgICAgICovXG4gICAgICAgIGFjdGl2ZSA6IHRydWUsXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGxpc3RlbmVyXG4gICAgICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNPbmNlXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbbGlzdGVuZXJDb250ZXh0XVxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gW3ByaW9yaXR5XVxuICAgICAgICAgKiBAcmV0dXJuIHtTaWduYWxCaW5kaW5nfVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgX3JlZ2lzdGVyTGlzdGVuZXIgOiBmdW5jdGlvbiAobGlzdGVuZXIsIGlzT25jZSwgbGlzdGVuZXJDb250ZXh0LCBwcmlvcml0eSkge1xuXG4gICAgICAgICAgICB2YXIgcHJldkluZGV4ID0gdGhpcy5faW5kZXhPZkxpc3RlbmVyKGxpc3RlbmVyLCBsaXN0ZW5lckNvbnRleHQpLFxuICAgICAgICAgICAgICAgIGJpbmRpbmc7XG5cbiAgICAgICAgICAgIGlmIChwcmV2SW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgYmluZGluZyA9IHRoaXMuX2JpbmRpbmdzW3ByZXZJbmRleF07XG4gICAgICAgICAgICAgICAgaWYgKGJpbmRpbmcuaXNPbmNlKCkgIT09IGlzT25jZSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1lvdSBjYW5ub3QgYWRkJysgKGlzT25jZT8gJycgOiAnT25jZScpICsnKCkgdGhlbiBhZGQnKyAoIWlzT25jZT8gJycgOiAnT25jZScpICsnKCkgdGhlIHNhbWUgbGlzdGVuZXIgd2l0aG91dCByZW1vdmluZyB0aGUgcmVsYXRpb25zaGlwIGZpcnN0LicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYmluZGluZyA9IG5ldyBTaWduYWxCaW5kaW5nKHRoaXMsIGxpc3RlbmVyLCBpc09uY2UsIGxpc3RlbmVyQ29udGV4dCwgcHJpb3JpdHkpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2FkZEJpbmRpbmcoYmluZGluZyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmKHRoaXMubWVtb3JpemUgJiYgdGhpcy5fcHJldlBhcmFtcyl7XG4gICAgICAgICAgICAgICAgYmluZGluZy5leGVjdXRlKHRoaXMuX3ByZXZQYXJhbXMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gYmluZGluZztcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogQHBhcmFtIHtTaWduYWxCaW5kaW5nfSBiaW5kaW5nXG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICBfYWRkQmluZGluZyA6IGZ1bmN0aW9uIChiaW5kaW5nKSB7XG4gICAgICAgICAgICAvL3NpbXBsaWZpZWQgaW5zZXJ0aW9uIHNvcnRcbiAgICAgICAgICAgIHZhciBuID0gdGhpcy5fYmluZGluZ3MubGVuZ3RoO1xuICAgICAgICAgICAgZG8geyAtLW47IH0gd2hpbGUgKHRoaXMuX2JpbmRpbmdzW25dICYmIGJpbmRpbmcuX3ByaW9yaXR5IDw9IHRoaXMuX2JpbmRpbmdzW25dLl9wcmlvcml0eSk7XG4gICAgICAgICAgICB0aGlzLl9iaW5kaW5ncy5zcGxpY2UobiArIDEsIDAsIGJpbmRpbmcpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBsaXN0ZW5lclxuICAgICAgICAgKiBAcmV0dXJuIHtudW1iZXJ9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICBfaW5kZXhPZkxpc3RlbmVyIDogZnVuY3Rpb24gKGxpc3RlbmVyLCBjb250ZXh0KSB7XG4gICAgICAgICAgICB2YXIgbiA9IHRoaXMuX2JpbmRpbmdzLmxlbmd0aCxcbiAgICAgICAgICAgICAgICBjdXI7XG4gICAgICAgICAgICB3aGlsZSAobi0tKSB7XG4gICAgICAgICAgICAgICAgY3VyID0gdGhpcy5fYmluZGluZ3Nbbl07XG4gICAgICAgICAgICAgICAgaWYgKGN1ci5fbGlzdGVuZXIgPT09IGxpc3RlbmVyICYmIGN1ci5jb250ZXh0ID09PSBjb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ2hlY2sgaWYgbGlzdGVuZXIgd2FzIGF0dGFjaGVkIHRvIFNpZ25hbC5cbiAgICAgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gbGlzdGVuZXJcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IFtjb250ZXh0XVxuICAgICAgICAgKiBAcmV0dXJuIHtib29sZWFufSBpZiBTaWduYWwgaGFzIHRoZSBzcGVjaWZpZWQgbGlzdGVuZXIuXG4gICAgICAgICAqL1xuICAgICAgICBoYXMgOiBmdW5jdGlvbiAobGlzdGVuZXIsIGNvbnRleHQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pbmRleE9mTGlzdGVuZXIobGlzdGVuZXIsIGNvbnRleHQpICE9PSAtMTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogQWRkIGEgbGlzdGVuZXIgdG8gdGhlIHNpZ25hbC5cbiAgICAgICAgICogQHBhcmFtIHtGdW5jdGlvbn0gbGlzdGVuZXIgU2lnbmFsIGhhbmRsZXIgZnVuY3Rpb24uXG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbbGlzdGVuZXJDb250ZXh0XSBDb250ZXh0IG9uIHdoaWNoIGxpc3RlbmVyIHdpbGwgYmUgZXhlY3V0ZWQgKG9iamVjdCB0aGF0IHNob3VsZCByZXByZXNlbnQgdGhlIGB0aGlzYCB2YXJpYWJsZSBpbnNpZGUgbGlzdGVuZXIgZnVuY3Rpb24pLlxuICAgICAgICAgKiBAcGFyYW0ge051bWJlcn0gW3ByaW9yaXR5XSBUaGUgcHJpb3JpdHkgbGV2ZWwgb2YgdGhlIGV2ZW50IGxpc3RlbmVyLiBMaXN0ZW5lcnMgd2l0aCBoaWdoZXIgcHJpb3JpdHkgd2lsbCBiZSBleGVjdXRlZCBiZWZvcmUgbGlzdGVuZXJzIHdpdGggbG93ZXIgcHJpb3JpdHkuIExpc3RlbmVycyB3aXRoIHNhbWUgcHJpb3JpdHkgbGV2ZWwgd2lsbCBiZSBleGVjdXRlZCBhdCB0aGUgc2FtZSBvcmRlciBhcyB0aGV5IHdlcmUgYWRkZWQuIChkZWZhdWx0ID0gMClcbiAgICAgICAgICogQHJldHVybiB7U2lnbmFsQmluZGluZ30gQW4gT2JqZWN0IHJlcHJlc2VudGluZyB0aGUgYmluZGluZyBiZXR3ZWVuIHRoZSBTaWduYWwgYW5kIGxpc3RlbmVyLlxuICAgICAgICAgKi9cbiAgICAgICAgYWRkIDogZnVuY3Rpb24gKGxpc3RlbmVyLCBsaXN0ZW5lckNvbnRleHQsIHByaW9yaXR5KSB7XG4gICAgICAgICAgICB2YWxpZGF0ZUxpc3RlbmVyKGxpc3RlbmVyLCAnYWRkJyk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVnaXN0ZXJMaXN0ZW5lcihsaXN0ZW5lciwgZmFsc2UsIGxpc3RlbmVyQ29udGV4dCwgcHJpb3JpdHkpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBZGQgbGlzdGVuZXIgdG8gdGhlIHNpZ25hbCB0aGF0IHNob3VsZCBiZSByZW1vdmVkIGFmdGVyIGZpcnN0IGV4ZWN1dGlvbiAod2lsbCBiZSBleGVjdXRlZCBvbmx5IG9uY2UpLlxuICAgICAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBsaXN0ZW5lciBTaWduYWwgaGFuZGxlciBmdW5jdGlvbi5cbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IFtsaXN0ZW5lckNvbnRleHRdIENvbnRleHQgb24gd2hpY2ggbGlzdGVuZXIgd2lsbCBiZSBleGVjdXRlZCAob2JqZWN0IHRoYXQgc2hvdWxkIHJlcHJlc2VudCB0aGUgYHRoaXNgIHZhcmlhYmxlIGluc2lkZSBsaXN0ZW5lciBmdW5jdGlvbikuXG4gICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbcHJpb3JpdHldIFRoZSBwcmlvcml0eSBsZXZlbCBvZiB0aGUgZXZlbnQgbGlzdGVuZXIuIExpc3RlbmVycyB3aXRoIGhpZ2hlciBwcmlvcml0eSB3aWxsIGJlIGV4ZWN1dGVkIGJlZm9yZSBsaXN0ZW5lcnMgd2l0aCBsb3dlciBwcmlvcml0eS4gTGlzdGVuZXJzIHdpdGggc2FtZSBwcmlvcml0eSBsZXZlbCB3aWxsIGJlIGV4ZWN1dGVkIGF0IHRoZSBzYW1lIG9yZGVyIGFzIHRoZXkgd2VyZSBhZGRlZC4gKGRlZmF1bHQgPSAwKVxuICAgICAgICAgKiBAcmV0dXJuIHtTaWduYWxCaW5kaW5nfSBBbiBPYmplY3QgcmVwcmVzZW50aW5nIHRoZSBiaW5kaW5nIGJldHdlZW4gdGhlIFNpZ25hbCBhbmQgbGlzdGVuZXIuXG4gICAgICAgICAqL1xuICAgICAgICBhZGRPbmNlIDogZnVuY3Rpb24gKGxpc3RlbmVyLCBsaXN0ZW5lckNvbnRleHQsIHByaW9yaXR5KSB7XG4gICAgICAgICAgICB2YWxpZGF0ZUxpc3RlbmVyKGxpc3RlbmVyLCAnYWRkT25jZScpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlZ2lzdGVyTGlzdGVuZXIobGlzdGVuZXIsIHRydWUsIGxpc3RlbmVyQ29udGV4dCwgcHJpb3JpdHkpO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBSZW1vdmUgYSBzaW5nbGUgbGlzdGVuZXIgZnJvbSB0aGUgZGlzcGF0Y2ggcXVldWUuXG4gICAgICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGxpc3RlbmVyIEhhbmRsZXIgZnVuY3Rpb24gdGhhdCBzaG91bGQgYmUgcmVtb3ZlZC5cbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IFtjb250ZXh0XSBFeGVjdXRpb24gY29udGV4dCAoc2luY2UgeW91IGNhbiBhZGQgdGhlIHNhbWUgaGFuZGxlciBtdWx0aXBsZSB0aW1lcyBpZiBleGVjdXRpbmcgaW4gYSBkaWZmZXJlbnQgY29udGV4dCkuXG4gICAgICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufSBMaXN0ZW5lciBoYW5kbGVyIGZ1bmN0aW9uLlxuICAgICAgICAgKi9cbiAgICAgICAgcmVtb3ZlIDogZnVuY3Rpb24gKGxpc3RlbmVyLCBjb250ZXh0KSB7XG4gICAgICAgICAgICB2YWxpZGF0ZUxpc3RlbmVyKGxpc3RlbmVyLCAncmVtb3ZlJyk7XG5cbiAgICAgICAgICAgIHZhciBpID0gdGhpcy5faW5kZXhPZkxpc3RlbmVyKGxpc3RlbmVyLCBjb250ZXh0KTtcbiAgICAgICAgICAgIGlmIChpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2JpbmRpbmdzW2ldLl9kZXN0cm95KCk7IC8vbm8gcmVhc29uIHRvIGEgU2lnbmFsQmluZGluZyBleGlzdCBpZiBpdCBpc24ndCBhdHRhY2hlZCB0byBhIHNpZ25hbFxuICAgICAgICAgICAgICAgIHRoaXMuX2JpbmRpbmdzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBsaXN0ZW5lcjtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogUmVtb3ZlIGFsbCBsaXN0ZW5lcnMgZnJvbSB0aGUgU2lnbmFsLlxuICAgICAgICAgKi9cbiAgICAgICAgcmVtb3ZlQWxsIDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIG4gPSB0aGlzLl9iaW5kaW5ncy5sZW5ndGg7XG4gICAgICAgICAgICB3aGlsZSAobi0tKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYmluZGluZ3Nbbl0uX2Rlc3Ryb3koKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX2JpbmRpbmdzLmxlbmd0aCA9IDA7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEByZXR1cm4ge251bWJlcn0gTnVtYmVyIG9mIGxpc3RlbmVycyBhdHRhY2hlZCB0byB0aGUgU2lnbmFsLlxuICAgICAgICAgKi9cbiAgICAgICAgZ2V0TnVtTGlzdGVuZXJzIDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2JpbmRpbmdzLmxlbmd0aDtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogU3RvcCBwcm9wYWdhdGlvbiBvZiB0aGUgZXZlbnQsIGJsb2NraW5nIHRoZSBkaXNwYXRjaCB0byBuZXh0IGxpc3RlbmVycyBvbiB0aGUgcXVldWUuXG4gICAgICAgICAqIDxwPjxzdHJvbmc+SU1QT1JUQU5UOjwvc3Ryb25nPiBzaG91bGQgYmUgY2FsbGVkIG9ubHkgZHVyaW5nIHNpZ25hbCBkaXNwYXRjaCwgY2FsbGluZyBpdCBiZWZvcmUvYWZ0ZXIgZGlzcGF0Y2ggd29uJ3QgYWZmZWN0IHNpZ25hbCBicm9hZGNhc3QuPC9wPlxuICAgICAgICAgKiBAc2VlIFNpZ25hbC5wcm90b3R5cGUuZGlzYWJsZVxuICAgICAgICAgKi9cbiAgICAgICAgaGFsdCA6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuX3Nob3VsZFByb3BhZ2F0ZSA9IGZhbHNlO1xuICAgICAgICB9LFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBEaXNwYXRjaC9Ccm9hZGNhc3QgU2lnbmFsIHRvIGFsbCBsaXN0ZW5lcnMgYWRkZWQgdG8gdGhlIHF1ZXVlLlxuICAgICAgICAgKiBAcGFyYW0gey4uLip9IFtwYXJhbXNdIFBhcmFtZXRlcnMgdGhhdCBzaG91bGQgYmUgcGFzc2VkIHRvIGVhY2ggaGFuZGxlci5cbiAgICAgICAgICovXG4gICAgICAgIGRpc3BhdGNoIDogZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICAgICAgaWYgKCEgdGhpcy5hY3RpdmUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBwYXJhbXNBcnIgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpLFxuICAgICAgICAgICAgICAgIG4gPSB0aGlzLl9iaW5kaW5ncy5sZW5ndGgsXG4gICAgICAgICAgICAgICAgYmluZGluZ3M7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLm1lbW9yaXplKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fcHJldlBhcmFtcyA9IHBhcmFtc0FycjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCEgbikge1xuICAgICAgICAgICAgICAgIC8vc2hvdWxkIGNvbWUgYWZ0ZXIgbWVtb3JpemVcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGJpbmRpbmdzID0gdGhpcy5fYmluZGluZ3Muc2xpY2UoKTsgLy9jbG9uZSBhcnJheSBpbiBjYXNlIGFkZC9yZW1vdmUgaXRlbXMgZHVyaW5nIGRpc3BhdGNoXG4gICAgICAgICAgICB0aGlzLl9zaG91bGRQcm9wYWdhdGUgPSB0cnVlOyAvL2luIGNhc2UgYGhhbHRgIHdhcyBjYWxsZWQgYmVmb3JlIGRpc3BhdGNoIG9yIGR1cmluZyB0aGUgcHJldmlvdXMgZGlzcGF0Y2guXG5cbiAgICAgICAgICAgIC8vZXhlY3V0ZSBhbGwgY2FsbGJhY2tzIHVudGlsIGVuZCBvZiB0aGUgbGlzdCBvciB1bnRpbCBhIGNhbGxiYWNrIHJldHVybnMgYGZhbHNlYCBvciBzdG9wcyBwcm9wYWdhdGlvblxuICAgICAgICAgICAgLy9yZXZlcnNlIGxvb3Agc2luY2UgbGlzdGVuZXJzIHdpdGggaGlnaGVyIHByaW9yaXR5IHdpbGwgYmUgYWRkZWQgYXQgdGhlIGVuZCBvZiB0aGUgbGlzdFxuICAgICAgICAgICAgZG8geyBuLS07IH0gd2hpbGUgKGJpbmRpbmdzW25dICYmIHRoaXMuX3Nob3VsZFByb3BhZ2F0ZSAmJiBiaW5kaW5nc1tuXS5leGVjdXRlKHBhcmFtc0FycikgIT09IGZhbHNlKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvKipcbiAgICAgICAgICogRm9yZ2V0IG1lbW9yaXplZCBhcmd1bWVudHMuXG4gICAgICAgICAqIEBzZWUgU2lnbmFsLm1lbW9yaXplXG4gICAgICAgICAqL1xuICAgICAgICBmb3JnZXQgOiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgdGhpcy5fcHJldlBhcmFtcyA9IG51bGw7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJlbW92ZSBhbGwgYmluZGluZ3MgZnJvbSBzaWduYWwgYW5kIGRlc3Ryb3kgYW55IHJlZmVyZW5jZSB0byBleHRlcm5hbCBvYmplY3RzIChkZXN0cm95IFNpZ25hbCBvYmplY3QpLlxuICAgICAgICAgKiA8cD48c3Ryb25nPklNUE9SVEFOVDo8L3N0cm9uZz4gY2FsbGluZyBhbnkgbWV0aG9kIG9uIHRoZSBzaWduYWwgaW5zdGFuY2UgYWZ0ZXIgY2FsbGluZyBkaXNwb3NlIHdpbGwgdGhyb3cgZXJyb3JzLjwvcD5cbiAgICAgICAgICovXG4gICAgICAgIGRpc3Bvc2UgOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLnJlbW92ZUFsbCgpO1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMuX2JpbmRpbmdzO1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMuX3ByZXZQYXJhbXM7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEByZXR1cm4ge3N0cmluZ30gU3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBvYmplY3QuXG4gICAgICAgICAqL1xuICAgICAgICB0b1N0cmluZyA6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAnW1NpZ25hbCBhY3RpdmU6JysgdGhpcy5hY3RpdmUgKycgbnVtTGlzdGVuZXJzOicrIHRoaXMuZ2V0TnVtTGlzdGVuZXJzKCkgKyddJztcbiAgICAgICAgfVxuXG4gICAgfTtcblxuXG4gICAgLy8gTmFtZXNwYWNlIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbiAgICAvKipcbiAgICAgKiBTaWduYWxzIG5hbWVzcGFjZVxuICAgICAqIEBuYW1lc3BhY2VcbiAgICAgKiBAbmFtZSBzaWduYWxzXG4gICAgICovXG4gICAgdmFyIHNpZ25hbHMgPSBTaWduYWw7XG5cbiAgICAvKipcbiAgICAgKiBDdXN0b20gZXZlbnQgYnJvYWRjYXN0ZXJcbiAgICAgKiBAc2VlIFNpZ25hbFxuICAgICAqL1xuICAgIC8vIGFsaWFzIGZvciBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eSAoc2VlICNnaC00NClcbiAgICBzaWduYWxzLlNpZ25hbCA9IFNpZ25hbDtcblxuXG5cbiAgICAvL2V4cG9ydHMgdG8gbXVsdGlwbGUgZW52aXJvbm1lbnRzXG4gICAgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKXsgLy9BTURcbiAgICAgICAgZGVmaW5lKGZ1bmN0aW9uICgpIHsgcmV0dXJuIHNpZ25hbHM7IH0pO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgJiYgbW9kdWxlLmV4cG9ydHMpeyAvL25vZGVcbiAgICAgICAgbW9kdWxlLmV4cG9ydHMgPSBzaWduYWxzO1xuICAgIH0gZWxzZSB7IC8vYnJvd3NlclxuICAgICAgICAvL3VzZSBzdHJpbmcgYmVjYXVzZSBvZiBHb29nbGUgY2xvc3VyZSBjb21waWxlciBBRFZBTkNFRF9NT0RFXG4gICAgICAgIC8qanNsaW50IHN1Yjp0cnVlICovXG4gICAgICAgIGdsb2JhbFsnc2lnbmFscyddID0gc2lnbmFscztcbiAgICB9XG5cbn0odGhpcykpO1xuIiwidmFyIGVscyA9IHtcblx0cGxheWVyIDogZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgndGV4dC0tcGxheWVyJylbMF0sXG5cdGdlbmVyYWwgOiBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCd0ZXh0LS1nZW5lcmFsJylbMF0sXG5cdGFpIDogZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgndGV4dC0tYWknKVswXVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihjbGFzc1Bvc3RGaXgsIHRleHQpIHtcblxuXHRlbHNbY2xhc3NQb3N0Rml4XS5pbm5lckhUTUwgPSB0ZXh0O1xufTsiXX0=\n"],"sourceRoot":"/source/"}